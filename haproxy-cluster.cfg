global
    maxconn 4096
    ulimit-n 65535
    nbthread 4
    log stdout local0

defaults
    mode tcp
    timeout connect 5000ms
    timeout client 50000ms
    timeout server 50000ms
    option dontlognull
    retries 3

# TCP Load Balancer Frontend
frontend tcp_frontend
    bind *:8080
    mode tcp
    default_backend tcp_backend

# TCP Backend Pool - Switch-based setup
backend tcp_backend
    mode tcp
    balance roundrobin
    server lazarus1 17.0.0.10:8080 check
    server lazarus2 17.0.0.11:8080 check
    server lazarus3 17.0.0.12:8080 check

# UDP Load Balancer (for VPN traffic)
frontend udp_frontend
    bind *:1194
    mode tcp
    default_backend udp_backend

backend udp_backend
    mode tcp
    balance roundrobin
    server vpn1 17.0.0.10:1194 check
    server vpn2 17.0.0.11:1194 check
    server vpn3 17.0.0.12:1194 check

# HTTPS Load Balancer
frontend https_frontend
    bind *:9443
    mode tcp
    default_backend https_backend

backend https_backend
    mode tcp
    balance roundrobin
    server web1 17.0.0.10:443 check
    server web2 17.0.0.11:443 check
    server web3 17.0.0.12:443 check

# Statistics Interface (HTTP mode)
frontend stats
    bind *:8404
    mode http
    stats enable
    stats uri /stats
    stats refresh 30s
