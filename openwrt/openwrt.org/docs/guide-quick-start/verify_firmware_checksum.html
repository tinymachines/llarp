
<h1 class="sectionedit1" id="verifying_openwrt_firmware_binary">Verifying OpenWrt firmware binary</h1>
<div class="level1">

<p>
Today&#039;s Internet is a high-threat environment.
In particular, supply chain attacks, in which an attacker compromises the process of downloading software and updates, are now frequent.
Completely verifying any software you download before you install and use it is thus important.
</p>

<p>
Doing so for OpenWrt requires understanding the organization of the Web server that supplies the binaries you install.
Using the 21.02.0 release for the x86-64 as an example, the structure is:
</p>
<ul>
<li class="level1"><div class="li"> <a href="https://downloads.openwrt.org/releases/21.02.0/" class="urlextern" title="https://downloads.openwrt.org/releases/21.02.0/" rel="ugc nofollow">https://downloads.openwrt.org/releases/21.02.0/</a> - all files for the 21.02.0 release</div>
</li>
<li class="level1"><div class="li"> <a href="https://downloads.openwrt.org/releases/21.02.0/packages/" class="urlextern" title="https://downloads.openwrt.org/releases/21.02.0/packages/" rel="ugc nofollow">https://downloads.openwrt.org/releases/21.02.0/packages/</a> - all packages for the 21.02.0 release</div>
</li>
<li class="level1"><div class="li"> <a href="https://downloads.openwrt.org/releases/21.02.0/targets/" class="urlextern" title="https://downloads.openwrt.org/releases/21.02.0/targets/" rel="ugc nofollow">https://downloads.openwrt.org/releases/21.02.0/targets/</a> - all firmware for the 21.02.0 release</div>
</li>
<li class="level1"><div class="li"> <a href="https://downloads.openwrt.org/releases/21.02.0/targets/x86/" class="urlextern" title="https://downloads.openwrt.org/releases/21.02.0/targets/x86/" rel="ugc nofollow">https://downloads.openwrt.org/releases/21.02.0/targets/x86/</a> - all firmware for the <code>x86</code> instruction set</div>
</li>
<li class="level1"><div class="li"> <a href="https://downloads.openwrt.org/releases/21.02.0/targets/x86/64/" class="urlextern" title="https://downloads.openwrt.org/releases/21.02.0/targets/x86/64/" rel="ugc nofollow">https://downloads.openwrt.org/releases/21.02.0/targets/x86/64/</a> - all firmware for products sharing the <code>64</code> architecture, and an index file containing a table with columns for abbreviated file names, SHA256 hash, file size and creation date for each of the firmware files.</div>
</li>
<li class="level1"><div class="li"> <a href="https://downloads.openwrt.org/releases/21.02.0/targets/x86/64/sha256sums" class="urlextern" title="https://downloads.openwrt.org/releases/21.02.0/targets/x86/64/sha256sums" rel="ugc nofollow">https://downloads.openwrt.org/releases/21.02.0/targets/x86/64/sha256sums</a> - a file containing SHA256 hashes for each of the firmware files for products sharing the <code>x86/64</code> architecture</div>
</li>
<li class="level1"><div class="li"> <a href="https://downloads.openwrt.org/releases/21.02.0/targets/x86/64/sha256sums.asc" class="urlextern" title="https://downloads.openwrt.org/releases/21.02.0/targets/x86/64/sha256sums.asc" rel="ugc nofollow">https://downloads.openwrt.org/releases/21.02.0/targets/x86/64/sha256sums.asc</a> - a detached GPG signature for the <code>sha256sums</code> file created by the 21.02.0 signing private key.</div>
</li>
</ul>

<p>
The 21.02.0 signing key verifies the signature in the <code>sha256sums.asc</code> file.
The signature in the <code>sha256sums.asc</code> file verifies the integrity of the <code>sha256sums</code> file.
The SHA256 hash in the <code>sha256sums</code> file verifies the integrity of the individual files in the <code>64</code> directory.
The same goes for all the other supported architectures.
Note that the URLs above are all <code>https:</code> not <code>http:</code> - some of the relevant links on <a href="https://openwrt.org" class="urlextern" title="https://openwrt.org" rel="ugc nofollow">https://openwrt.org</a> are <code>http:</code> but if you find one you should change it to <code>https:</code> before using the <abbr title="Uniform Resource Locator">URL</abbr>.
<code>http:</code> connections are vulnerable to interception and corruption.
</p>

<p>
In order to fully verify a firmware file it is necessary to download:
</p>
<ul>
<li class="level1"><div class="li"> The firmware file itself</div>
</li>
<li class="level1"><div class="li"> The <code>shasums</code> file</div>
</li>
<li class="level1"><div class="li"> The <code>sha256sums.asc</code> file</div>
</li>
<li class="level1"><div class="li"> The public signing key</div>
</li>
</ul>

<p>
Then the steps are:
</p>
<ul>
<li class="level1"><div class="li"> Verify the signature for the <code>sha256sums</code> file.</div>
</li>
<li class="level1"><div class="li"> Use the <code>sha256sums</code> file to verify the SHA256 hash of the firmware file.</div>
</li>
</ul>

<p>
If you <strong>assume</strong> that you are not the victim of a supply chain attack, that no-one has compromised <code>downloads.openwrt.org</code> or your connection to it, it is possible to perform a partial verification by omitting the signature check.
This is <strong>not recommended</strong>.
</p>

<p>
If the signature check fails or if the SHA256 hashes do not match <strong>do not flash the downloaded firmware</strong>.
Your download might be corrupted and brick your router, or it might be malware and open your network to ransomware.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Verifying OpenWrt firmware binary&quot;,&quot;hid&quot;:&quot;verifying_openwrt_firmware_binary&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:1,&quot;range&quot;:&quot;1-3017&quot;} -->
<h2 class="sectionedit2" id="linux">Linux</h2>
<div class="level2">

<p>
For obtaining the correct GPG key, see <a href="/docs/guide-user/security/signatures" class="wikilink1" title="docs:guide-user:security:signatures" data-wiki-id="docs:guide-user:security:signatures">OpenWrt GPG public keys and fingerprints</a>
</p>

<p>
Note that 23.05 releases are signed with the “PGP key for unattended snapshot builds (deprecated)”
</p>
<pre class="code bash"><span class="co0"># Download files</span>
<span class="kw3">cd</span> <span class="sy0">/</span>tmp
curl <span class="re5">--progress-bar</span> <span class="re5">-o</span> openwrt-21.02.0-x86-<span class="nu0">64</span>-generic-squashfs-combined.img.gz \
    https:<span class="sy0">//</span>downloads.openwrt.org<span class="sy0">/</span>releases<span class="sy0">/</span>21.02.0<span class="sy0">/</span>targets<span class="sy0">/</span>x86<span class="sy0">/</span><span class="nu0">64</span><span class="sy0">/</span>openwrt-21.02.0-x86-<span class="nu0">64</span>-generic-squashfs-combined.img.gz
curl <span class="re5">--progress-bar</span> <span class="re5">-o</span> sha256sums \
    https:<span class="sy0">//</span>downloads.openwrt.org<span class="sy0">/</span>releases<span class="sy0">/</span>21.02.0<span class="sy0">/</span>targets<span class="sy0">/</span>x86<span class="sy0">/</span><span class="nu0">64</span><span class="sy0">/</span>sha256sums
curl <span class="re5">--progress-bar</span> <span class="re5">-o</span> sha256sums.asc \
    https:<span class="sy0">//</span>downloads.openwrt.org<span class="sy0">/</span>releases<span class="sy0">/</span>21.02.0<span class="sy0">/</span>targets<span class="sy0">/</span>x86<span class="sy0">/</span><span class="nu0">64</span><span class="sy0">/</span>sha256sums.asc
&nbsp;
<span class="co0"># Import GPG public key</span>
gpg <span class="re5">--receive-keys</span> 88CA59E88F681580
&nbsp;
<span class="co0"># Check GPG public key fingerprint</span>
gpg <span class="re5">--fingerprint</span> 88CA59E88F681580
&nbsp;
<span class="co0"># Verify GPG signature</span>
gpg <span class="re5">--status-fd</span> <span class="nu0">1</span> <span class="re5">--with-fingerprint</span> <span class="re5">--verify</span> sha256sums.asc sha256sums <span class="nu0">2</span><span class="sy0">&gt;&amp;</span><span class="nu0">1</span> <span class="sy0">|</span> <span class="kw2">grep</span> <span class="re5">-e</span> Good
&nbsp;
<span class="co0"># Verify SHA256 checksums</span>
sha256sum <span class="re5">--ignore-missing</span> <span class="re5">-c</span> sha256sums <span class="nu0">2</span><span class="sy0">&gt;</span> <span class="sy0">/</span>dev<span class="sy0">/</span>null <span class="sy0">|</span> <span class="kw2">grep</span> <span class="re5">-e</span> OK</pre>

<p>
For Linux systems there is a script called <a href="https://raw.githubusercontent.com/openwrt/openwrt/refs/heads/main/scripts/download-check-artifact.sh" class="urlextern" title="https://raw.githubusercontent.com/openwrt/openwrt/refs/heads/main/scripts/download-check-artifact.sh" rel="ugc nofollow">download-check-artifact.sh</a> that automates the process.
Make sure to specify the <abbr title="Uniform Resource Locator">URL</abbr> using <abbr title="Hypertext Transfer Protocol Secure">HTTPS</abbr>. Also, make sure that you edit the script before running and replace the <strong>deprecated sks-keyservers.net</strong> with <strong>keyserver.ubuntu.com</strong> or <strong>keys.openpgp.org</strong> or <strong>pgp.mit.edu</strong> .
</p>

<p>
Here is an edited recording of a session using the script after adding the public signing key to the keyring:
</p>
<pre class="code"># download-check-artifact.sh https://downloads.openwrt.org/releases/21.02.0/targets/x86/64/openwrt-21.02.0-x86-64-generic-squashfs-combined.img.gz

1) Downloading image file
=========================
[progress bar]
2) Downloading checksum file
============================
[progress bar]
3) Downloading the GPG signature
================================
[progress bar]
4) Verifying GPG signature
==========================
gpg: Signature made Thu Sep  2 09:39:21 2021 MSK
gpg:                using RSA key 667205E379BAF348863A5C6688CA59E88F681580
gpg: Good signature from &quot;OpenWrt Build System (PGP key for 21.02 release builds) &lt;pgpsign-21.02@openwrt.org&gt;&quot; [ultimate]
Primary key fingerprint: 6672 05E3 79BA F348 863A  5C66 88CA 59E8 8F68 1580

5) Verifying SHA256 checksum
============================
openwrt-21.02.0-x86-64-generic-squashfs-combined.img.gz: OK

Verification done!
==================
Firmware image placed in &#039;~/Downloads/OpenWrt/openwrt-21.02.0-x86-64-generic-squashfs-combined.img.gz&#039;.

Cleaning up.</pre>

<p>
If the script returns an error code, check its source code for an explanation of the cause of the error.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Linux&quot;,&quot;hid&quot;:&quot;linux&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:2,&quot;range&quot;:&quot;3018-5762&quot;} -->
<h2 class="sectionedit3" id="windows">Windows</h2>
<div class="level2">

<p>
See also: <a href="/docs/guide-quick-start/verify_firmware_checksum#linux" class="wikilink1" title="docs:guide-quick-start:verify_firmware_checksum" data-wiki-id="docs:guide-quick-start:verify_firmware_checksum">Verifying GPG signature</a>
</p>

<p>
Checksums are stored in the folder view of the download server&#039;s webpage.
Obtain it by following those steps:
</p>
<ol>
<li class="level1"><div class="li"> Recall the <abbr title="Uniform Resource Locator">URL</abbr> used to download the firmware image, e.g. <code><a href="https://downloads.openwrt.org/releases/21.02.0/targets/x86/64/openwrt-21.02.0-x86-64-generic-squashfs-combined.img.gz" class="urlextern" title="https://downloads.openwrt.org/releases/21.02.0/targets/x86/64/openwrt-21.02.0-x86-64-generic-squashfs-combined.img.gz" rel="ugc nofollow">https://downloads.openwrt.org/releases/21.02.0/targets/x86/64/openwrt-21.02.0-x86-64-generic-squashfs-combined.img.gz</a></code></div>
</li>
<li class="level1"><div class="li"> Strip of everything behind the last <code>/</code> and open the <abbr title="Uniform Resource Locator">URL</abbr> in your browser, e.g. <code><a href="https://downloads.openwrt.org/releases/21.02.0/targets/x86/64/" class="urlextern" title="https://downloads.openwrt.org/releases/21.02.0/targets/x86/64/" rel="ugc nofollow">https://downloads.openwrt.org/releases/21.02.0/targets/x86/64/</a></code></div>
</li>
<li class="level1"><div class="li"> Find the file you downloaded. The string in the column <code>sha256sum</code> is the checksum, e.g. <code>c41212b58775686ad5ed38904c0798899e6b664e9856c48831f1efce85f09824</code></div>
</li>
</ol>

<p>
Software to verify checksums:
</p>
<ul>
<li class="level1"><div class="li"> Newer Windows has a built-in tool to calculate sha256sums called <code>certutil</code>, but it has no graphical user interface so we will have to use the command line to interact with it.</div>
</li>
<li class="level1"><div class="li"> Older Windows version need to download a sha256 tool, for example <a href="https://raylin.wordpress.com/downloads/md5-sha-1-checksum-utility/" class="urlextern" title="https://raylin.wordpress.com/downloads/md5-sha-1-checksum-utility/" rel="ugc nofollow">MD5 &amp; SHA Checksum Utility</a> (the free version).</div>
</li>
</ul>

<p>
To use the built-in <code>certutil</code>:
</p>
<ol>
<li class="level1"><div class="li"> Click the Windows icon, type “cmd” and hit enter.</div>
</li>
<li class="level1"><div class="li"> Execute (assuming you downloaded the file to your Downloads folder): <pre class="code">certutil -hashfile &quot;%USERPROFILE%\Downloads\openwrt-file-name-here&quot; sha256</pre>
</div>
</li>
<li class="level1"><div class="li"> This will print a checksum like this (file name followed by string with letters and numbers), <pre class="code">SHA256-Hash of file C:\Users\USERNAME\Downloads\openwrt-21.02.0-x86-64-generic-squashfs-combined.img.gz:
c4 12 12 b5 87 75 68 6a d5 ed 38 90 4c 07 98 89 9e 6b 66 4e 98 56 c4 88 31 f1 ef ce 85 f0 98 24</pre>
</div>
</li>
<li class="level1"><div class="li"> Remove spaces from this checksum output, e.g. using replace function in notepad: <pre class="code">c41212b58775686ad5ed38904c0798899e6b664e9856c48831f1efce85f09824</pre>
</div>
</li>
<li class="level1"><div class="li"> Check that the checksum string without blanks matches the one you can find in the <strong>sha256sums</strong> field on the download page you retrieved by following the instructions above.</div>
</li>
</ol>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Windows&quot;,&quot;hid&quot;:&quot;windows&quot;,&quot;codeblockOffset&quot;:2,&quot;secid&quot;:3,&quot;range&quot;:&quot;5763-7791&quot;} -->
<h2 class="sectionedit4" id="macos">macOS</h2>
<div class="level2">

<p>
See also: <a href="/docs/guide-quick-start/verify_firmware_checksum#linux" class="wikilink1" title="docs:guide-quick-start:verify_firmware_checksum" data-wiki-id="docs:guide-quick-start:verify_firmware_checksum">Verifying GPG signature</a>
</p>

<p>
Checksums are stored in the folder view of the download server&#039;s webpage.
Obtain it by following those steps:
</p>
<ol>
<li class="level1"><div class="li"> Recall the <abbr title="Uniform Resource Locator">URL</abbr> used to download the firmware image, e.g. <code><a href="https://downloads.openwrt.org/releases/21.02.0/targets/x86/64/openwrt-21.02.0-x86-64-generic-squashfs-combined.img.gz" class="urlextern" title="https://downloads.openwrt.org/releases/21.02.0/targets/x86/64/openwrt-21.02.0-x86-64-generic-squashfs-combined.img.gz" rel="ugc nofollow">https://downloads.openwrt.org/releases/21.02.0/targets/x86/64/openwrt-21.02.0-x86-64-generic-squashfs-combined.img.gz</a></code></div>
</li>
<li class="level1"><div class="li"> Strip of everything behind the last <code>/</code> and open the <abbr title="Uniform Resource Locator">URL</abbr> in your browser, e.g. <code><a href="https://downloads.openwrt.org/releases/21.02.0/targets/x86/64/" class="urlextern" title="https://downloads.openwrt.org/releases/21.02.0/targets/x86/64/" rel="ugc nofollow">https://downloads.openwrt.org/releases/21.02.0/targets/x86/64/</a></code></div>
</li>
<li class="level1"><div class="li"> Find the file you downloaded. The string in the column <code>sha256sum</code> is the checksum, e.g. <code>c41212b58775686ad5ed38904c0798899e6b664e9856c48831f1efce85f09824</code></div>
</li>
</ol>

<p>
Mac has an integrated tool to check sha256sums, but it has no graphical user interface so we will have to use the Terminal to interact with it.
</p>
<ol>
<li class="level1"><div class="li"> Click the Finder icon in the Dock.</div>
</li>
<li class="level1"><div class="li"> Click Applications in the Favorites list.</div>
</li>
<li class="level1"><div class="li"> Find the Utilities folder and click to open it.</div>
</li>
<li class="level1"><div class="li"> Locate Terminal and double-click the icon to open the program.</div>
</li>
<li class="level1"><div class="li"> Open a terminal window, and execute (assuming you downloaded the file on the desktop): <pre class="code">shasum -a 256 ./Desktop/file-name-here</pre>
</div>
</li>
<li class="level1"><div class="li"> it will print something like this (string with letters and numbers followed by file name):<pre class="code">c41212b58775686ad5ed38904c0798899e6b664e9856c48831f1efce85f09824
openwrt-21.02.0-x86-64-generic-squashfs-combined.img.gz</pre>
</div>
</li>
<li class="level1"><div class="li"> Check that the checksum string matches the one you can find in the <strong>sha256sums</strong> field on the download page you retrieved by following the instructions above.</div>
</li>
</ol>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;macOS&quot;,&quot;hid&quot;:&quot;macos&quot;,&quot;codeblockOffset&quot;:5,&quot;secid&quot;:4,&quot;range&quot;:&quot;7792-&quot;} -->