
<h1 class="sectionedit1" id="building_mpd-full_with_pulseaudio">Building MPD-full with PulseAudio</h1>
<div class="level1">

<p>
More information about building from source: <a href="/docs/guide-developer/toolchain/start" class="wikilink1" title="docs:guide-developer:toolchain:start" data-wiki-id="docs:guide-developer:toolchain:start">OpenWrt Buildroot - Usage</a>
</p>

<p>
First you need to follow the HowtoBuild <a href="/docs/guide-developer/build.mpd-full" class="wikilink1" title="docs:guide-developer:build.mpd-full" data-wiki-id="docs:guide-developer:build.mpd-full">MPD-full building from source</a>
</p>

<p>
Based on the following reference: <a href="https://forum.openwrt.org/viewtopic.php?pid=287809#p287809" class="urlextern" title="https://forum.openwrt.org/viewtopic.php?pid=287809#p287809" rel="ugc nofollow"> BB + MPD-full + PulseAudio, unable to build</a><br/>

</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Building MPD-full with PulseAudio&quot;,&quot;hid&quot;:&quot;building_mpd-full_with_pulseaudio&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:1,&quot;range&quot;:&quot;1-417&quot;} -->
<h3 class="sectionedit2" id="section180602">18.06.02</h3>
<div class="level3">

</div>

<h4 id="the_mpd_makefile">The MPD Makefile</h4>
<div class="level4">

<p>
In your git clone directory edit the makefile <code>/openwrt/feeds/packages/sound/mpd/Makefile</code>.
</p>

<p>
Detect the area in the Makefile involved with the full MPD installation. 
Add <code>+pulseaudio-daemon</code> to DEPENDS.
</p>
<pre class="code"> 
  TITLE+= (full)
  DEPENDS+= +libffmpeg +libid3tag +libmms +libupnp +libshout +pulseaudio-daemon
  PROVIDES:=mpd
  VARIANT:=full</pre>

<p>
Edit the --disable-pulse to <strong>--enable-pulse</strong>
</p>
<pre class="code">     --disable-nfs \
     --disable-openal \
     --disable-opus \
     --enable-pulse \
     --disable-sidplay \
     --disable-smbclient \
     --disable-sndfile \</pre>

<p>
Edit the EXTRA_LDFLAGS and add 
</p>
<pre class="code">-Wl,-rpath-link=$(STAGING_DIR)/usr/lib/pulseaudio </pre>

<p>
The complete line looks like that:
</p>
<pre class="code">  EXTRA_LDFLAGS += $(if $(ICONV_FULL),-liconv,-Wl,--whole-archive -liconv -Wl,--no-whole-archive) -Wl,-rpath-link=$(STAGING_DIR)/usr/lib/pulseaudio</pre>

<p>
Maybe the path has to be adapted to $(STAGING_DIR)/opt/lib/pulseaudio.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;18.06.02&quot;,&quot;hid&quot;:&quot;section180602&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:2,&quot;range&quot;:&quot;418-&quot;} -->