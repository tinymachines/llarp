
<h1 class="sectionedit1" id="build_system_setup_wsl">Build system setup WSL</h1>
<div class="level1">
<!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_start&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:2,&quot;range&quot;:&quot;0-&quot;} --><div class="wrap_important plugin_wrap">
<p>
This method is NOT OFFICIALLY supported.
A native <a href="/docs/guide-developer/toolchain/install-buildsystem" class="wikilink1" title="docs:guide-developer:toolchain:install-buildsystem" data-wiki-id="docs:guide-developer:toolchain:install-buildsystem">GNU/Linux environment</a> is recommended.
</p>
</div><!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_end&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:3,&quot;range&quot;:&quot;0-&quot;} -->
<p>
See also:
<a href="https://docs.microsoft.com/en-us/windows/wsl" class="urlextern" title="https://docs.microsoft.com/en-us/windows/wsl" rel="ugc nofollow">Windows Subsystem for Linux Documentation</a>,
<a href="https://devblogs.microsoft.com/commandline/announcing-wsl-2#how-much-faster-is-wsl-2" class="urlextern" title="https://devblogs.microsoft.com/commandline/announcing-wsl-2#how-much-faster-is-wsl-2" rel="ugc nofollow">How much faster is WSL 2?</a>
</p>

<p>
The OpenWrt build system is reported to work in <a href="https://en.wikipedia.org/wiki/Windows_Subsystem_for_Linux" class="interwiki iw_wp" title="https://en.wikipedia.org/wiki/Windows_Subsystem_for_Linux">WSL</a> with <a href="https://www.microsoft.com/en-us/p/debian/9msvkqc78pk6" class="urlextern" title="https://www.microsoft.com/en-us/p/debian/9msvkqc78pk6" rel="ugc nofollow">Debian</a>.
</p>
<pre class="code bash"><span class="kw2">sudo</span> apt update
<span class="kw2">sudo</span> apt dist-upgrade</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Build system setup WSL&quot;,&quot;hid&quot;:&quot;build_system_setup_wsl&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:1,&quot;range&quot;:&quot;1-642&quot;} -->
<h2 class="sectionedit4" id="setting_up_path">Setting up path</h2>
<div class="level2">

<p>
To be able to build an OpenWrt image, you must not have spaces in PATH or in the work folders on the drive.
But by default in a WSL environment there are windows folders too and those have spaces in path:
</p>
<pre class="code bash"><span class="sy0">&gt;</span> <span class="kw3">echo</span> <span class="co1">${PATH}</span>
<span class="sy0">/</span>usr<span class="sy0">/</span>local<span class="sy0">/</span>sbin:<span class="sy0">/</span>usr<span class="sy0">/</span>local<span class="sy0">/</span>bin:<span class="sy0">/</span>usr<span class="sy0">/</span>sbin:<span class="sy0">/</span>usr<span class="sy0">/</span>bin:<span class="sy0">/</span>sbin:<span class="sy0">/</span>bin:<span class="sy0">/</span>usr<span class="sy0">/</span>games:<span class="sy0">/</span>usr<span class="sy0">/</span>local<span class="sy0">/</span>games:<span class="sy0">/</span>usr<span class="sy0">/</span>lib<span class="sy0">/</span>wsl<span class="sy0">/</span>lib:<span class="sy0">/</span>mnt<span class="sy0">/</span>c<span class="sy0">/</span>Windows<span class="sy0">/</span>System32:<span class="sy0">/</span>mnt<span class="sy0">/</span>c<span class="sy0">/</span>Windows:<span class="sy0">/</span>mnt<span class="sy0">/</span>c<span class="sy0">/</span>Windows<span class="sy0">/</span>System32<span class="sy0">/</span>wbem:<span class="sy0">/</span>mnt<span class="sy0">/</span>c<span class="sy0">/</span>Windows<span class="sy0">/</span>System32<span class="sy0">/</span>WindowsPowerShell<span class="sy0">/</span>v1.0<span class="sy0">/</span>:<span class="sy0">/</span>mnt<span class="sy0">/</span>c<span class="sy0">/</span>Windows<span class="sy0">/</span>System32<span class="sy0">/</span>OpenSSH<span class="sy0">/</span>:<span class="sy0">/</span>mnt<span class="sy0">/</span>c<span class="sy0">/</span>Program Files<span class="sy0">/</span>dotnet<span class="sy0">/</span>:<span class="sy0">/</span>mnt<span class="sy0">/</span>c<span class="sy0">/</span>Program Files <span class="br0">&#40;</span>x86<span class="br0">&#41;</span><span class="sy0">/</span>GnuPG<span class="sy0">/</span>bin:<span class="sy0">/</span>mnt<span class="sy0">/</span>c<span class="sy0">/</span>Program Files <span class="br0">&#40;</span>x86<span class="br0">&#41;</span><span class="sy0">/</span>dotnet<span class="sy0">/</span>:<span class="sy0">/</span>mnt<span class="sy0">/</span>c<span class="sy0">/</span>Program Files<span class="sy0">/</span>WireGuard<span class="sy0">/</span>:<span class="sy0">/</span>mnt<span class="sy0">/</span>c<span class="sy0">/</span>Program Files<span class="sy0">/</span>Git<span class="sy0">/</span>cmd:<span class="sy0">/</span>mnt<span class="sy0">/</span>c<span class="sy0">/</span>Program Files <span class="br0">&#40;</span>x86<span class="br0">&#41;</span><span class="sy0">/</span>AOMEI<span class="sy0">/</span>AOMEI Backupper<span class="sy0">/</span>6.5.1:<span class="sy0">/</span>mnt<span class="sy0">/</span>c<span class="sy0">/</span>Program Files <span class="br0">&#40;</span>x86<span class="br0">&#41;</span><span class="sy0">/</span>Bitvise SSH Client:<span class="sy0">/</span>mnt<span class="sy0">/</span>c<span class="sy0">/</span>WINDOWS<span class="sy0">/</span>system32:<span class="sy0">/</span>mnt<span class="sy0">/</span>c<span class="sy0">/</span>WINDOWS:<span class="sy0">/</span>mnt<span class="sy0">/</span>c<span class="sy0">/</span>WINDOWS<span class="sy0">/</span>System32<span class="sy0">/</span>Wbem:<span class="sy0">/</span>mnt<span class="sy0">/</span>c<span class="sy0">/</span>WINDOWS<span class="sy0">/</span>System32<span class="sy0">/</span>WindowsPowerShell<span class="sy0">/</span>v1.0<span class="sy0">/</span>:<span class="sy0">/</span>mnt<span class="sy0">/</span>c<span class="sy0">/</span>WINDOWS<span class="sy0">/</span>System32<span class="sy0">/</span>OpenSSH<span class="sy0">/</span>:<span class="sy0">/</span>mnt<span class="sy0">/</span>c<span class="sy0">/</span>Users<span class="sy0">/</span>Bas Mevissen<span class="sy0">/</span>AppData<span class="sy0">/</span>Local<span class="sy0">/</span>Microsoft<span class="sy0">/</span>WindowsApps:<span class="sy0">/</span>mnt<span class="sy0">/</span>c<span class="sy0">/</span>Users<span class="sy0">/</span>Bas Mevissen<span class="sy0">/</span>.dotnet<span class="sy0">/</span>tools </pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Setting up path&quot;,&quot;hid&quot;:&quot;setting_up_path&quot;,&quot;codeblockOffset&quot;:1,&quot;secid&quot;:4,&quot;range&quot;:&quot;643-1682&quot;} -->
<h3 class="sectionedit5" id="temporary_non-invasive_solution">Temporary non-invasive solution</h3>
<div class="level3">

<p>
When launching commands in the OpenWrt build system folder, you can override the path with only the folders you want (i.e. only Linux ones since nothing from Windows is needed to compile OpenWrt) this is an example where we are just calling a <code>make</code>:
</p>
<pre class="code bash"><span class="re2">PATH</span>=<span class="sy0">/</span>usr<span class="sy0">/</span>local<span class="sy0">/</span>sbin:<span class="sy0">/</span>usr<span class="sy0">/</span>local<span class="sy0">/</span>bin:<span class="sy0">/</span>usr<span class="sy0">/</span>sbin:<span class="sy0">/</span>usr<span class="sy0">/</span>bin:<span class="sy0">/</span>sbin:<span class="sy0">/</span>bin <span class="kw2">make</span> </pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Temporary non-invasive solution&quot;,&quot;hid&quot;:&quot;temporary_non-invasive_solution&quot;,&quot;codeblockOffset&quot;:2,&quot;secid&quot;:5,&quot;range&quot;:&quot;1683-2071&quot;} -->
<h3 class="sectionedit6" id="permanent_but_invasive_solution">Permanent but invasive solution</h3>
<div class="level3">

<p>
See also:
<a href="https://devblogs.microsoft.com/commandline/automatically-configuring-wsl#section-interop" class="urlextern" title="https://devblogs.microsoft.com/commandline/automatically-configuring-wsl#section-interop" rel="ugc nofollow">Automatically Configuring WSL</a>,
<a href="https://stackoverflow.com/a/63195953" class="urlextern" title="https://stackoverflow.com/a/63195953" rel="ugc nofollow">How to remove the Win10&#039;s PATH from WSL</a>
</p>

<p>
Configure WSL so that no Windows path elements (starts with <code>/mnt</code>) are in the PATH environment variable of the Linux distribution.
In the Linux environment create <code>/etc/wsl.conf</code>:
</p>
<pre class="code bash"><span class="kw2">sudo</span> <span class="kw2">tee</span> <span class="re5">-a</span> <span class="sy0">/</span>etc<span class="sy0">/</span>wsl.conf <span class="sy0">&lt;&lt;</span> EOF <span class="sy0">&gt;</span> <span class="sy0">/</span>dev<span class="sy0">/</span>null
<span class="br0">&#91;</span>interop<span class="br0">&#93;</span>
appendWindowsPath = <span class="kw2">false</span>
EOF
<span class="kw3">exit</span></pre>

<p>
Restart WSL to apply changes:
</p>
<pre class="code bash">wsl <span class="re5">--shutdown</span></pre>

<p>
In the Linux environment verify whether no Windows path elements appear in the PATH environment variable by following command.
</p>
<pre class="code bash"><span class="kw3">echo</span> <span class="co1">${PATH}</span></pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Permanent but invasive solution&quot;,&quot;hid&quot;:&quot;permanent_but_invasive_solution&quot;,&quot;codeblockOffset&quot;:3,&quot;secid&quot;:6,&quot;range&quot;:&quot;2072-2855&quot;} -->
<h3 class="sectionedit7" id="alternative_permanent_solution_that_is_not_so_invasive">Alternative permanent solution that is not so invasive</h3>
<div class="level3">
<pre class="code bash"><span class="kw3">echo</span> <span class="st_h">'export PATH=$(echo $PATH'</span><span class="st0">&quot; | sed 's|:/mnt/[a-z]/[a-z_]*\?/\?[A-Za-z]* [A-Za-z]* \?[A-Za-z]*\?[^:]*||g')&quot;</span> <span class="sy0">&gt;&gt;</span> ~<span class="sy0">/</span>.bashrc</pre>

<p>
Logout WSL user to apply changes:
</p>
<pre class="code bash"><span class="kw3">exit</span></pre>

<p>
This method strips only the windows path elements that contain spaces whilst retaining access to useful windows executables within the WSL shell such as:
</p>
<pre class="code bash">explorer.exe .</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Alternative permanent solution that is not so invasive&quot;,&quot;hid&quot;:&quot;alternative_permanent_solution_that_is_not_so_invasive&quot;,&quot;codeblockOffset&quot;:6,&quot;secid&quot;:7,&quot;range&quot;:&quot;2856-3311&quot;} -->
<h2 class="sectionedit8" id="extras">Extras</h2>
<div class="level2">

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Extras&quot;,&quot;hid&quot;:&quot;extras&quot;,&quot;codeblockOffset&quot;:9,&quot;secid&quot;:8,&quot;range&quot;:&quot;3312-3330&quot;} -->
<h3 class="sectionedit9" id="limiting_ramcpu_usage">Limiting RAM/CPU usage</h3>
<div class="level3">

<p>
See also: <a href="https://docs.microsoft.com/en-us/windows/wsl/wsl-config#configure-global-options-with-wslconfig" class="urlextern" title="https://docs.microsoft.com/en-us/windows/wsl/wsl-config#configure-global-options-with-wslconfig" rel="ugc nofollow">Configure global options with .wslconfig</a>
</p>

<p>
It is possible to limit WSL2&#039;s use of RAM/CPU resources by creating/editing <code>%USERPROFILE%\.wslconfig</code>.
</p>
<pre class="code ini"><span class="re0"><span class="br0">&#91;</span>wsl2<span class="br0">&#93;</span></span>
<span class="re1">memory</span><span class="sy0">=</span><span class="re2">8GB # Limits VM memory in WSL 2 to 8 GB</span>
<span class="re1">processors</span><span class="sy0">=</span><span class="re2">4 # Makes the WSL 2 VM use four virtual processors</span></pre>

<p>
Restart WSL to apply changes:
</p>
<pre class="code bash">wsl <span class="re5">--shutdown</span></pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Limiting RAM\/CPU usage&quot;,&quot;hid&quot;:&quot;limiting_ramcpu_usage&quot;,&quot;codeblockOffset&quot;:9,&quot;secid&quot;:9,&quot;range&quot;:&quot;3331-3825&quot;} -->
<h3 class="sectionedit10" id="accessing_files">Accessing files</h3>
<div class="level3">

<p>
By default, WSL2 mounts your Windows drive under <code>/mnt/c</code>, so you can access from WSL2 to Windows.  
</p>

<p>
You can access the WSL2 file system from Windows 10 by opening explorer.exe and entering <code>\\wsl$\&lt;name of WSL Instance&gt;</code>, e.g. <code>\\wsl$\Ubuntu-20.04</code>.
You can map this to a drive letter to easily access the WSL2 system from Windows programs, like Atom or other graphical IDE software.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Accessing files&quot;,&quot;hid&quot;:&quot;accessing_files&quot;,&quot;codeblockOffset&quot;:11,&quot;secid&quot;:10,&quot;range&quot;:&quot;3826-&quot;} -->