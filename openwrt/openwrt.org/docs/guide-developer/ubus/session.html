
<h1 class="sectionedit1" id="ubus_session">ubus session</h1>
<div class="level1">
<div class="table sectionedit2"><table class="inline">
	<thead>
	<tr class="row0">
		<th class="col0"> Path </th><th class="col1"> Procedure </th><th class="col2"> Signature </th><th class="col3"> Description </th>
	</tr>
	</thead>
	<tr class="row1">
		<td class="col0"> <code>session</code> </td><td class="col1"> <code>create</code> </td><td class="col2"> <code>{ “timeout”: <em>timeout</em> }</code> </td><td class="col3 leftalign"> Create a new session and return its ID, set the session timeout to <code><em>timeout</em></code> in seconds (set <code>0</code> for no expire)  </td>
	</tr>
	<tr class="row2">
		<td class="col0"> <code>session</code> </td><td class="col1"> <code>list</code> </td><td class="col2"> <code>{ “ubus_rpc_session”: “<em>sid</em>” }</code> </td><td class="col3"> Dump session info specified by <code><em>sid</em></code>, if no ID is given, list all sessions </td>
	</tr>
	<tr class="row3">
		<td class="col0"> <code>session</code> </td><td class="col1"> <code>grant</code> </td><td class="col2"> <code>{ “ubus_rpc_session”: “<em>sid</em>”, “scope”: “<em>scope</em>”,
  “objects”: [ [ “path”, “func” ], ... ] }</code> </td><td class="col3"> Within the session identified by <code><em>sid</em></code> grant access to all specified procedures <code><em>func</em></code> in the namespace <code><em>path</em></code> listed in the <code><em>objects</em></code> array </td>
	</tr>
	<tr class="row4">
		<td class="col0"> <code>session</code> </td><td class="col1"> <code>revoke</code> </td><td class="col2"> <code>{ “ubus_rpc_session”: “<em>sid</em>”, “scope”: “<em>scope</em>”,
  “objects”: [ [ “path”, “func” ], ... ] }</code> </td><td class="col3"> Within the session identified by <code><em>sid</em></code> revoke access to all specified procedures <code><em>func</em></code> in the namespace <code><em>path</em></code> listed in the <code><em>objects</em></code> array. If <code><em>objects</em></code> is unset, revoke all access </td>
	</tr>
	<tr class="row5">
		<td class="col0"> <code>session</code> </td><td class="col1"> <code>access</code> </td><td class="col2"> <code>{ “ubus_rpc_session”: “<em>sid</em>”, “scope”: “<em>scope</em>”,
  “object”: “<em>path</em>”, “function”: “<em>function</em>” }</code> </td><td class="col3"> Query whether access to the specified <code><em>function</em></code> in the namespace <code><em>path</em></code> is allowed </td>
	</tr>
	<tr class="row6">
		<td class="col0"> <code>session</code> </td><td class="col1"> <code>set</code> </td><td class="col2"> <code>{ “ubus_rpc_session”: “<em>sid</em>”,
  “values”: { “<em>key</em>”: <em>value</em>, ... } }</code> </td><td class="col3"> Within the session identified by <code><em>sid</em></code> store the given arbitrary values under their corresponding keys specified in the <code><em>values</em></code> object </td>
	</tr>
	<tr class="row7">
		<td class="col0"> <code>session</code> </td><td class="col1"> <code>get</code> </td><td class="col2"> <code>{ “ubus_rpc_session”: “<em>sid</em>”,
  “keys”: [ “<em>key</em>”, ... ] }</code> </td><td class="col3"> Within the session identified by <code><em>sid</em></code> retrieve all values associated with the given keys listed in the <code><em>keys</em></code> array. If the key array is unset, dump all key/value pairs </td>
	</tr>
	<tr class="row8">
		<td class="col0"> <code>session</code> </td><td class="col1"> <code>unset</code> </td><td class="col2"> <code>{ “ubus_rpc_session”: “<em>sid</em>”,
  “keys”: [ “<em>key</em>”, ... ] }</code> </td><td class="col3"> Within the session identified by <code><em>sid</em></code> unset all keys listed in the <code><em>keys</em></code> array. If the key list is unset, clear all keys </td>
	</tr>
	<tr class="row9">
		<td class="col0"> <code>session</code> </td><td class="col1"> <code>destroy</code> </td><td class="col2"> <code>{ “ubus_rpc_session”: “<em>sid</em>” }</code> </td><td class="col3"> Terminate the session identified by the given ID <code><em>sid</em></code> </td>
	</tr>
	<tr class="row10">
		<td class="col0"> <code>session</code> </td><td class="col1"> <code>login</code> </td><td class="col2"> <code>{ “username”: “<em>username</em>”,
  “password”: “<em>password</em>”,
  “timeout”: <em>timeout</em> }</code> </td><td class="col3"> Authenticate with rpcd and create a new session with access rights as specified in the ACLs </td>
	</tr>
</table></div>
<!-- EDIT{&quot;target&quot;:&quot;table&quot;,&quot;name&quot;:&quot;&quot;,&quot;hid&quot;:&quot;table&quot;,&quot;secid&quot;:2,&quot;range&quot;:&quot;29-2421&quot;} -->
<p>
<strong>Note:</strong> When using ubus over <abbr title="Hypertext Transfer Protocol">HTTP</abbr>, setting <code>ubus_rpc_session</code> isn&#039;t allowed, it&#039;s automatically set to the calling session.
</p>

<p>
<strong>Note:</strong> Sessions are stored in memory so they will persist as long as <code>rpcd</code> is running
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;ubus session&quot;,&quot;hid&quot;:&quot;ubus_session&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:1,&quot;range&quot;:&quot;1-2646&quot;} -->
<h3 class="sectionedit3" id="login_call_description">login call description</h3>
<div class="level3">

<p>
Use <code>session.login</code> to authorize and create a new session. The <code>timeout</code> argument is optional, it is set in seconds and by default is 5 minutes (300 seconds).
The session timeout is automatically reset on every use.
</p>

<p>
Return example:
</p>
<pre class="code yaml"><span class="br0">&#123;</span><span class="co3">
        &quot;ubus_rpc_session&quot;</span><span class="sy2">: </span><span class="st0">&quot;948abf19b632c5460384315d69010e09&quot;</span>,<span class="co3">
        &quot;timeout&quot;</span><span class="sy2">: </span>300,<span class="co3">
        &quot;expires&quot;</span><span class="sy2">: </span>299,<span class="co3">
        &quot;acls&quot;</span><span class="sy2">: </span><span class="br0">&#123;</span><span class="co3">
                &quot;access-group&quot;</span><span class="sy2">: </span><span class="br0">&#123;</span><span class="co3">
                        &quot;uci-access&quot;</span><span class="sy2">: </span><span class="br0">&#91;</span>
                                <span class="st0">&quot;read&quot;</span>,
                                <span class="st0">&quot;write&quot;</span>
                        <span class="br0">&#93;</span>,<span class="co3">
                        &quot;unauthenticated&quot;</span><span class="sy2">: </span><span class="br0">&#91;</span>
                                <span class="st0">&quot;read&quot;</span>
                        <span class="br0">&#93;</span>
                <span class="br0">&#125;</span>,<span class="co3">
                &quot;ubus&quot;</span><span class="sy2">: </span><span class="br0">&#123;</span><span class="co3">
                        &quot;file&quot;</span><span class="sy2">: </span><span class="br0">&#91;</span>
                                <span class="st0">&quot;*&quot;</span>
                        <span class="br0">&#93;</span>,<span class="co3">
                        &quot;session&quot;</span><span class="sy2">: </span><span class="br0">&#91;</span>
                                <span class="st0">&quot;access&quot;</span>,
                                <span class="st0">&quot;login&quot;</span>
                        <span class="br0">&#93;</span>
                <span class="br0">&#125;</span>,<span class="co3">
                &quot;uci&quot;</span><span class="sy2">: </span><span class="br0">&#123;</span><span class="co3">
                        &quot;*&quot;</span><span class="sy2">: </span><span class="br0">&#91;</span>
                                <span class="st0">&quot;read&quot;</span>,
                                <span class="st0">&quot;write&quot;</span>
                        <span class="br0">&#93;</span>
                <span class="br0">&#125;</span>
        <span class="br0">&#125;</span>,<span class="co3">
        &quot;data&quot;</span><span class="sy2">: </span><span class="br0">&#123;</span><span class="co3">
                &quot;username&quot;</span><span class="sy2">: </span><span class="st0">&quot;root&quot;</span>
        <span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre>

<p>
To list all active sessions call <code>session list</code>.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;login call description&quot;,&quot;hid&quot;:&quot;login_call_description&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:3,&quot;range&quot;:&quot;2647-3976&quot;} -->
<h3 class="sectionedit4" id="example_of_manual_session_creation">Example of manual session creation</h3>
<div class="level3">

<p>
Create a session then grant access to all functions of <code>file</code> and to the <code>board</code> object function of <code>system</code> object.
Also set a custom attribute <code>username</code> to <code>alice</code> then check if the sid have an access to <code>system.reboot</code> function (and there is npo such access)
</p>
<pre class="code">root@OpenWrt:~# ubus call session create &#039;{&quot;timeout&quot;: 3600}&#039;
{
        &quot;ubus_rpc_session&quot;: &quot;8c1af812b4b148fcbb92434c74cf61c1&quot;,
        &quot;timeout&quot;: 3600,
        &quot;expires&quot;: 3600,
        &quot;acls&quot;: {

        },
        &quot;data&quot;: {

        }
}
root@OpenWrt:~# ubus call session grant &#039;{&quot;ubus_rpc_session&quot;: &quot;bf11e5cd01cd262ae692600a6a45ccfc&quot;, &quot;scope&quot;: &quot;write&quot;, &quot;objects&quot;: [[&quot;file&quot;, &quot;*&quot;], [&quot;system&quot;, &quot;board&quot;]]}&#039;
root@OpenWrt:~# ubus call session set &#039;{&quot;ubus_rpc_session&quot;: &quot;bf11e5cd01cd262ae692600a6a45ccfc&quot;, &quot;values&quot;: { &quot;username&quot;: &quot;alice&quot; } }&#039;
root@OpenWrt:~# ubus call session list &#039;{&quot;ubus_rpc_session&quot;: &quot;bf11e5cd01cd262ae692600a6a45ccfc&quot;}&#039;
{
        &quot;ubus_rpc_session&quot;: &quot;bf11e5cd01cd262ae692600a6a45ccfc&quot;,
        &quot;timeout&quot;: 3600,
        &quot;expires&quot;: 3600,
        &quot;acls&quot;: {
                &quot;ubus&quot;: {
                        &quot;file&quot;: [
                                &quot;*&quot;
                        ],
                        &quot;system&quot;: [
                                &quot;board&quot;
                        ]
                }
        },
        &quot;data&quot;: {
                &quot;username&quot;: &quot;alice&quot;
        }
}
root@OpenWrt:~# ubus call session access &#039;{ &quot;ubus_rpc_session&quot;: &quot;bf11e5cd01cd262ae692600a6a45ccfc&quot;, &quot;scope&quot;: &quot;ubus&quot;, &quot;object&quot;: &quot;system&quot;, &quot;function&quot;: &quot;reboot&quot; }&#039;
{
        &quot;access&quot;: false
}</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Example of manual session creation&quot;,&quot;hid&quot;:&quot;example_of_manual_session_creation&quot;,&quot;codeblockOffset&quot;:1,&quot;secid&quot;:4,&quot;range&quot;:&quot;3977-&quot;} -->