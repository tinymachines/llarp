
<h1 class="sectionedit1" id="adding_a_new_device">Adding a new device</h1>
<div class="level1">

<p>
A good all-round advice would be to start by looking at recent commits about adding a new device, to see what files where changed and how. Many files try to be as self-explanatory as possible, most of the times just opening them will be enough to understand their function.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Adding a new device&quot;,&quot;hid&quot;:&quot;adding_a_new_device&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:1,&quot;range&quot;:&quot;1-310&quot;} -->
<h2 class="sectionedit2" id="learn_by_example">Learn by example</h2>
<div class="level2">

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Learn by example&quot;,&quot;hid&quot;:&quot;learn_by_example&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:2,&quot;range&quot;:&quot;311-340&quot;} -->
<h3 class="sectionedit3" id="search_by_grep_locally">Search by grep locally</h3>
<div class="level3">

<p>
A good method is learn by example, so you can do: 
</p>
<pre class="code">grep -lri mt300a target/</pre>

<p>
The result is minimal list of files required to add a new board:
</p>
<pre class="code">target/linux/ramips/base-files/etc/board.d/01_leds
target/linux/ramips/base-files/etc/board.d/02_network
target/linux/ramips/base-files/lib/upgrade/platform.sh
target/linux/ramips/base-files/lib/ramips.sh
target/linux/ramips/dts/GL-MT300A.dts
target/linux/ramips/image/mt7620.mk</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Search by grep locally&quot;,&quot;hid&quot;:&quot;search_by_grep_locally&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:3,&quot;range&quot;:&quot;341-815&quot;} -->
<h3 class="sectionedit4" id="search_by_git_commit">Search by Git commit</h3>
<div class="level3">

<p>
<a href="https://git.openwrt.org/?p=openwrt%2Fopenwrt.git&amp;a=search&amp;h=HEAD&amp;st=commit&amp;s=add+support+for" class="urlextern" title="https://git.openwrt.org/?p=openwrt%2Fopenwrt.git&amp;a=search&amp;h=HEAD&amp;st=commit&amp;s=add+support+for" rel="ugc nofollow">Browse the source filtered by &quot;add support for&quot;</a> and checkout the <code>diff</code> for newly added device
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Search by Git commit&quot;,&quot;hid&quot;:&quot;search_by_git_commit&quot;,&quot;codeblockOffset&quot;:1,&quot;secid&quot;:4,&quot;range&quot;:&quot;816-1042&quot;} -->
<h2 class="sectionedit5" id="important_files">Important files</h2>
<div class="level2">

<p>
This is a general map of where most important files are located:
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Important files&quot;,&quot;hid&quot;:&quot;important_files&quot;,&quot;codeblockOffset&quot;:1,&quot;secid&quot;:5,&quot;range&quot;:&quot;1043-1137&quot;} -->
<h3 class="sectionedit6" id="targetlinuxarch_namebase-filesetc">/target/linux/&lt;arch_name&gt;/base-files/etc/…</h3>
<div class="level3">

<p>
This folder contains files and folders that will be integrated in the firmware’s /etc folder.
</p>

<p>
These are its subfolders and files:
</p>
<ul>
<li class="level1"><div class="li"> <strong>…board.d/</strong> scripts for defining device-specific default hardware, like leds and network interfaces.</div>
</li>
<li class="level1"><div class="li"> <strong>…hotplug.d/</strong> scripts for defining device-specific actions to be done automatically on hotplugging of devices</div>
</li>
<li class="level1"><div class="li"> <strong>…init.d/</strong> scripts for defining device-specific actions to be done automatically on boot</div>
</li>
<li class="level1"><div class="li"> <strong>…uci-defaults/</strong> files for defining device-specific uci configuration items. Used e.g. for config migration after syntax changes.</div>
</li>
<li class="level1"><div class="li"> <strong>…diag.sh</strong> defines what is the led to use for error codes for each board</div>
</li>
</ul>

<p>
<em>Note that some of these functions are now done in the DTS for the board.</em>
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;\/target\/linux\/&lt;arch_name&gt;\/base-files\/etc\/\u2026&quot;,&quot;hid&quot;:&quot;targetlinuxarch_namebase-filesetc&quot;,&quot;codeblockOffset&quot;:1,&quot;secid&quot;:6,&quot;range&quot;:&quot;1138-1948&quot;} -->
<h3 class="sectionedit7" id="targetlinuxarch_namebase-fileslib">/target/linux/&lt;arch_name&gt;/base-files/lib/…</h3>
<div class="level3">

<p>
This folder contains files and folders that will be integrated in the firmware’s /lib folder.
</p>

<p>
These are its subfolders and files:
</p>
<ul>
<li class="level1"><div class="li"> <strong>…&lt;arch_name&gt;.sh</strong> human-readable full board name associated to script-safe board name</div>
</li>
<li class="level1"><div class="li"> <strong>…preinit/</strong> common &lt;arch_name&gt; preinit startup scripts</div>
</li>
<li class="level1"><div class="li"> <strong>…upgrade/</strong> common &lt;arch_name&gt; upgrade scripts</div>
</li>
</ul>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;\/target\/linux\/&lt;arch_name&gt;\/base-files\/lib\/\u2026&quot;,&quot;hid&quot;:&quot;targetlinuxarch_namebase-fileslib&quot;,&quot;codeblockOffset&quot;:1,&quot;secid&quot;:7,&quot;range&quot;:&quot;1949-2351&quot;} -->
<h3 class="sectionedit8" id="targetlinuxarch_namebase-filessbin">/target/linux/&lt;arch_name&gt;/base-files/sbin</h3>
<div class="level3">

<p>
This folder contains files and folders that will be integrated in the firmware’s /sbin folder, usually common &lt;arch_name&gt; sbin scripts and tools.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;\/target\/linux\/&lt;arch_name&gt;\/base-files\/sbin&quot;,&quot;hid&quot;:&quot;targetlinuxarch_namebase-filessbin&quot;,&quot;codeblockOffset&quot;:1,&quot;secid&quot;:8,&quot;range&quot;:&quot;2352-2553&quot;} -->
<h3 class="sectionedit9" id="targetlinuxarch_namedts">/target/linux/&lt;arch_name&gt;/dts/</h3>
<div class="level3">

<p>
Device tree source files, or dts for short.
</p>

<p>
<em>Certain architectures have the DTS directory deeper down. ARM devices, for example, typically have it located at <code>files-X.yy/arch/arm/boot/dts/</code></em>
</p>

<p>
<em>If the DTS or DTSI file is already present in upstream Linux, they will usually not be present in the OpenWrt source. Configuring for the target and running <code>make target/linux/{clean,prepare}</code> will download and patch Linux, allowing the resulting file to be found in the <code>build_dir</code></em>
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;\/target\/linux\/&lt;arch_name&gt;\/dts\/&quot;,&quot;hid&quot;:&quot;targetlinuxarch_namedts&quot;,&quot;codeblockOffset&quot;:1,&quot;secid&quot;:9,&quot;range&quot;:&quot;2554-3083&quot;} -->
<h3 class="sectionedit10" id="targetlinuxarch_nameimage">/target/linux/&lt;arch_name&gt;/image/</h3>
<div class="level3">

<p>
Configuration needed to build device-specific flashable images.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;\/target\/linux\/&lt;arch_name&gt;\/image\/&quot;,&quot;hid&quot;:&quot;targetlinuxarch_nameimage&quot;,&quot;codeblockOffset&quot;:1,&quot;secid&quot;:10,&quot;range&quot;:&quot;3084-3192&quot;} -->
<h3 class="sectionedit11" id="targetlinuxarch_nameboard_name">/target/linux/&lt;arch_name&gt;/&lt;board_name&gt;/</h3>
<div class="level3">

<p>
Board-specific configuration.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;\/target\/linux\/&lt;arch_name&gt;\/&lt;board_name&gt;\/&quot;,&quot;hid&quot;:&quot;targetlinuxarch_nameboard_name&quot;,&quot;codeblockOffset&quot;:1,&quot;secid&quot;:11,&quot;range&quot;:&quot;3193-3274&quot;} -->
<h3 class="sectionedit12" id="targetlinuxarch_namemodulesmk">/target/linux/&lt;arch_name&gt;/modules.mk</h3>
<div class="level3">

<p>
Arch-specific kernel module config file for menuconfig
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;\/target\/linux\/&lt;arch_name&gt;\/modules.mk&quot;,&quot;hid&quot;:&quot;targetlinuxarch_namemodulesmk&quot;,&quot;codeblockOffset&quot;:1,&quot;secid&quot;:12,&quot;range&quot;:&quot;3275-3378&quot;} -->
<h3 class="sectionedit13" id="making_new_device_appear_in_make_menuconfig">Making new device appear in make menuconfig</h3>
<div class="level3">

<p>
After edit the files above, you need to touch the makefiles
</p>
<pre class="code">touch target/linux/*/Makefile</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Making new device appear in make menuconfig&quot;,&quot;hid&quot;:&quot;making_new_device_appear_in_make_menuconfig&quot;,&quot;codeblockOffset&quot;:1,&quot;secid&quot;:13,&quot;range&quot;:&quot;3379-3527&quot;} -->
<h2 class="sectionedit14" id="patches">Patches</h2>
<div class="level2">

<p>
The patches-* subdirectories contain the kernel patches applied for every target.<br/>

All patches should be named &#039;NNN-lowercase_shortname.patch&#039; and sorted into the following categories:
</p>

<p>
<strong>0xx</strong> - upstream backports<br/>

<strong>1xx</strong> - code awaiting upstream merge<br/>

<strong>2xx</strong> - kernel build / config / header patches<br/>

<strong>3xx</strong> - architecture specific patches<br/>

<strong>4xx</strong> - mtd related patches (subsystem and drivers)<br/>

<strong>5xx</strong> - filesystem related patches<br/>

<strong>6xx</strong> - generic network patches<br/>

<strong>7xx</strong> - network / phy driver patches<br/>

<strong>8xx</strong> - other drivers<br/>

<strong>9xx</strong> - uncategorized other patches<br/>

</p>
<!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_start&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:15,&quot;range&quot;:&quot;0-&quot;} --><div class="wrap_center wrap_round wrap_tip plugin_wrap" style="width: 80%;">
<p>
All patches must be written in a way that they are potentially upstreamable, meaning:
</p>
<ol>
<li class="level1"><div class="li"> they must contain a <strong>proper subject</strong></div>
</li>
<li class="level1"><div class="li"> they must contain a <strong>proper commit message</strong> explaining what they change</div>
</li>
<li class="level1"><div class="li"> they must contain a <strong>valid Signed-off-by line</strong></div>
</li>
</ol>
</div><!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_end&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:16,&quot;range&quot;:&quot;0-&quot;} -->
</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Patches&quot;,&quot;hid&quot;:&quot;patches&quot;,&quot;codeblockOffset&quot;:1,&quot;secid&quot;:14,&quot;range&quot;:&quot;3528-4437&quot;} -->
<h2 class="sectionedit17" id="testing_images">Testing images</h2>
<div class="level2">

<p>
Test firmware images without writing them to flash by using ramdisk images.
</p>

<p>
In <strong>make menuconfig</strong> select <strong>Target Images</strong> and then you can select the <strong>ramdisk</strong> option.
</p>

<p>
This will create an image with kernel + initramfs, that will have <strong>initramfs</strong> in the name. The resulting image can be loaded in the device through the bootloader&#039;s tftp function and should boot to a prompt without relying on flash/filesystem support.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Testing images&quot;,&quot;hid&quot;:&quot;testing_images&quot;,&quot;codeblockOffset&quot;:1,&quot;secid&quot;:17,&quot;range&quot;:&quot;4438-4892&quot;} -->
<h2 class="sectionedit18" id="tips_and_tricks">Tips and tricks</h2>
<div class="level2">

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Tips and tricks&quot;,&quot;hid&quot;:&quot;tips_and_tricks&quot;,&quot;codeblockOffset&quot;:1,&quot;secid&quot;:18,&quot;range&quot;:&quot;4893-4920&quot;} -->
<h3 class="sectionedit19" id="getting_a_shell_on_the_target_device">Getting a shell on the target device</h3>
<div class="level3">

<p>
In order to collect relevant data for a port of OpenWrt to the device of interest one wants shell access. Most devices though do not offer a way to get a shell with telnet or ssh.
</p>

</div>

<h4 id="abuse_unsanitized_user_input">Abuse Unsanitized User Input</h4>
<div class="level4">

<p>
Some router offers ping test or <abbr title="Network Time Protocol">NTP</abbr> server configuration and may not properly sanitize user input. Try to enter shell script and see if you are lucky. You may need some <code>javascript</code> knowledges to disable client-side input validation.
</p>

</div>

<h5 id="starting_telnetd">Starting telnetd</h5>
<div class="level5">
<pre class="code bash"><span class="co4">$</span><span class="br0">&#40;</span> <span class="sy0">/</span>bin<span class="sy0">/</span>busybox telnetd -l<span class="sy0">/</span>bin<span class="sy0">/</span><span class="kw2">sh</span> <span class="re5">-p23</span> <span class="sy0">&amp;</span> <span class="br0">&#41;</span></pre>

</div>

<h5 id="obtain_the_password_hash_using_http_or_use_sed_to_deletechange_the_default_password_if_telnet_login_is_required">Obtain the password hash using HTTP or use &#039;&#039;sed&#039;&#039; to delete/change the default password if telnet login is required</h5>
<div class="level5">
<pre class="code bash">$<span class="br0">&#40;</span> <span class="kw2">cp</span> <span class="sy0">/</span>etc<span class="sy0">/</span>shadow <span class="sy0">/</span>www <span class="br0">&#41;</span>
$<span class="br0">&#40;</span> <span class="kw2">cp</span> <span class="sy0">/</span>etc<span class="sy0">/</span><span class="kw2">passwd</span> <span class="sy0">/</span>www <span class="br0">&#41;</span></pre>

<p>
Then try to download them to your computer and crack the hash
</p>

</div>

<h4 id="downgrade_to_older_firmware">Downgrade to older firmware</h4>
<div class="level4">

<p>
Some router may try to download a firmware file (e.g. <a href="/toh/tp-link/archer_c2_ac750" class="wikilink1" title="toh:tp-link:archer_c2_ac750" data-wiki-id="toh:tp-link:archer_c2_ac750">TP-Link Archer C2 AC750</a>) from specific private <abbr title="Internet Protocol">IP</abbr> at the beginning of booting, which allow user to downgrade to older firmware
</p>

</div>

<h4 id="downgrade_by_serial_access">Downgrade by Serial access</h4>
<div class="level4">

<p>
Serial access may allow you to enter console mode of u-boot for flashing/loading other firmware. Usually soldering is required.
See <a href="/docs/guide-user/installation/generic.flashing.serial" class="wikilink1" title="docs:guide-user:installation:generic.flashing.serial" data-wiki-id="docs:guide-user:installation:generic.flashing.serial">Generic flashing over the Serial port</a>
</p>

</div>

<h4 id="http_server_vulnerability">HTTP Server Vulnerability</h4>
<div class="level4">

<p>
Some routers may be running outdated/insecure <abbr title="Hypertext Transfer Protocol">HTTP</abbr> server and may be vulnerable to buffer overflow or other attack
</p>

</div>

<h4 id="netgear">Netgear</h4>
<div class="level4">

<p>
With <a href="/toh/netgear/telnet.console" class="wikilink1" title="toh:netgear:telnet.console" data-wiki-id="toh:netgear:telnet.console">netgear-telnetenable</a> many Netgear devices can be opened up for telnet access. Also see <a href="https://github.com/insanid/NetgearTelnetEnable" class="urlextern" title="https://github.com/insanid/NetgearTelnetEnable" rel="ugc nofollow">GitHub: insanid/NetgearTelnetEnable</a>.
When such means cannot be used, one could try to flash an image build from the sources published by the vendor with telnetd enabled.
</p>

<p>
With <a href="https://github.com/jclehner/nmrpflash" class="urlextern" title="https://github.com/jclehner/nmrpflash" rel="ugc nofollow">nmrpflash</a> many Netgear devices can be flashed. Devices that are compatible with this tool become effectively unbrickable.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Getting a shell on the target device&quot;,&quot;hid&quot;:&quot;getting_a_shell_on_the_target_device&quot;,&quot;codeblockOffset&quot;:1,&quot;secid&quot;:19,&quot;range&quot;:&quot;4921-6956&quot;} -->
<h3 class="sectionedit20" id="collecting_relevant_data">Collecting relevant data</h3>
<div class="level3">

<p>
On <a href="https://wikidevi.com/wiki/Main_Page" class="urlextern" title="https://wikidevi.com/wiki/Main_Page" rel="ugc nofollow">WikiDevi</a> lots of information can be found, e.g. the FCC ID is very useful when searching for documentation, datasheets and internal photo&#039;s (to be able to distinguish used chips without having to open the casing).
</p>

<p>
Typically one can use the following commands:
</p>
<pre class="code bash"><span class="kw2">dmesg</span>                          <span class="co0"># log buffer might be to small, see note 1.</span>
<span class="kw2">cat</span> <span class="sy0">/</span>proc<span class="sy0">/</span>cmdline
<span class="kw2">cat</span> <span class="sy0">/</span>proc<span class="sy0">/</span>cpuinfo
<span class="kw2">cat</span> <span class="sy0">/</span>proc<span class="sy0">/</span>meminfo
<span class="kw2">cat</span> <span class="sy0">/</span>proc<span class="sy0">/</span>devices
<span class="kw2">ls</span> <span class="sy0">/</span>sys<span class="sy0">/</span>devices<span class="sy0">/</span>platform
<span class="kw2">cat</span> <span class="sy0">/</span>proc<span class="sy0">/</span>mtd
<span class="kw2">cat</span> <span class="sy0">/</span>sys<span class="sy0">/</span>class<span class="sy0">/</span>mtd<span class="sy0">/</span>mtd<span class="sy0">*/</span>offset <span class="co0"># Linux 4.1 and newer, see note 2.</span>
<span class="kw2">ifconfig</span> <span class="re5">-a</span>
<span class="kw2">ls</span> <span class="sy0">/</span>sys<span class="sy0">/</span>class<span class="sy0">/</span>net
brctl show
<span class="kw2">cat</span> <span class="sy0">/</span>sys<span class="sy0">/</span>kernel<span class="sy0">/</span>debug<span class="sy0">/</span>gpio     <span class="co0"># GPIO information</span></pre>

<p>
<strong>Note 1:</strong> Often the log buffer is to small and the earliest messages may be missing from the information retrieved with <code>dmesg</code>. If one build a stock image from the sources the vendor has published, a larger buffer size can be set within the kernel config.
</p>

<p>
<strong>Note 2:</strong> <a href="http://lxr.free-electrons.com/source/Documentation/ABI/testing/sysfs-class-mtd" class="urlextern" title="http://lxr.free-electrons.com/source/Documentation/ABI/testing/sysfs-class-mtd" rel="ugc nofollow">http://lxr.free-electrons.com/source/Documentation/ABI/testing/sysfs-class-mtd</a>
</p>

<p>
Another useful tool for getting information for setting LEDs might be <a href="https://github.com/jclehner/gpiodump-mt7620" class="urlextern" title="https://github.com/jclehner/gpiodump-mt7620" rel="ugc nofollow">gpiodump</a>, a MT7620 GPIOMODE register dumper (RAMIPS).
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Collecting relevant data&quot;,&quot;hid&quot;:&quot;collecting_relevant_data&quot;,&quot;codeblockOffset&quot;:3,&quot;secid&quot;:20,&quot;range&quot;:&quot;6957-8191&quot;} -->
<h3 class="sectionedit21" id="getting_collected_data_from_a_device">Getting collected data from a device</h3>
<div class="level3">

<p>
Because of the limited space, common file transfer utilities such as rsync/curl/ssh/scp/ftp/http/tftp may not be available, a stripped down version/applet may be available from busybox.
</p>

<p>
Assume the router ip is <code>192.168.0.123</code>, and the file to be transfer located at <code>/tmp/important-data.txt</code>. 
</p>

</div>

<h4 id="use_scp_to_download">Use SCP to download</h4>
<div class="level4">

<p>
Your ssh server built into the device may have SCP capabilities without an sftp server. It may also only support legacy SCP  (requiring the -O option) not scpv2.
</p>

<p>
i.e.
</p>

</div>

<h5 id="receiver">Receiver</h5>
<div class="level5">
<pre class="code">scp -O &lt;source&gt; &lt;dest&gt;</pre>

<p>
For example: 
</p>
<pre class="code"> scp -O root@192.168.1.1:/tmp/important-data.txt ~/</pre>

</div>

<h4 id="http_by_httpd_and_busybox_mount">HTTP by &#039;&#039;httpd&#039;&#039; and &#039;&#039;busybox mount&#039;&#039;</h4>
<div class="level4">

<p>
If the web interface are served from <code>/www</code>.
</p>

</div>

<h5 id="sender">Sender</h5>
<div class="level5">
<pre class="code bash"><span class="kw2">mount</span> <span class="re5">-o</span> <span class="kw3">bind</span> <span class="sy0">/</span>tmp <span class="sy0">/</span>www</pre>

</div>

<h5 id="receiver1">Receiver</h5>
<div class="level5">
<pre class="code bash"><span class="kw2">wget</span> http:<span class="sy0">//</span>192.168.0.123<span class="sy0">/</span>important-data.txt</pre>

</div>

<h4 id="ftp_by_busybox_ftpput">FTP by &#039;&#039;busybox ftpput&#039;&#039;</h4>
<div class="level4">

</div>

<h5 id="receiver2">Receiver</h5>
<div class="level5">

<p>
Setup an <abbr title="File Transfer Protocol">FTP</abbr> server. Add an anonymous account with write permission
</p>
<pre class="code bash">python <span class="re5">-m</span> pyftpdlib <span class="re5">-w</span> <span class="re5">-p</span> <span class="nu0">21</span></pre>

</div>

<h5 id="sender1">Sender</h5>
<div class="level5">
<pre class="code bash">busybox ftpput 192.168.0.123 important-data.txt <span class="sy0">/</span>tmp<span class="sy0">/</span>important-data.txt </pre>

</div>

<h4 id="netcat_by_busybox_nc">netcat by &#039;&#039;busybox nc&#039;&#039;</h4>
<div class="level4">

</div>

<h5 id="receiver3">Receiver</h5>
<div class="level5">
<pre class="code bash">busybox nc <span class="re5">-l</span> <span class="re5">-p</span> <span class="nu0">12345</span> <span class="sy0">&gt;</span> important-data.txt </pre>

</div>

<h5 id="sender2">Sender</h5>
<div class="level5">
<pre class="code bash"><span class="kw2">cat</span> <span class="sy0">/</span>tmp<span class="sy0">/</span>important-data.txt <span class="sy0">|</span> busybox nc 192.168.0.123:<span class="nu0">12345</span> </pre>

</div>

<h4 id="tftp_by_busybox_tftp">TFTP by &#039;&#039;busybox tftp&#039;&#039;</h4>
<div class="level4">

</div>

<h5 id="receiver4">Receiver</h5>
<div class="level5">

<p>
Setup a tftp server 
</p>

</div>

<h5 id="sender3">Sender</h5>
<div class="level5">
<pre class="code bash">busybox tftp <span class="re5">-p</span> <span class="re5">-l</span> <span class="sy0">/</span>tmp<span class="sy0">/</span>important-data.txt <span class="re5">-r</span> important-data.txt 192.168.0.123</pre>

</div>

<h4 id="use_curl_to_upload">Use Curl to upload</h4>
<div class="level4">

<p>
Depending on what is compiled into your curl binary if available you may also be able to auth, use ftp/tftp etc.
Extracts from curl man page:
</p>
<pre class="code">It supports these protocols: DICT, FILE, FTP, FTPS, GOPHER, GOPHERS,
       HTTP, HTTPS, IMAP, IMAPS, LDAP, LDAPS, MQTT, POP3, POP3S, RTMP, RTMPS, RTSP, SCP, SFTP, SMB, SMBS, SMTP, SMTPS, TELNET,  TFTP,  WS
       and WSS. The command is designed to work without user interaction.
            
       curl  offers  a busload of useful tricks like proxy support, user authentication, FTP upload, HTTP post, SSL connections, cookies,
       file transfer resume and more. As you will see below, the number of features will make your head spin.
</pre>
<pre class="code">       -T, --upload-file &lt;file&gt;
              This transfers the specified local file to the remote URL. If there is no file part in the specified URL, curl will  append
              the  local  file  name.  NOTE that you must use a trailing / on the last directory to really prove to Curl that there is no
              file name or curl will think that your last directory name is the remote file name to use. That will most likely cause  the
              upload operation to fail. If this is used on an HTTP(S) server, the PUT command will be used.

              Use  the  file name &quot;-&quot; (a single dash) to use stdin instead of a given file.  Alternately, the file name &quot;.&quot; (a single pe‐
              riod) may be specified instead of &quot;-&quot; to use stdin in non-blocking mode to allow reading server output while stdin is being
              uploaded.

              You can specify one -T, --upload-file for each URL on the command line. Each -T, --upload-file + URL pair specifies what to
              upload and to where. curl also supports &quot;globbing&quot; of the -T, --upload-file argument, meaning that you can upload  multiple
              files to a single URL by using the same URL globbing style supported in the URL.

              When  uploading  to  an SMTP server: the uploaded data is assumed to be RFC 5322 formatted. It has to feature the necessary
              set of headers and mail body formatted correctly by the user as curl will not transcode nor encode it further in any way.

              -T, --upload-file can be used several times in a command line

              Examples:
               curl -T file https://example.com
               curl -T &quot;img[1-1000].png&quot; ftp://ftp.example.com/
               curl --upload-file &quot;{file1,file2}&quot; https://example.com

              See also -G, --get and -I, --head.
</pre>

</div>

<h4 id="copy_from_terminal">Copy from terminal</h4>
<div class="level4">

<p>
If all of the above tools/applets are unavailable, you may copy from telnet terminal but it may not work for binary file.
</p>

<p>
base64 would be a common choice to work around this limitation, but many routers lack such a command. You can first escape binary data to screen-safe hexadecimal by piping to busybox hexdump on the router:
</p>
<pre class="code bash"><span class="kw2">hexdump</span> <span class="re5">-v</span> <span class="re5">-e</span> <span class="st_h">'/1 &quot;%02x&quot;'</span></pre>

<p>
You can then reverse it on the computer with the following command:
</p>
<pre class="code bash">xxd <span class="re5">-r</span> <span class="re5">-p</span></pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Getting collected data from a device&quot;,&quot;hid&quot;:&quot;getting_collected_data_from_a_device&quot;,&quot;codeblockOffset&quot;:4,&quot;secid&quot;:21,&quot;range&quot;:&quot;8192-&quot;} -->