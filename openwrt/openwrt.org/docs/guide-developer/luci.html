
<h1 class="sectionedit1" id="adding_new_elements_to_luci">Adding new elements to LuCI</h1>
<div class="level1">

<p>
This is a sample to show how to add a new element to the LuCI interface
</p>

<p>
NOTE: Some of the information provided in this Wiki might be redundant from <a href="https://github.com/openwrt/luci/wiki/ModulesHowTo" class="urlextern" title="https://github.com/openwrt/luci/wiki/ModulesHowTo" rel="ugc nofollow">https://github.com/openwrt/luci/wiki/ModulesHowTo</a>
</p>

<p>
As the examples show in the LuCI wiki, here are 2 ways to do this:
</p>
<ol>
<li class="level1"><div class="li"> CBI</div>
</li>
<li class="level1"><div class="li"> View (Template)</div>
</li>
</ol>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Adding new elements to LuCI&quot;,&quot;hid&quot;:&quot;adding_new_elements_to_luci&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:1,&quot;range&quot;:&quot;1-340&quot;} -->
<h2 class="sectionedit2" id="adding_a_new_top_level_tab">Adding a new top level tab</h2>
<div class="level2">

<p>
First we are going to add a new tab to the top navigation. Normally one can see: Freifunk | Status | System | Services | Network, etc
</p>

<p>
One can do this by adding a file to the controller directory in your <code>&lt;luci-path&gt;/applications/luci-myapplication/luasrc/controller/myapp</code>
</p>

<p>
<strong>&lt;luci-path&gt;</strong> is the path of your LuCI source files
</p>

<p>
<strong>luci-myapplication</strong> is a new directory created for these examples. The name of the directory has to start with <em>luci-</em> so that it is recognized by <code>make menuconfig</code> and show up as a module to be compiled.
</p>

<p>
<strong>controller</strong> is the default directory for any UI control (i.e. new tab)
</p>

<p>
<strong>myapp</strong> is also a custom directory for this particular application
</p>

<p>
We will call this file <code>new_tab.lua</code>
</p>

<p>
The content is as follows:
</p>
<!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_start&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:3,&quot;range&quot;:&quot;0-&quot;} --><div class="wrap_prewrap plugin_wrap" style="width: 1000px; max-width: 100%;"><pre class="code lua">module<span class="br0">&#40;</span><span class="st0">&quot;luci.controller.myapp.new_tab&quot;</span><span class="sy0">,</span> package<span class="sy0">.</span>seeall<span class="br0">&#41;</span>  <span class="co1">--notice that new_tab is the name of the file new_tab.lua</span>
 <span class="kw1">function</span> index<span class="br0">&#40;</span><span class="br0">&#41;</span>
     entry<span class="br0">&#40;</span><span class="br0">&#123;</span><span class="st0">&quot;admin&quot;</span><span class="sy0">,</span> <span class="st0">&quot;new_tab&quot;</span><span class="br0">&#125;</span><span class="sy0">,</span> firstchild<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">,</span> <span class="st0">&quot;New tab&quot;</span><span class="sy0">,</span> <span class="nu0">60</span><span class="br0">&#41;</span><span class="sy0">.</span>dependent<span class="sy0">=</span><span class="kw4">false</span>  <span class="co1">--this adds the top level tab and defaults to the first sub-tab (tab_from_cbi), also it is set to position 30</span>
     entry<span class="br0">&#40;</span><span class="br0">&#123;</span><span class="st0">&quot;admin&quot;</span><span class="sy0">,</span> <span class="st0">&quot;new_tab&quot;</span><span class="sy0">,</span> <span class="st0">&quot;tab_from_cbi&quot;</span><span class="br0">&#125;</span><span class="sy0">,</span> cbi<span class="br0">&#40;</span><span class="st0">&quot;myapp-mymodule/cbi_tab&quot;</span><span class="br0">&#41;</span><span class="sy0">,</span> <span class="st0">&quot;CBI Tab&quot;</span><span class="sy0">,</span> <span class="nu0">1</span><span class="br0">&#41;</span>  <span class="co1">--this adds the first sub-tab that is located in &lt;luci-path&gt;/luci-myapplication/model/cbi/myapp-mymodule and the file is called cbi_tab.lua, also set to first position</span>
     entry<span class="br0">&#40;</span><span class="br0">&#123;</span><span class="st0">&quot;admin&quot;</span><span class="sy0">,</span> <span class="st0">&quot;new_tab&quot;</span><span class="sy0">,</span> <span class="st0">&quot;tab_from_view&quot;</span><span class="br0">&#125;</span><span class="sy0">,</span> template<span class="br0">&#40;</span><span class="st0">&quot;myapp-mymodule/view_tab&quot;</span><span class="br0">&#41;</span><span class="sy0">,</span> <span class="st0">&quot;View Tab&quot;</span><span class="sy0">,</span> <span class="nu0">2</span><span class="br0">&#41;</span>  <span class="co1">--this adds the second sub-tab that is located in &lt;luci-path&gt;/luci-myapplication/view/myapp-mymodule and the file is called view_tab.htm, also set to the second position</span>
<span class="kw1">end</span></pre>
</div><!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_end&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:4,&quot;range&quot;:&quot;0-&quot;} --><hr />

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Adding a new top level tab&quot;,&quot;hid&quot;:&quot;adding_a_new_top_level_tab&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:2,&quot;range&quot;:&quot;341-2054&quot;} -->
<h2 class="sectionedit5" id="adding_the_cbi_tab_code">Adding the cbi_tab code</h2>
<div class="level2">

<p>
As specified above, we need to create a file called <code>cbi_tab.lua</code> in <code>&lt;luci-path&gt;/luci-myapplication/model/cbi/myapp-mymodule</code>
</p>

<p>
We will include the following code:
</p>
<!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_start&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:6,&quot;range&quot;:&quot;0-&quot;} --><div class="wrap_prewrap plugin_wrap" style="width: 1000px; max-width: 100%;"><pre class="code lua">m <span class="sy0">=</span> Map<span class="br0">&#40;</span><span class="st0">&quot;cbi_file&quot;</span><span class="sy0">,</span> translate<span class="br0">&#40;</span><span class="st0">&quot;First Tab Form&quot;</span><span class="br0">&#41;</span><span class="sy0">,</span> translate<span class="br0">&#40;</span><span class="st0">&quot;Please fill out the form below&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="co1">-- cbi_file is the config file in /etc/config</span>
d <span class="sy0">=</span> m<span class="sy0">:</span>section<span class="br0">&#40;</span>TypedSection<span class="sy0">,</span> <span class="st0">&quot;info&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Part A of the form&quot;</span><span class="br0">&#41;</span>  <span class="co1">-- info is the section called info in cbi_file</span>
a <span class="sy0">=</span> d<span class="sy0">:</span>option<span class="br0">&#40;</span>Value<span class="sy0">,</span> <span class="st0">&quot;name&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Name&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span> a<span class="sy0">.</span>optional<span class="sy0">=</span><span class="kw4">false</span><span class="sy0">;</span> a<span class="sy0">.</span>rmempty <span class="sy0">=</span> <span class="kw4">false</span><span class="sy0">;</span>  <span class="co1">-- name is the option in the cbi_file</span>
<span class="kw1">return</span> m</pre>
</div><!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_end&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:7,&quot;range&quot;:&quot;0-&quot;} --><hr />

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Adding the cbi_tab code&quot;,&quot;hid&quot;:&quot;adding_the_cbi_tab_code&quot;,&quot;codeblockOffset&quot;:1,&quot;secid&quot;:5,&quot;range&quot;:&quot;2055-2683&quot;} -->
<h2 class="sectionedit8" id="adding_the_cbi_file">Adding the cbi_file</h2>
<div class="level2">

<p>
From the code above, we know we need a config file that has the appropriate sections and options. In our case, we will create the file <em>cbi_file</em> in <code>/etc/config</code> which looks like this:
</p>
<!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_start&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:9,&quot;range&quot;:&quot;0-&quot;} --><div class="wrap_prewrap plugin_wrap" style="width: 1000px; max-width: 100%;"><pre class="code">config &#039;info&#039; &#039;A&#039;
	option &#039;name&#039; &#039;OpenWRT&#039;</pre>
</div><!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_end&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:10,&quot;range&quot;:&quot;0-&quot;} --><hr />

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Adding the cbi_file&quot;,&quot;hid&quot;:&quot;adding_the_cbi_file&quot;,&quot;codeblockOffset&quot;:2,&quot;secid&quot;:8,&quot;range&quot;:&quot;2684-3002&quot;} -->
<h2 class="sectionedit11" id="adding_the_view_tab_code">Adding the view_tab code</h2>
<div class="level2">

<p>
The <em>view_tab.htm</em> file needs to go in <code>&lt;luci-path&gt;/applications/luci-myapplication/luasrc/view/myapp-mymodule/</code>
</p>

<p>
Here are the contents of the file:
</p>
<!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_start&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:12,&quot;range&quot;:&quot;0-&quot;} --><div class="wrap_prewrap plugin_wrap" style="width: 1000px; max-width: 100%;"><pre class="code">&lt;%+header%&gt;                                                                    
&lt;h1&gt;&lt;%:Hello World%&gt;&lt;/h1&gt;                                                      
&lt;%+footer%&gt;</pre>
</div><!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_end&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:13,&quot;range&quot;:&quot;0-&quot;} -->
</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Adding the view_tab code&quot;,&quot;hid&quot;:&quot;adding_the_view_tab_code&quot;,&quot;codeblockOffset&quot;:3,&quot;secid&quot;:11,&quot;range&quot;:&quot;3003-&quot;} -->