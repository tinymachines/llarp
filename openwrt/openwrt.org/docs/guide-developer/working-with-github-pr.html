
<h1 class="sectionedit1" id="working_with_github">Working with GitHub</h1>
<div class="level1">

<p>
There are GitHub mirrors of the source repository <a href="https://github.com/openwrt/openwrt" class="urlextern" title="https://github.com/openwrt/openwrt" rel="ugc nofollow">here</a>.
</p>

<p>
Fork the project to a public repo using GitHub web interface, clone the repo to your computer, create a branch for your changes, push these back to GitHub and submit a pull request.
</p>

<p>
In case you don&#039;t know how to do that, keep reading.
</p>

<p>
Create a GitHub account, this will host your public fork of OpenWrt source, and will be used for all interaction on GitHub.
</p>

<p>
Install git in your PC, and make sure that your local git settings have the right name and email:
</p>
<pre class="code bash"><span class="kw2">git config</span> <span class="re5">--global</span> user.name <span class="st0">&quot;my name&quot;</span>
<span class="kw2">git config</span> <span class="re5">--global</span> user.email <span class="st0">&quot;my@email.address&quot;</span></pre>

<p>
You might also want to set the default text editor to your favorite editor.
If you have a Linux system with a <abbr title="Graphical User Interface">GUI</abbr>, some choices are <strong>geany</strong>, <strong>kwrite</strong>, <strong>pluma</strong> and <strong>gedit</strong>.
If you are using command line, <strong>nano</strong> is a good one.
</p>
<pre class="code bash"><span class="kw2">git config</span> <span class="re5">--global</span> core.editor <span class="st0">&quot;editor-name-here&quot;</span></pre>

<p>
Then follow GitHub&#039;s excellent documentation to <a href="https://help.github.com/articles/fork-a-repo/" class="urlextern" title="https://help.github.com/articles/fork-a-repo/" rel="ugc nofollow">Fork A Repo</a> and <a href="https://help.github.com/articles/fork-a-repo/#step-2-create-a-local-clone-of-your-fork" class="urlextern" title="https://help.github.com/articles/fork-a-repo/#step-2-create-a-local-clone-of-your-fork" rel="ugc nofollow">Create a local clone of your fork</a>.
</p>

<p>
After you have set it up as described, write
</p>
<pre class="code bash"><span class="kw2">git checkout</span> <span class="re5">-b</span> my-new-branch-name</pre>

<p>
to create a branch for your PR (“my-new-branch-name” is just an example name, use a more descriptive name in yours).
</p>

<p>
All commits you do after this command will be grouped in this branch.
This allows to have multiple branches, one for each PR.
To switch between branches you already created, use
</p>
<pre class="code bash"><span class="kw2">git checkout</span> my-branch-name</pre>

<p>
After you made your changes, write
</p>
<pre class="code bash"><span class="kw2">git add</span> <span class="re5">-i</span></pre>

<p>
and use its interface to add untracked (new) files and update existing ones.
</p>

<p>
Then write
</p>
<pre class="code bash"><span class="kw2">git commit</span> <span class="re5">--signoff</span></pre>

<p>
This will open the git default editor and you can write the commit message.
</p>

<p>
The first line is the commit subject, then leave an empty line, then you write the commit description.
This command will automatically add the Signed-off-by line with your name and email as set above.
For example, a complete commit message might look like this:
</p>
<pre class="code bash"><span class="sy0">&lt;</span>area<span class="sy0">&gt;</span>: the best code update.
&nbsp;
This is the best piece of code I have ever submitted.
&nbsp;
Signed-off-by: John Doe <span class="sy0">&lt;</span>John.Doe<span class="sy0">@</span>test.com<span class="sy0">&gt;</span></pre>

<p>
To send your local changes over to your GitHub repo, write
</p>
<pre class="code bash"><span class="kw2">git push</span> <span class="re5">--all</span></pre>

<p>
You will be asked your GitHub user and password in the process.
</p>

<p>
After the code has been uploaded to your GitHub repo, you can submit pull request using GitHub web interface, see again GitHub&#039;s documentation about <a href="https://help.github.com/articles/creating-a-pull-request/" class="urlextern" title="https://help.github.com/articles/creating-a-pull-request/" rel="ugc nofollow">Creating a pull request</a>.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Working with GitHub&quot;,&quot;hid&quot;:&quot;working_with_github&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:1,&quot;range&quot;:&quot;1-2787&quot;} -->
<h2 class="sectionedit2" id="squashing_commits">Squashing commits</h2>
<div class="level2">

<p>
Commits in a PR or sent by email should be about full changes you want to merge, not about fixing all issues the reviewers found in your original PR.
</p>

<p>
So, there will come a time when you will need to either rewrite or squash your commits; so you end with a normal amount of true and sane commits.
</p>

<p>
Work with git commandline.
Change to your development folder.
Look at the branches you have with:
</p>
<pre class="code bash"><span class="kw2">git branch</span> <span class="re5">-a</span></pre>

<p>
get something like:
</p>
<pre class="code bash">  best_code_update
<span class="sy0">*</span> master</pre>

<p>
Switch to the your development branch for this PR with:
</p>
<pre class="code bash"><span class="kw2">git checkout</span> best_code_update</pre>

<p>
Look at the git log, so you can count the number of commits you want to squash ( the “X” below ) with:
</p>
<pre class="code bash"><span class="kw2">git log</span></pre>

<p>
Delete commits with:
</p>
<pre class="code bash"><span class="kw2">git reset</span> HEAD~X</pre>

<p>
(where X is the number of commits you want to delete, counted from the last commit), this will not change modified files, it will only delete the commits.
</p>

<p>
Add the files to git tracking again with:
</p>
<pre class="code bash"><span class="kw2">git add</span> <span class="re5">-i</span></pre>

<p>
and commit again with:
</p>
<pre class="code bash"><span class="kw2">git commit</span> <span class="re5">--signoff</span></pre>

<p>
Send the updated branch over to GitHub with:
</p>
<pre class="code bash"><span class="kw2">git push</span> <span class="re5">-f</span></pre>

<p>
and the commits in the PR will be updated automatically.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Squashing commits&quot;,&quot;hid&quot;:&quot;squashing_commits&quot;,&quot;codeblockOffset&quot;:8,&quot;secid&quot;:2,&quot;range&quot;:&quot;2788-4055&quot;} -->
<h3 class="sectionedit3" id="alternative_squashing_advice">Alternative squashing advice</h3>
<div class="level3">

<p>
You can use <strong>interactive rebase</strong> to combine, reorder and edit your commits and their commit messages, with:
</p>
<pre class="code bash"><span class="kw2">git rebase</span> <span class="re5">-i</span> HEAD~X</pre>

<p>
Where X is a number of commits to edit.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Alternative squashing advice&quot;,&quot;hid&quot;:&quot;alternative_squashing_advice&quot;,&quot;codeblockOffset&quot;:16,&quot;secid&quot;:3,&quot;range&quot;:&quot;4056-4289&quot;} -->
<h2 class="sectionedit4" id="reopen_closed_pr">Reopen closed PR</h2>
<div class="level2">

<p>
GitHub will grey out “Reopen” and will not let you reopen a PR if you force-pushed anything to the relevant branch after the PR has been closed, or deleted the branch.
</p>

<p>
However, reopening is still possible if you just set back the GitHub branch to the exact commit ID/hash it was at when you closed it. This even works when the branch or even the whole repository was deleted on GitHub. It just has to be recreated with the same name (for repo and branch) and the same commit hash at the branches HEAD.
</p>

<p>
A possible way to do that would be (there might be others, even shorter ones):
</p>

<p>
<em>We assume that the git remote referring to GitHub is called “origin”, the branch of interest is called “testbranch”, and the local and remote branch names are the same.</em>
</p>
<pre class="code bash"><span class="co0"># Get the hash yyyyyyyyyyyyyyy of the current state of &quot;testbranch&quot; (we will move the branch head later)</span>
<span class="kw2">git log</span> <span class="re5">-1</span> testbranch
<span class="co0"># Checkout the latest state of the PR (commit hash xxxxxxxxxxx)</span>
<span class="kw2">git checkout</span> xxxxxxxxxx
<span class="co0"># Delete old testbranch</span>
<span class="kw2">git branch</span> <span class="re5">-D</span> testbranch
<span class="co0"># Label current state as testbranch</span>
<span class="kw2">git checkout</span> <span class="re5">-b</span> testbranch
<span class="co0"># Push old state to GitHub</span>
<span class="kw2">git push</span> <span class="re5">-f</span> origin testbranch</pre>

<p>
Now you got GitHub at the state it was at when closing the PR. It should now be possible to “reopen” the PR.
Note that this will only be possible if <em>you</em> closed it. If it was closed by an admin, you will have to ask an admin to reopen it (though they will also only be able to do that when the branch is at the proper hash).
If the PR is reopened, you can update as usual, e.g.
</p>
<pre class="code bash"><span class="co0"># Checkout the desired hash yyyyyyyyy (or branch)</span>
<span class="kw2">git checkout</span> yyyyyyyyy
<span class="co0"># Delete intermediate testbranch</span>
<span class="kw2">git branch</span> <span class="re5">-D</span> testbranch
<span class="co0"># Label current state as testbranch</span>
<span class="kw2">git checkout</span> <span class="re5">-b</span> testbranch
<span class="co0"># Push new state to GitHub</span>
<span class="kw2">git push</span> <span class="re5">-f</span> origin testbranch</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Reopen closed PR&quot;,&quot;hid&quot;:&quot;reopen_closed_pr&quot;,&quot;codeblockOffset&quot;:17,&quot;secid&quot;:4,&quot;range&quot;:&quot;4290-&quot;} -->