
<h1 class="sectionedit1" id="write_shell_scripts_in_openwrt">Write shell scripts in OpenWrt</h1>
<div class="level1">

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Write shell scripts in OpenWrt&quot;,&quot;hid&quot;:&quot;write_shell_scripts_in_openwrt&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:1,&quot;range&quot;:&quot;1-46&quot;} -->
<h2 class="sectionedit2" id="the_default_openwrt_shell_is_ashthe_almquist_shell">The default OpenWrt shell is ash: the Almquist shell</h2>
<div class="level2">

<p>
The default <a href="https://en.wikipedia.org/wiki/Command-line_interface" class="interwiki iw_wp" title="https://en.wikipedia.org/wiki/Command-line_interface">shell</a> provided with <em>OpenWrt</em> is the <a href="https://en.wikipedia.org/wiki/Almquist_shell" class="interwiki iw_wp" title="https://en.wikipedia.org/wiki/Almquist_shell">Almquist shell</a>, which is better known as the <em>ash shell</em> and is also the default <a href="https://en.wikipedia.org/wiki/BusyBox" class="interwiki iw_wp" title="https://en.wikipedia.org/wiki/BusyBox">Busybox</a> shell. Most <a href="https://en.wikipedia.org/wiki/Linux_distribution" class="interwiki iw_wp" title="https://en.wikipedia.org/wiki/Linux_distribution">Linux distros</a>, such as <a href="https://en.wikipedia.org/wiki/Ubuntu" class="interwiki iw_wp" title="https://en.wikipedia.org/wiki/Ubuntu">Ubuntu</a> or <a href="https://en.wikipedia.org/wiki/Debian" class="interwiki iw_wp" title="https://en.wikipedia.org/wiki/Debian">Debian</a>, will use the <a href="https://en.wikipedia.org/wiki/Bash_(Unix_shell)" class="interwiki iw_wp" title="https://en.wikipedia.org/wiki/Bash_(Unix_shell)">Bash</a> shell, which is much bigger and more complex than <em>ash</em>. For example, a typical <em>bash</em> implementation requires approximately 1 <abbr title="Megabyte">MB</abbr> of disk space, which is an extravagant waste of memory/space in an embedded device.
</p>

<p>
By contrast, <em>BusyBox</em> fits in less than 512 KB of space, and, in addition to providing the <em>ash</em> shell, it also provides many other tools you will need to manage your OpenWrt device. Some examples of the other very useful tools provided by <em>BusyBox</em> include <a href="https://en.wikipedia.org/wiki/AWK" class="interwiki iw_wp" title="https://en.wikipedia.org/wiki/AWK">awk</a>, <a href="https://en.wikipedia.org/wiki/grep" class="interwiki iw_wp" title="https://en.wikipedia.org/wiki/grep">grep</a>, <a href="https://en.wikipedia.org/wiki/sed" class="interwiki iw_wp" title="https://en.wikipedia.org/wiki/sed">sed</a>, and <a href="https://en.wikibooks.org/wiki/Learning_the_vi_Editor/BusyBox_vi" class="urlextern" title="https://en.wikibooks.org/wiki/Learning_the_vi_Editor/BusyBox_vi" rel="ugc nofollow">vi/vim</a>. Note that the stock (<em>i.e.</em> factory) firmware that ships with many routers also uses <em>BusyBox</em> for the reasons outlined here.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;The default OpenWrt shell is ash: the Almquist shell&quot;,&quot;hid&quot;:&quot;the_default_openwrt_shell_is_ashthe_almquist_shell&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:2,&quot;range&quot;:&quot;47-1216&quot;} -->
<h2 class="sectionedit3" id="openwrt_busybox_and_the_ash_shell">OpenWrt, BusyBox, and the ash shell</h2>
<div class="level2">

<p>
OpenWrt firmware uses <a href="https://en.wikipedia.org/wiki/Busybox" class="interwiki iw_wp" title="https://en.wikipedia.org/wiki/Busybox">BusyBox</a> because it is extremely efficient with respect to 1) the size required to install it and run it in RAM, and 2) the amount of functionality it provides. Please be aware that many of the <em>BusyBox</em> implementations of common Linux/Unix tools might be more limited than their full desktop counterparts. However, <em>Bash</em> and <em>Busybox</em> shell are similar enough for the majority of daily use cases. If your script is using the <a href="https://en.wikipedia.org/wiki/POSIX" class="interwiki iw_wp" title="https://en.wikipedia.org/wiki/POSIX">POSIX</a> features of the <em>Bash</em> shell, then it will work in the <em>Ash</em> shell, too.
</p>
<hr />

<p>
<strong>Q: Can I install a full version of Bash or other Linux CLI tools, including my favorite editor?</strong>
</p>

<p>
<strong>A: Yes!</strong> <em>(but there is a catch)</em>
</p>

<p>
If your router supports USB storage and you choose to <a href="/docs/guide-user/storage/usb-drives-quickstart" class="wikilink1" title="docs:guide-user:storage:usb-drives-quickstart" data-wiki-id="docs:guide-user:storage:usb-drives-quickstart">install and configure a USB drive</a> with your OpenWrt device, you will have much more storage space for installing programs. If you choose to go this route, then you can install the <a href="/packages/pkgdata/bash" class="wikilink1" title="packages:pkgdata:bash" data-wiki-id="packages:pkgdata:bash">bash package</a> very easily. Also, OpenWrt contains many packages for installing the full versions of core Linux shell utilities, such as <a href="/packages/pkgdata/coreutils-basename" class="wikilink1" title="packages:pkgdata:coreutils-basename" data-wiki-id="packages:pkgdata:coreutils-basename">basename</a>, <a href="/packages/pkgdata/coreutils-cat" class="wikilink1" title="packages:pkgdata:coreutils-cat" data-wiki-id="packages:pkgdata:coreutils-cat">cat</a>, <a href="/packages/pkgdata/coreutils-rm" class="wikilink1" title="packages:pkgdata:coreutils-rm" data-wiki-id="packages:pkgdata:coreutils-rm">rm</a>, <a href="/packages/pkgdata/coreutils-sort" class="wikilink1" title="packages:pkgdata:coreutils-sort" data-wiki-id="packages:pkgdata:coreutils-sort">sort</a>, or <a href="/packages/pkgdata/coreutils-sleep" class="wikilink1" title="packages:pkgdata:coreutils-sleep" data-wiki-id="packages:pkgdata:coreutils-sleep">sleep</a>. To get an idea of the full list of available CLI packages, visit the web page for the OpenWrt packages in the <a href="/packages/index/utilities" class="wikilink1" title="packages:index:utilities" data-wiki-id="packages:index:utilities">Utilities</a> category and search for all packages that start with <em>coreutils</em>. Also, OpenWrt contains many full sized versions of popular <a href="/packages/index/utilities---editors" class="wikilink1" title="packages:index:utilities---editors" data-wiki-id="packages:index:utilities---editors">Linux editors</a> such as <a href="/packages/pkgdata/nano" class="wikilink1" title="packages:pkgdata:nano" data-wiki-id="packages:pkgdata:nano">nano</a> and vim (see <a href="/packages/pkgdata/vim" class="wikilink1" title="packages:pkgdata:vim" data-wiki-id="packages:pkgdata:vim">vim</a>, <a href="/packages/pkgdata/vim-full" class="wikilink1" title="packages:pkgdata:vim-full" data-wiki-id="packages:pkgdata:vim-full">vim-full</a>, <a href="/packages/pkgdata/vim-fuller" class="wikilink1" title="packages:pkgdata:vim-fuller" data-wiki-id="packages:pkgdata:vim-fuller">vim-fuller</a>).
</p>

<p>
<strong>WARNING: DO NOT INSTALL ANY OF THE vim PACKAGES LINKED HERE UNLESS YOU HAVE INSTALLED A USB DRIVE.</strong>
</p>

<p>
To illustrate the reason for this warning, as of v19.0x, the <a href="/packages/pkgdata/vim-fuller" class="wikilink1" title="packages:pkgdata:vim-fuller" data-wiki-id="packages:pkgdata:vim-fuller">vim-fuller</a> package binary is ~2.8 <abbr title="Megabyte">MB</abbr>, and it will be even larger when installed.
</p>
<hr />

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;OpenWrt, BusyBox, and the ash shell&quot;,&quot;hid&quot;:&quot;openwrt_busybox_and_the_ash_shell&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:3,&quot;range&quot;:&quot;1217-3436&quot;} -->
<h2 class="sectionedit4" id="the_shebang_operator_and_shell_scripting_for_openwrt">The shebang Operator and Shell Scripting for OpenWrt</h2>
<div class="level2">

<p>
Scripts in OpenWrt should have the shebang <code>#!/bin/sh</code> at the first line.
</p>

<p>
A shebang of  <code>#!/bin/bash</code> can be used, but of course, only if the bash package is installed.
</p>

<p>
For more information, refer to the <a href="https://en.wikipedia.org/wiki/Shebang_(Unix)" class="interwiki iw_wp" title="https://en.wikipedia.org/wiki/Shebang_(Unix)">shebang</a> operator.
</p>
<hr />

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;The shebang Operator and Shell Scripting for OpenWrt&quot;,&quot;hid&quot;:&quot;the_shebang_operator_and_shell_scripting_for_openwrt&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:4,&quot;range&quot;:&quot;3437-3759&quot;} -->
<h3 class="sectionedit5" id="can_i_change_my_default_shell_from_ash_to_bash">Can I change my default shell from ash to bash?</h3>
<div class="level3">

<p>
The short answer is “<em>yes</em>”, but this practice is not recommended.
</p>

<p>
<strong>WARNING: If you update <em>/etc/passwd</em> to change the <em>root</em> account&#039;s default shell to anything other than <code>#!/bin/sh</code>, there is a good chance you will be unable to log in to your router via <abbr title="Secure Shell">SSH</abbr></strong>.
</p>

<p>
If you&#039;ve installed the <a href="/packages/pkgdata/bash" class="wikilink1" title="packages:pkgdata:bash" data-wiki-id="packages:pkgdata:bash">OpenWrt bash</a> package on your router and then changed your default shell to <code>#!/bin/bash</code>, you will be able to login to your device via <abbr title="Secure Shell">SSH</abbr>. However, the risk in doing so is that you may still lock yourself out of your device inadvertently, for example, by upgrading. The working assumption for OpenWrt is that <em>ash</em> will be the default shell. If you want to use the <em>bash</em> shell regularly, then simply run the <em>bash</em> command each time you login to your device.
</p>

<p>
In the event you are having difficulty accessing your device via <abbr title="Secure Shell">SSH</abbr>, refer to the OpenWrt <a href="/docs/guide-user/troubleshooting/failsafe_and_factory_reset" class="wikilink1" title="docs:guide-user:troubleshooting:failsafe_and_factory_reset" data-wiki-id="docs:guide-user:troubleshooting:failsafe_and_factory_reset">failsafe process</a>.
</p>
<hr />

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Can I change my default shell from ash to bash?&quot;,&quot;hid&quot;:&quot;can_i_change_my_default_shell_from_ash_to_bash&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:5,&quot;range&quot;:&quot;3760-4794&quot;} -->
<h2 class="sectionedit6" id="automated_shell_script_checking">Automated shell script checking</h2>
<div class="level2">

<p>
Write your bash scripts with <code>#!/bin/sh</code> first line in <a href="https://www.shellcheck.net/" class="urlextern" title="https://www.shellcheck.net/" rel="ugc nofollow">https://www.shellcheck.net/</a> and it will check for features you cannot use in OpenWrt shell.
see the <a href="https://github.com/koalaman/shellcheck/blob/master/README.md#portability" class="urlextern" title="https://github.com/koalaman/shellcheck/blob/master/README.md#portability" rel="ugc nofollow">https://github.com/koalaman/shellcheck/blob/master/README.md#portability</a>
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Automated shell script checking&quot;,&quot;hid&quot;:&quot;automated_shell_script_checking&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:6,&quot;range&quot;:&quot;4795-5078&quot;} -->
<h2 class="sectionedit7" id="check_if_a_tool_is_available">Check if a tool is available</h2>
<div class="level2">

<p>
You may need to install additional command line tools in OpenWrt, as the default installation is very minimal.
A Desktop PC Linux like Ubuntu has much more command line tools in default install.
</p>

<p>
Check if a tool is available by writing <strong>type tool-name</strong> and it will answer you where this tool is, or an error if there is no such tool installed. Use the package table or index (Packages link in the sidebar to the left of this article) to find the package with the tool you need.
</p>
<pre class="code"># type time
time is /usr/bin/time</pre>

<p>
See also: <a href="/docs/guide-developer/config-scripting" class="wikilink1" title="docs:guide-developer:config-scripting" data-wiki-id="docs:guide-developer:config-scripting">Configuration in scripts</a>
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Check if a tool is available&quot;,&quot;hid&quot;:&quot;check_if_a_tool_is_available&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:7,&quot;range&quot;:&quot;5079-&quot;} -->