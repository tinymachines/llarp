
<h1 class="sectionedit1" id="openwrt_feeds">OpenWrt Feeds</h1>
<div class="level1">

<p>
In OpenWrt, a “feed” is a collection of <a href="/docs/guide-developer/packages" class="wikilink1" title="docs:guide-developer:packages" data-wiki-id="docs:guide-developer:packages">packages</a> which share a common location.  Feeds may reside on a remote server, in a version control system, on the local filesystem, or in any other location addressable by a single name (path/<abbr title="Uniform Resource Locator">URL</abbr>) over a protocol with a supported feed method.
</p>

<p>
Feeds are additional predefined package build recipes for OpenWrt Buildroot. They may be configured to support custom feeds or non-default feed packages via a feed configuration file.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;OpenWrt Feeds&quot;,&quot;hid&quot;:&quot;openwrt_feeds&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:1,&quot;range&quot;:&quot;1-523&quot;} -->
<h2 class="sectionedit2" id="feed_configuration">Feed Configuration</h2>
<div class="level2">

<p>
The list of usable feeds is configured from either the <code>feeds.conf</code> file, if it exists, or otherwise the <code>feeds.conf.default</code> file.  This file contains a list of feeds with each feed listed on a separate line. Each feed line consists of 3 whitespace-separated components:  The feed method, the feed name, and the feed source. Blank lines, excessive white-space/newlines, and comments are ignored during parsing. Comments begin with `#` and extend to the end of a line.
</p>

<p>
As of 2018-12-15 on the <code>master</code> branch, the defaults contained within <code>feeds.conf.default</code> appear as follows. Note that the <code>#</code> prefixed lines are commented out and included for ease of configuration.
</p>
<dl class="file">
<dt><a href="/_export/code/docs/guide-developer/feeds?codeblock=0" title="Download Snippet" class="mediafile mf_default">feeds.conf.default</a></dt>
<dd><pre class="code file xml">src-git packages https://git.openwrt.org/feed/packages.git
src-git luci https://git.openwrt.org/project/luci.git
src-git routing https://git.openwrt.org/feed/routing.git
src-git telephony https://git.openwrt.org/feed/telephony.git
#src-git video https://github.com/openwrt/video.git
#src-git targets https://github.com/openwrt/targets.git
#src-git management https://github.com/openwrt-management/packages.git
#src-git oldpackages http://git.openwrt.org/packages.git
#src-link custom /usr/src/openwrt/custom-feed</pre>
</dd></dl>

<p>
The git method can specify a specific branch or commit using the following formats
</p>
<pre class="file">src-git local_feed_name https://example.com/repo_name/something.git;branch_name
src-git local_feed_name https://example.com/repo_name/something.git^commit_hash</pre>

<p>
As of this writing, the following feed methods are supported:
</p>
<div class="table sectionedit3"><table class="inline">
	<thead>
	<tr class="row0">
		<th class="col0 leftalign"> Method    </th><th class="col1"> Function </th>
	</tr>
	</thead>
	<tr class="row1">
		<td class="col0 leftalign"> src-bzr   </td><td class="col1"> Data is downloaded from the source path/<abbr title="Uniform Resource Locator">URL</abbr> using <code>bzr</code> </td>
	</tr>
	<tr class="row2">
		<td class="col0 leftalign"> src-cpy   </td><td class="col1"> Data is copied from the source path. The path can be specified as either relative to OpenWrt repository root or absolute. </td>
	</tr>
	<tr class="row3">
		<td class="col0"> src-darcs </td><td class="col1"> Data is downloaded from the source path/<abbr title="Uniform Resource Locator">URL</abbr> using <code>darcs</code> </td>
	</tr>
	<tr class="row4">
		<td class="col0 leftalign"> src-git   </td><td class="col1"> Data is downloaded from the source path/<abbr title="Uniform Resource Locator">URL</abbr> using <code>git</code> as a shallow (depth of 1) clone </td>
	</tr>
	<tr class="row5">
		<td class="col0"> src-git-full </td><td class="col1"> Data is downloaded from the source path/<abbr title="Uniform Resource Locator">URL</abbr> using <code>git</code> as a full clone </td>
	</tr>
	<tr class="row6">
		<td class="col0"> src-gitsvn </td><td class="col1"> Bidirectional operation between a Subversion repository and git </td>
	</tr>
	<tr class="row7">
		<td class="col0 leftalign"> src-hg    </td><td class="col1"> Data is downloaded from the source path/<abbr title="Uniform Resource Locator">URL</abbr> using <code>hg</code> </td>
	</tr>
	<tr class="row8">
		<td class="col0 leftalign"> src-link  </td><td class="col1"> A symlink to the source path is created. The path must be absolute. </td>
	</tr>
	<tr class="row9">
		<td class="col0 leftalign"> src-svn   </td><td class="col1"> Data is downloaded from the source path/<abbr title="Uniform Resource Locator">URL</abbr> using <code>svn</code> </td>
	</tr>
</table></div>
<!-- EDIT{&quot;target&quot;:&quot;table&quot;,&quot;name&quot;:&quot;&quot;,&quot;hid&quot;:&quot;table&quot;,&quot;secid&quot;:3,&quot;range&quot;:&quot;2113-2936&quot;} -->
<p>
Feed names are used to identify feeds and serve as the basis for several file and directory names that are created to hold information about the feeds.  The feed source is the location from which the feed data is downloaded.  
</p>

<p>
For the methods listed above which rely on version control systems that support a “limited history” option (such as <code>--depth=1</code> for git and <code>--lightweight</code> for bzr) the smallest available history is downloaded.  This is a good default, but developers who are actively committing to a feed and/or using the commit history may want to change this behavior.  This can be done by editing <code>scripts/feeds</code> to use <code>src-git-full</code> or by checking out the feed without using <code>scripts/feeds</code>. A shallow git clone can be updated to a “full” clone through use of <code>git fetch --unshallow</code>
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Feed Configuration&quot;,&quot;hid&quot;:&quot;feed_configuration&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:2,&quot;range&quot;:&quot;524-3763&quot;} -->
<h2 class="sectionedit4" id="working_with_feeds">Working with Feeds</h2>
<div class="level2">

<p>
As of December, 2018, feeds are retrieved and managed by the script <code>scripts/feeds</code> within the <code>openwrt/openwrt.git</code> repository. The <code>feeds</code> script incorporates packages from a variety of feed sources into the OpenWrt build system. This is a two step process done by the developer before building an image by updating a feed followed by installing packages from specific to that feed.
</p>

<p>
During the <code>update</code> step, the feeds are obtained from their sources listed within a <a href="/docs/guide-developer/feeds#feed_configuration" class="wikilink1" title="docs:guide-developer:feeds" data-wiki-id="docs:guide-developer:feeds">feed configuration</a> and then copied into the <code>feeds</code> directory. After a successful update, each package recipe within a feed is represented within a folder in <code>feeds/&lt;feed_name&gt;/&lt;package_name&gt;/</code>, but they are not currently incorporated into the OpenWrt build system as they are not contained within the `package/` directory.
</p>

<p>
During the <code>install</code> step, packages from the feeds obtained during an `update` are then linked into the <code>package/feeds/&lt;feed_name&gt;</code> folder, where <code>&lt;feed_name&gt;</code> is replaced by the name of the feed in the feed configuration. After this step, it is then possible to perform package specific make operations by utilizing their path within the <code>package/</code> folder. For example:
</p>

<p>
<code>make package/feeds/&lt;feed_name&gt;/&lt;package_name&gt;</code>
</p>
<pre class="file">$ ./scripts/feeds 
Usage: ./scripts/feeds &lt;command&gt; [options]

Commands:
	list [options]: List feeds, their content and revisions (if installed)
	Options:
	    -n :            List of feed names.
	    -s :            List of feed names and their URL.
	    -r &lt;feedname&gt;:  List packages of specified feed.
	    -d &lt;delimiter&gt;: Use specified delimiter to distinguish rows (default: spaces)
	    -f :            List feeds in feeds.conf compatible format (when using -s).

	install [options] &lt;package&gt;: Install a package
	Options:
	    -a :           Install all packages from all feeds or from the specified feed using the -p option.
	    -p &lt;feedname&gt;: Prefer this feed when installing packages.
	    -d &lt;y|m|n&gt;:    Set default for newly installed packages.
	    -f :           Install will be forced even if the package exists in core OpenWrt (override)

	search [options] &lt;substring&gt;: Search for a package
	Options:
	    -r &lt;feedname&gt;: Only search in this feed

	uninstall -a|&lt;package&gt;: Uninstall a package
	Options:
	    -a :           Uninstalls all packages.

	update -a|&lt;feedname(s)&gt;: Update packages and lists of feeds in feeds.conf .
	Options:
	    -a :           Update all feeds listed within feeds.conf. Otherwise the specified feeds will be updated.
	    -i :           Recreate the index only. No feed update from repository is performed.
	    -f :           Force updating feeds even if there are changed, uncommitted files.

	clean:             Remove downloaded/generated files.</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Working with Feeds&quot;,&quot;hid&quot;:&quot;working_with_feeds&quot;,&quot;codeblockOffset&quot;:2,&quot;secid&quot;:4,&quot;range&quot;:&quot;3764-6594&quot;} -->
<h3 class="sectionedit5" id="feed_commands">Feed Commands</h3>
<div class="level3">

<p>
Feeds can be utilized through the <code>scripts/feeds</code> script.  A list of the available commands is generated by invoking <code>scripts/feeds</code> without any arguments.  Most commands require the feed information to be available locally, so running update first is usually necessary.  In the following discussion the term “applicable packages” usually refers to the package names given on the command line or all packages in a feed when the -a option is used.
</p>

</div>

<h4 id="clean">Clean</h4>
<div class="level4">

<p>
The clean command removes the locally stored feed data, including the feed indexes and data for all packages in the feed (but not the symlinks created by the install command, which will be dangling until the feeds are re-downloaded by the update command).  This is done by removing the <code>feeds</code> directory and all subdirectories.
</p>

</div>

<h4 id="install">Install</h4>
<div class="level4">

<p>
The install command installs the applicable packages and any packages on which the applicable packages depend (both direct dependencies and build dependencies).  The installation process consists of creating a symbolic link from <code>package/feeds/$feed_name/$package_name</code> to <code>feeds/$feed_name/$package_name</code> so that the package will be included in the configuration process when the directory hierarchy under <code>packages</code> is searched.
</p>
<div class="table sectionedit6"><table class="inline">
	<thead>
	<tr class="row0">
		<th class="col0 leftalign"> Command                            </th><th class="col1"> Description </th>
	</tr>
	</thead>
	<tr class="row1">
		<td class="col0 leftalign"> ./scripts/feeds install -a         </td><td class="col1"> Install all packages (not required; packages can be installed on an as-needed basis for slow build machines) </td>
	</tr>
	<tr class="row2">
		<td class="col0 leftalign"> ./scripts/feeds install luci       </td><td class="col1"> Install only the package LuCI </td>
	</tr>
	<tr class="row3">
		<td class="col0"> ./scripts/feeds install -a -p luci </td><td class="col1"> Install the complete LuCI WebUI by installing all (-a) packages from the preferred feed (-p) luci </td>
	</tr>
</table></div>
<!-- EDIT{&quot;target&quot;:&quot;table&quot;,&quot;name&quot;:&quot;&quot;,&quot;hid&quot;:&quot;table1&quot;,&quot;secid&quot;:6,&quot;range&quot;:&quot;7873-8285&quot;} -->
<p>
See the above section for a list of the feeds available by default.
</p>
<div class="table sectionedit7"><table class="inline">
	<tr class="row0">
		<td class="col0"> <img src="/_media/meta/icons/tango/48px-outdated.svg.png" class="media" loading="lazy" alt="" /> </td><td class="col1 leftalign"> Please note that this replaces the old method of creating symlinks, which can be still found on-line in many old forum and user-group entries  </td>
	</tr>
</table></div>
<!-- EDIT{&quot;target&quot;:&quot;table&quot;,&quot;name&quot;:&quot;&quot;,&quot;hid&quot;:&quot;table2&quot;,&quot;secid&quot;:7,&quot;range&quot;:&quot;8356-8555&quot;} -->
</div>

<h4 id="list">List</h4>
<div class="level4">

<p>
The list command reads and displays the list of packages in each feed from the index file for the applicable feeds.   The index file is stored in the <code>feeds</code> directory with the name of the feed suffixed with <code>.index</code>.  The file is generated by the update command.
</p>

</div>

<h4 id="search">Search</h4>
<div class="level4">

<p>
The search command reads through the feed metadata and lists packages which match the given search criteria.
</p>

</div>

<h4 id="uninstall">Uninstall</h4>
<div class="level4">

<p>
The uninstall command does the opposite of the install command (although it does not address dependent packages in any way).  It simply removes any symlinks to the package from the subdirectories of <code>package/feeds</code>.
</p>

</div>

<h4 id="update">Update</h4>
<div class="level4">

<p>
When <code>scripts/feeds update</code> is invoked, each of the applicable feeds are downloaded from their source location into a subdirectory of <code>feeds</code> with the feed name.  It then parses the package information from the feed into an index file used by the list and search commands.
</p>
<div class="table sectionedit8"><table class="inline">
	<thead>
	<tr class="row0">
		<th class="col0 leftalign"> Command                              </th><th class="col1"> Description </th>
	</tr>
	</thead>
	<tr class="row1">
		<td class="col0"> ./scripts/feeds update packages luci </td><td class="col1"> Checkout the packages and luci feeds </td>
	</tr>
</table></div>
<!-- EDIT{&quot;target&quot;:&quot;table&quot;,&quot;name&quot;:&quot;&quot;,&quot;hid&quot;:&quot;table3&quot;,&quot;secid&quot;:8,&quot;range&quot;:&quot;9498-9632&quot;} -->
<p>
Note that update also stores the configured location of the feed in <code>feeds/$feed_name.tmp/location</code> such that changes to the configuration can be detected and handled appropriately.
</p>

<p>
After retrieval the downloaded packages need to be <em>“installed”</em>. Only after installation will they be available in the configuration interface!
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Feed Commands&quot;,&quot;hid&quot;:&quot;feed_commands&quot;,&quot;codeblockOffset&quot;:3,&quot;secid&quot;:5,&quot;range&quot;:&quot;6595-9966&quot;} -->
<h2 class="sectionedit9" id="custom_feeds">Custom Feeds</h2>
<div class="level2">

<p>
Ok, you&#039;ve developed your package, and now you want to use it via make menuconfig, OR you are developing a package and you want to test it in a build before you try to get it included in OpenWrt.
</p>

<p>
The solution is a custom feed.   You can either create an entirely new feed, or use a modified version of one of the standard ones.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Custom Feeds&quot;,&quot;hid&quot;:&quot;custom_feeds&quot;,&quot;codeblockOffset&quot;:3,&quot;secid&quot;:9,&quot;range&quot;:&quot;9967-10322&quot;} -->
<h3 class="sectionedit10" id="creating_the_package_directory">Creating the package directory</h3>
<div class="level3">

<p>
For this example we assume that your are in <code>/home/user/openwrt</code> as your base directory.
</p>

</div>

<h4 id="adding_your_package_to_an_existing_feed">Adding your package to an existing feed</h4>
<div class="level4">

<p>
<img src="/lib/images/smileys/fixme.svg" class="icon smiley" alt="FIXME" />
</p>

</div>

<h4 id="adding_your_package_to_your_own_feed">Adding your package to your own feed</h4>
<div class="level4">

<p>
For this example we assume that you name your feed <code>custom</code> and your project is called <code>helloworld</code> and its openwrt Makefile is located at <code>/usr/src/openwrt/custom-feed/helloworld/Makefile</code>.
</p>
<ol>
<li class="level1"><div class="li"> Edit <code>/home/user/openwrt/feeds.conf.default</code></div>
</li>
<li class="level1"><div class="li"> Add a new line for your feed. <pre class="code">src-link custom /usr/src/openwrt/custom-feed/</pre>
</div>
</li>
</ol>
<ol>
<li class="level1"><div class="li"> Update the feed: from the <code>&lt;buildroot dir&gt;</code> (e.g. <code>/home/user/openwrt</code>) do: <pre class="code">./scripts/feeds update custom</pre>
</div>
</li>
<li class="level1"><div class="li"> And then install it <pre class="code">./scripts/feeds install -a -p custom</pre>
</div>
</li>
</ol>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Creating the package directory&quot;,&quot;hid&quot;:&quot;creating_the_package_directory&quot;,&quot;codeblockOffset&quot;:3,&quot;secid&quot;:10,&quot;range&quot;:&quot;10323-11106&quot;} -->
<h3 class="sectionedit11" id="using_the_feed">Using the feed</h3>
<div class="level3">
<ol>
<li class="level1"><div class="li"> Now your package(s) should be available when you do <pre class="code">make menuconfig</pre>
</div>
</li>
</ol>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Using the feed&quot;,&quot;hid&quot;:&quot;using_the_feed&quot;,&quot;codeblockOffset&quot;:6,&quot;secid&quot;:11,&quot;range&quot;:&quot;11107-11217&quot;} -->
<h2 class="sectionedit12" id="explanations">Explanations</h2>
<div class="level2">

<p>
The downloaded sources (referenced in package Makefiles) are not there...
The downloads go first to &lt;buildroot&gt;/dl as gzipped .gz files. And there they are stored and then they get unzipped to /build_dir. See e.g. &lt;buildroot&gt;/build_dir/target-*/ and below it you will find subdirectories for each package&#039;s sources.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Explanations&quot;,&quot;hid&quot;:&quot;explanations&quot;,&quot;codeblockOffset&quot;:7,&quot;secid&quot;:12,&quot;range&quot;:&quot;11218-11559&quot;} -->
<h3 class="sectionedit13" id="documentation">Documentation</h3>
<div class="level3">
<ol>
<li class="level1"><div class="li"> <a href="/docs/guide-developer/toolchain/start" class="wikilink1" title="docs:guide-developer:toolchain:start" data-wiki-id="docs:guide-developer:toolchain:start">OpenWrt Buildroot – About</a></div>
</li>
<li class="level1"><div class="li"> <a href="/docs/guide-developer/toolchain/install-buildsystem" class="wikilink1" title="docs:guide-developer:toolchain:install-buildsystem" data-wiki-id="docs:guide-developer:toolchain:install-buildsystem">OpenWrt Buildroot – Installation</a></div>
</li>
<li class="level1"><div class="li"> <a href="/docs/guide-developer/toolchain/use-buildsystem" class="wikilink1" title="docs:guide-developer:toolchain:use-buildsystem" data-wiki-id="docs:guide-developer:toolchain:use-buildsystem">OpenWrt Buildroot – Usage</a></div>
</li>
<li class="level1"><div class="li"> OpenWrt Buildroot – Feeds</div>
</li>
<li class="level1"><div class="li"> <a href="/docs/techref/buildroot" class="wikilink1" title="docs:techref:buildroot" data-wiki-id="docs:techref:buildroot">OpenWrt Buildroot – Technical Reference</a> <img src="/_media/meta/icons/tango/48px-construction.svg.png?w=16&amp;tok=1378c8" class="media" loading="lazy" alt="" width="16" /> this article needs <em>your</em> attention.</div>
</li>
</ol>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Documentation&quot;,&quot;hid&quot;:&quot;documentation&quot;,&quot;codeblockOffset&quot;:7,&quot;secid&quot;:13,&quot;range&quot;:&quot;11560-12037&quot;} -->
<h2 class="sectionedit14" id="links">Links</h2>
<div class="level2">

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Links&quot;,&quot;hid&quot;:&quot;links&quot;,&quot;codeblockOffset&quot;:7,&quot;secid&quot;:14,&quot;range&quot;:&quot;12038-&quot;} -->