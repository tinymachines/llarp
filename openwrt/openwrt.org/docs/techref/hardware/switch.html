
<h1 class="sectionedit1" id="ethernet_network_switch">Ethernet Network Switch</h1>
<div class="level1">

<p>
Many devices supported by OpenWrt contain an Ethernet network switch. Most switches are <em>configurable</em> and driver options are available. Typical features include ethernet frame tagging and <a href="/docs/guide-user/network/vlan/switch_configuration" class="wikilink1" title="docs:guide-user:network:vlan:switch_configuration" data-wiki-id="docs:guide-user:network:vlan:switch_configuration">VLAN</a> support. We require two software components:
</p>
<ol>
<li class="level1"><div class="li"> A kind of a driver</div>
</li>
<li class="level1"><div class="li"> A utility</div>
</li>
</ol>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Ethernet Network Switch&quot;,&quot;hid&quot;:&quot;ethernet_network_switch&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:1,&quot;range&quot;:&quot;1-371&quot;} -->
<h2 class="sectionedit2" id="dsa_distributed_network_switch">DSA Distributed Network Switch</h2>
<div class="level2">

<p>
The preferred contemporary driver architecture for ethernet switches in the Linux kernel is <a href="https://www.kernel.org/doc/html/latest/networking/dsa/dsa.html" class="urlextern" title="https://www.kernel.org/doc/html/latest/networking/dsa/dsa.html" rel="ugc nofollow">DSA (distributed switch architecture)</a>.
</p>

<p>
For a user the main difference to past OpenWrt switch drivers is that all the switch ports that on a consumer router have names such as <strong>LAN1</strong>, <strong>LAN2</strong>, ... or <strong><abbr title="Wide Area Network">WAN</abbr></strong> also appear as independent network interfaces in userspace and those can be handled like any other network interfaces using the <code><a href="/docs/techref/ip" class="wikilink2" title="docs:techref:ip" rel="nofollow" data-wiki-id="docs:techref:ip">ip</a></code> tool or <code><a href="/docs/techref/ethtool" class="wikilink2" title="docs:techref:ethtool" rel="nofollow" data-wiki-id="docs:techref:ethtool">ethtool</a></code>.
</p>

<p>
The Linux kernel also has <a href="https://www.kernel.org/doc/html/latest/networking/dsa/configuration.html" class="urlextern" title="https://www.kernel.org/doc/html/latest/networking/dsa/configuration.html" rel="ugc nofollow">userspace configuration examples</a> on how to use the DSA switches in Linux.
</p>

<p>
DSA support will be introduced along with kernel 5.4 support, but there is no full feature parity with swconfig yet as of writing (2020-05-12). Changing <abbr title="Virtual Local Area Network">VLAN</abbr> tags is not supported yet at the moment, e.g.. 
</p>

<p>
Tagging support is more complex than with swconfig; see the <a href="https://www.kernel.org/doc/html/latest/networking/dsa/configuration.html#configuration-with-tagging-support" class="urlextern" title="https://www.kernel.org/doc/html/latest/networking/dsa/configuration.html#configuration-with-tagging-support" rel="ugc nofollow">kernel documentation</a> for configuration instructions. It looks like at this point there is no automation for this yet and it needs to be configured through /etc/rc.local.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;DSA Distributed Network Switch&quot;,&quot;hid&quot;:&quot;dsa_distributed_network_switch&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:2,&quot;range&quot;:&quot;372-1718&quot;} -->
<h3 class="sectionedit3" id="support_matrix">Support matrix</h3>
<div class="level3">

<p>
Only master targets actually having DSA enabled are listed.
</p>
<div class="table sectionedit4"><table class="inline">
	<thead>
	<tr class="row0">
		<th class="col0 leftalign"> Target      </th><th class="col1 leftalign"> Kernel       </th><th class="col2 leftalign"> Notes          </th>
	</tr>
	</thead>
	<tr class="row1">
		<td class="col0 leftalign"> bcm53xx           </td><td class="col1"> 5.10? </td><td class="col2 leftalign">         </td>
	</tr>
	<tr class="row2">
		<td class="col0 leftalign"> Gemini            </td><td class="col1 leftalign"> 5.10  </td><td class="col2 leftalign">         </td>
	</tr>
	<tr class="row3">
		<td class="col0 leftalign"> IMX6              </td><td class="col1 leftalign"> 5.10  </td><td class="col2 leftalign">         </td>
	</tr>
	<tr class="row4">
		<td class="col0 leftalign"> IPQ40xx           </td><td class="col1 leftalign"> 5.15  </td><td class="col2 leftalign">         </td>
	</tr>
	<tr class="row5">
		<td class="col0 leftalign"> Kirkwood          </td><td class="col1 leftalign"> 5.10  </td><td class="col2 leftalign">         </td>
	</tr>
	<tr class="row6">
		<td class="col0 leftalign"> Lantiq            </td><td class="col1 leftalign"> 5.10  </td><td class="col2 leftalign">         </td>
	</tr>
	<tr class="row7">
		<td class="col0 leftalign"> Mediatek/MT7623   </td><td class="col1 leftalign"> 5.10  </td><td class="col2 leftalign">         </td>
	</tr>
	<tr class="row8">
		<td class="col0 leftalign"> Mvebu             </td><td class="col1 leftalign"> 5.10  </td><td class="col2 leftalign">         </td>
	</tr>
	<tr class="row9">
		<td class="col0 leftalign"> Realtek           </td><td class="col1 leftalign"> 5.10  </td><td class="col2 leftalign">         </td>
	</tr>
	<tr class="row10">
		<td class="col0 leftalign"> Ramips/MT7621     </td><td class="col1 leftalign"> 5.10  </td><td class="col2 leftalign"> See <a href="https://github.com/openwrt/openwrt/pull/2942" class="urlextern" title="https://github.com/openwrt/openwrt/pull/2942" rel="ugc nofollow">Github PR #2942</a> (merged) for improvements  </td>
	</tr>
</table></div>
<!-- EDIT{&quot;target&quot;:&quot;table&quot;,&quot;name&quot;:&quot;&quot;,&quot;hid&quot;:&quot;table&quot;,&quot;secid&quot;:4,&quot;range&quot;:&quot;1806-2341&quot;} -->
</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Support matrix&quot;,&quot;hid&quot;:&quot;support_matrix&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:3,&quot;range&quot;:&quot;1719-2341&quot;} -->
<h2 class="sectionedit5" id="switchdev">Switchdev</h2>
<div class="level2">

<p>
<strong>Note</strong>: not to be confused with <a href="https://www.kernel.org/doc/html/latest/networking/switchdev.html" class="urlextern" title="https://www.kernel.org/doc/html/latest/networking/switchdev.html" rel="ugc nofollow">Linux switchdev</a>, which DSA is based on.
</p>

<p>
The previous switch driver model invented by OpenWrt was switchdev and the corresponding configuration utility was <code><a href="/docs/techref/swconfig" class="wikilink1" title="docs:techref:swconfig" data-wiki-id="docs:techref:swconfig">swconfig</a></code>. This is used in legacy patches and userspace, but is not recommended when implementing switch drivers for new devices. Please write new code using DSA and help out to convert old drivers to DSA if you can.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Switchdev&quot;,&quot;hid&quot;:&quot;switchdev&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:5,&quot;range&quot;:&quot;2342-2870&quot;} -->
<h2 class="sectionedit6" id="ethernet_network_switch_models">Ethernet Network Switch models</h2>
<div class="level2">

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Ethernet Network Switch models&quot;,&quot;hid&quot;:&quot;ethernet_network_switch_models&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:6,&quot;range&quot;:&quot;2871-2914&quot;} -->
<h3 class="sectionedit7" id="realtek">Realtek</h3>
<div class="level3">
<ul>
<li class="level1"><div class="li"> <a href="http://realtek.info/pdf/rtl8366_8369_datasheet_1-1.pdf" class="urlextern" title="http://realtek.info/pdf/rtl8366_8369_datasheet_1-1.pdf" rel="ugc nofollow">RTL8366/RTL8369 datasheet</a>, notice that this is quite different from RTL8366RB or RTL8369S</div>
</li>
<li class="level1 node"><div class="li"> <a href="https://web.archive.org/web/20100729202805/http://www.realtek.com.tw/products/productsView.aspx?Langid=1&amp;PNid=18&amp;PFid=15&amp;Level=5&amp;Conn=4&amp;ProdID=197" class="urlextern" title="https://web.archive.org/web/20100729202805/http://www.realtek.com.tw/products/productsView.aspx?Langid=1&amp;PNid=18&amp;PFid=15&amp;Level=5&amp;Conn=4&amp;ProdID=197" rel="ugc nofollow">RealTek RTL8366RB</a>, a 5-port Gigabit switch e.g. in the <a href="/toh/tp-link/tl-wr1043nd" class="wikilink1" title="toh:tp-link:tl-wr1043nd" data-wiki-id="toh:tp-link:tl-wr1043nd">WR1043ND v1</a> or <a href="/toh/d-link/dir-685" class="wikilink1" title="toh:d-link:dir-685" data-wiki-id="toh:d-link:dir-685">DIR-685</a></div>
<ul>
<li class="level2"><div class="li"> <a href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/drivers/net/dsa/realtek/rtl8366rb.c" class="urlextern" title="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/drivers/net/dsa/realtek/rtl8366rb.c" rel="ugc nofollow">Upstream RTL8366RB DSA kernel driver</a> this should become the default after incorporating kernel v4.19 or later</div>
</li>
<li class="level2 node"><div class="li"> see <a href="https://dev.openwrt.org/search?q=+8366RB&amp;noquickjump=1&amp;ticket=on" class="urlextern" title="https://dev.openwrt.org/search?q=+8366RB&amp;noquickjump=1&amp;ticket=on" rel="ugc nofollow">all tickets concerning the Realtek RTL8366RB</a></div>
<ul>
<li class="level3"><div class="li"> e.g. <a href="https://dev.openwrt.org/ticket/7977" class="urlextern" title="https://dev.openwrt.org/ticket/7977" rel="ugc nofollow">Ticket 7977:Enhance rtl8366rb driver</a></div>
</li>
<li class="level3"><div class="li"> e.g. <a href="https://dev.openwrt.org/ticket/10202" class="urlextern" title="https://dev.openwrt.org/ticket/10202" rel="ugc nofollow">Ticket 10202: Add support for port mirroring in rtl8366rb</a></div>
</li>
</ul>
</li>
<li class="level2 node"><div class="li"> see <a href="https://dev.openwrt.org/search?q=+8366RB&amp;noquickjump=1&amp;changeset=on" class="urlextern" title="https://dev.openwrt.org/search?q=+8366RB&amp;noquickjump=1&amp;changeset=on" rel="ugc nofollow">all changesets concerning the Realtek RTL8366RB</a></div>
<ul>
<li class="level3"><div class="li"> e.g. <a href="https://dev.openwrt.org/changeset/36847" class="urlextern" title="https://dev.openwrt.org/changeset/36847" rel="ugc nofollow">r36847: add port mirroring/monitoring capability to the RTL8366RB switch</a></div>
</li>
</ul>
</li>
</ul>
</li>
<li class="level1"><div class="li"> <a href="http://www.realtek.com.tw/press/newsViewOne.aspx?NewsID=182" class="urlextern" title="http://www.realtek.com.tw/press/newsViewOne.aspx?NewsID=182" rel="ugc nofollow">RealTek RTL8366S</a>, e.g. in the <a href="/toh/d-link/dir-825" class="wikilink1" title="toh:d-link:dir-825" data-wiki-id="toh:d-link:dir-825">DIR-825</a></div>
</li>
<li class="level1"><div class="li"> <a href="http://www.realtek.com.tw/products/productsView.aspx?Langid=1&amp;PFid=20&amp;Level=5&amp;Conn=4&amp;ProdID=156" class="urlextern" title="http://www.realtek.com.tw/products/productsView.aspx?Langid=1&amp;PFid=20&amp;Level=5&amp;Conn=4&amp;ProdID=156" rel="ugc nofollow">Realtek RTL8306SD/SDM</a> FastEthernet, 6 Ports, 5x 100BASE-TX-PHYs e.g. in the <a href="/toh/arcadyan/arv4518pw" class="wikilink1" title="toh:arcadyan:arv4518pw" data-wiki-id="toh:arcadyan:arv4518pw">ARV4518PW</a></div>
</li>
<li class="level1"><div class="li"> <a href="http://www.realtek.com.tw/products/productsView.aspx?Langid=1&amp;PFid=21&amp;Level=3&amp;Conn=4&amp;ProdID=209" class="urlextern" title="http://www.realtek.com.tw/products/productsView.aspx?Langid=1&amp;PFid=21&amp;Level=3&amp;Conn=4&amp;ProdID=209" rel="ugc nofollow">RTL8309G</a> FastEthernet, 9 Ports, 8x 100BASE-TX-PHYs e.g. in the <a href="/toh/d-link/dir-632" class="wikilink1" title="toh:d-link:dir-632" data-wiki-id="toh:d-link:dir-632">D-Link DIR-632</a></div>
</li>
</ul>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Realtek&quot;,&quot;hid&quot;:&quot;realtek&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:7,&quot;range&quot;:&quot;2915-4719&quot;} -->
<h3 class="sectionedit8" id="qualcommatheros">Qualcomm / Atheros</h3>
<div class="level3">
<ul>
<li class="level1"><div class="li"> AR8216 FastEthernet, 6 ports; found in <a href="/toh/astoria/arv752dpw22" class="wikilink1" title="toh:astoria:arv752dpw22" data-wiki-id="toh:astoria:arv752dpw22">Arcadyan ARV752DPW22</a>, <a href="/toh/netgear/wnr2000" class="wikilink1" title="toh:netgear:wnr2000" data-wiki-id="toh:netgear:wnr2000">Netgear WNR2000v1</a>, others</div>
</li>
<li class="level1"><div class="li"> AR8316 GigabitEthernet, e.g. in the <a href="/toh/ubiquiti/routerstation_pro" class="wikilink1" title="toh:ubiquiti:routerstation_pro" data-wiki-id="toh:ubiquiti:routerstation_pro">RouterStation Pro</a>, <a href="/toh/buffalo/wbmr-hp-g300h" class="wikilink1" title="toh:buffalo:wbmr-hp-g300h" data-wiki-id="toh:buffalo:wbmr-hp-g300h">WBMR-HP-G300H</a>, ...</div>
</li>
<li class="level1"><div class="li"> <a href="http://www.qca.qualcomm.com/technology/technology.php?nav1=48&amp;product=99" class="urlextern" title="http://www.qca.qualcomm.com/technology/technology.php?nav1=48&amp;product=99" rel="ugc nofollow">AR8228 + AR8229</a> FastEthernet: 7-Ports, 5x 100BASE-TX-PHYs</div>
</li>
<li class="level1"><div class="li"> <a href="http://www.qca.qualcomm.com/technology/technology.php?nav1=48&amp;product=100" class="urlextern" title="http://www.qca.qualcomm.com/technology/technology.php?nav1=48&amp;product=100" rel="ugc nofollow">AR8236</a> FastEthernet: 6-Ports,  5 x 100BASE-TX-PHYs</div>
</li>
<li class="level1"><div class="li"> <a href="http://www.qca.qualcomm.com/technology/technology.php?nav1=48&amp;product=102" class="urlextern" title="http://www.qca.qualcomm.com/technology/technology.php?nav1=48&amp;product=102" rel="ugc nofollow">AR8327 + AR8327N</a> GigabitEthernet: 7Ports,  5x 1000Base-T-PHYs e.g. in the <a href="/toh/tp-link/tl-wr1043nd" class="wikilink1" title="toh:tp-link:tl-wr1043nd" data-wiki-id="toh:tp-link:tl-wr1043nd">WR1043ND v2</a> (<a href="http://wikidevi.com/files/Atheros/specsheets/AR8327_AR8327N.pdf" class="urlextern" title="http://wikidevi.com/files/Atheros/specsheets/AR8327_AR8327N.pdf" rel="ugc nofollow">Atheros AR8327N-BL1A</a>)</div>
</li>
<li class="level1"><div class="li"> <a href="http://www.qca.qualcomm.com/technology/technology.php?nav1=48&amp;product=101" class="urlextern" title="http://www.qca.qualcomm.com/technology/technology.php?nav1=48&amp;product=101" rel="ugc nofollow">AR8328 + AR8328N</a> GigabitEthernet: 7Ports,  5x 1000Base-T-PHYs</div>
</li>
<li class="level1"><div class="li"> Atheros AR7240 built-in switch</div>
</li>
<li class="level1"><div class="li"> Atheros AR934X built-in switch</div>
</li>
</ul>

<p>
<strong><code>Note:</code></strong> Atheros Switch-Chips with the &#039;N&#039; designation include the <em>Hardware <abbr title="Network Address Translation">NAT</abbr></em> function.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Qualcomm \/ Atheros&quot;,&quot;hid&quot;:&quot;qualcommatheros&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:8,&quot;range&quot;:&quot;4720-5896&quot;} -->
<h3 class="sectionedit9" id="broadcom">Broadcom</h3>
<div class="level3">
<ul>
<li class="level1"><div class="li"> <a href="https://dev.openwrt.org/changeset/37650" class="urlextern" title="https://dev.openwrt.org/changeset/37650" rel="ugc nofollow">r37650: brcm47xx: switch to kernel 3.10.4; This uses a new switch driver. The old ADMTEK Adm6996 switch is not supported any more.</a></div>
</li>
<li class="level1"><div class="li"> Broadcom <a href="/_media/media/datasheets/bcm5325_pinout.png" class="media mediafile mf_png" title="media:datasheets:bcm5325_pinout.png (490.5 KB)">BCM5325</a></div>
</li>
</ul>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Broadcom&quot;,&quot;hid&quot;:&quot;broadcom&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:9,&quot;range&quot;:&quot;5897-6167&quot;} -->
<h3 class="sectionedit10" id="vitesse">Vitesse</h3>
<div class="level3">
<ul>
<li class="level1 node"><div class="li"> Vitesse have produced 4-port PHYs VSC8584 and VSC8574</div>
<ul>
<li class="level2"><div class="li"> <a href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/drivers/net/phy/mscc.c" class="urlextern" title="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/drivers/net/phy/mscc.c" rel="ugc nofollow">Upstream PHY driver for VSC8584 and VSC8574</a></div>
</li>
</ul>
</li>
<li class="level1 node"><div class="li"> Vitesse have produced switch chips for 5+1 and 8+1 switches VSC7385, VSC7388, VSC7395 and VSC7398.</div>
<ul>
<li class="level2"><div class="li"> <a href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/drivers/net/dsa/vitesse-vsc73xx-core.c" class="urlextern" title="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/drivers/net/dsa/vitesse-vsc73xx-core.c" rel="ugc nofollow">Upstream DSA kernel driver for VSC7385, VSC7388, VSC7395 and VSC7398</a></div>
</li>
</ul>
</li>
<li class="level1"><div class="li"> The Vitesse switch chips family were acquired by Micosemi who were then acquired by Microchip.</div>
</li>
<li class="level1"><div class="li"> Micochip will provide complete datasheets if you sign an NDA on their website</div>
</li>
</ul>

<p>
<a href="/lib/exe/fetch.php?tok=94fbff&amp;media=https%3A%2F%2Fopenwrt.org%2F_media%2Fmedia%2Fdocs%2Fvsc7384_ds_41.pdf" class="media mediafile mf_pdf" title="https://openwrt.org/_media/media/docs/vsc7384_ds_41.pdf">VSC7384 datasheet</a>
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Vitesse&quot;,&quot;hid&quot;:&quot;vitesse&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:10,&quot;range&quot;:&quot;6168-6946&quot;} -->
<h3 class="sectionedit11" id="mediatekralink">MediaTek / Ralink</h3>
<div class="level3">
<ul>
<li class="level1"><div class="li"> <a href="http://www.mediatek.com/_en/01_products/04_pro.php?sn=1032" class="urlextern" title="http://www.mediatek.com/_en/01_products/04_pro.php?sn=1032" rel="ugc nofollow">TC2206</a></div>
</li>
</ul>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;MediaTek \/ Ralink&quot;,&quot;hid&quot;:&quot;mediatekralink&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:11,&quot;range&quot;:&quot;6947-7049&quot;} -->
<h3 class="sectionedit12" id="other">Other</h3>
<div class="level3">
<ul>
<li class="level1"><div class="li"> IC+ IP17xx</div>
</li>
</ul>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Other&quot;,&quot;hid&quot;:&quot;other&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:12,&quot;range&quot;:&quot;7050-7081&quot;} -->
<h3 class="sectionedit13" id="features">Features</h3>
<div class="level3">
<ul>
<li class="level1"><div class="li"> Some switches contain a functionality called <strong><em>“Hardware <abbr title="Network Address Translation">NAT</abbr>”</em></strong>; support for this features has not yet been included into OpenWrt. Since the <a href="/docs/techref/hardware/cpu" class="wikilink1" title="docs:techref:hardware:cpu" data-wiki-id="docs:techref:hardware:cpu">cpu</a>s used in CPE Routers are relatively slow, expect 2 to 4 times performance gain if you were to use Hardware <abbr title="Network Address Translation">NAT</abbr>, e.g. without hardware <abbr title="Network Address Translation">NAT</abbr> some router could achieve 400Mbit/s at full CPU load, with hardware <abbr title="Network Address Translation">NAT</abbr> it could achieve 900Mbit/s at full CPU load. OpenWrt developer is supposed to have said, that implementing HW-<abbr title="Network Address Translation">NAT</abbr> support would be unacceptably hacky to accomplish.</div>
</li>
</ul>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Features&quot;,&quot;hid&quot;:&quot;features&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:13,&quot;range&quot;:&quot;7082-&quot;} -->