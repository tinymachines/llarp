
<h1 class="sectionedit1" id="libubox">libubox</h1>
<div class="level1">

<p>
It&#039;s one of the core libraries used within openwrt because it&#039;s a set of utilities, mostly wrappers, that are present usually in programs and that have been coded in a flexible and reusable way to avoid wasting time.
</p>

<p>
The library consists mostly on independent functionalities, ones higher level than others.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;libubox&quot;,&quot;hid&quot;:&quot;libubox&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:1,&quot;range&quot;:&quot;1-333&quot;} -->
<h2 class="sectionedit2" id="libuboxutilsh">libubox/utils.h</h2>
<div class="level2">

<p>
Simple utility functions. Endian conversion, bitfield operations, compiler attribute wrapping, sequential memory allocation function (calloc_a), static array size macro, assertion/bug utility function, clock get time wrapper for apple compatibility, base64 encoding decoding.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;libubox\/utils.h&quot;,&quot;hid&quot;:&quot;libuboxutilsh&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:2,&quot;range&quot;:&quot;334-639&quot;} -->
<h2 class="sectionedit3" id="libuboxusockh">libubox/usock.h</h2>
<div class="level2">

<p>
This is a really simple library encouraged to be a wrapper to avoid all those socket api library calls. You can create <abbr title="Transmission Control Protocol">TCP</abbr>, <abbr title="User Datagram Protocol">UDP</abbr> and UNIX sockets, clients and servers, ipv4/v6 and non/blocking.
</p>

<p>
The idea is to call usock() and have your fd returned.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;libubox\/usock.h&quot;,&quot;hid&quot;:&quot;libuboxusockh&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:3,&quot;range&quot;:&quot;640-919&quot;} -->
<h2 class="sectionedit4" id="libuboxulooph">libubox/uloop.h</h2>
<div class="level2">

<p>
The most used part. Uloop is a loop runner for i/o. Gets in charge of polling the different file descriptors you have added to it, gets in charge of running timers, and helps you manage child processes. Supports epoll and kqueue as event running backends.
</p>

<p>
The fd management part is set up with the uloop_fd struct, just adding the fd and the callback function you want called when an event arises. The rest of the structure is for internal use.
</p>

<p>
The timeout management part is mostly prepared to do simple things. If you want to do something complex, you might want to have a look at libubox/runqueue.h which implements interesting functionality on top of uloop. 
</p>

<p>
Timeout structure should be initialized with just the callback and pending=false (timeout={.cb=cb_func} does the work), and added to uloop using uloop_timeout_set(), do not use the other _add() function because then you will need to set up the time yourself calling time.h functions. _set() uses _add() internally.
</p>

<p>
TBDN: Process management part
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;libubox\/uloop.h&quot;,&quot;hid&quot;:&quot;libuboxulooph&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:4,&quot;range&quot;:&quot;920-1962&quot;} -->
<h2 class="sectionedit5" id="libuboxblobh">libubox/blob.h</h2>
<div class="level2">

<p>
This part is a helper to pass data in binary. There are several supported datatypes, and it creates blobs that could be sent over any socket, as endianess is taken care in the library itself.
</p>

<p>
The method is to create a type-value chained data, supporting nested data. This part basically covers putting and getting datatypes. Further functionality is implemented in blobmsg.h
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;libubox\/blob.h&quot;,&quot;hid&quot;:&quot;libuboxblobh&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:5,&quot;range&quot;:&quot;1963-2367&quot;} -->
<h2 class="sectionedit6" id="libuboxblobmsgh">libubox/blobmsg.h</h2>
<div class="level2">

<p>
Blobmsg sits on top of blob.h, providing tables and arrays, providing it&#039;s own but parallel datatypes.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;libubox\/blobmsg.h&quot;,&quot;hid&quot;:&quot;libuboxblobmsgh&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:6,&quot;range&quot;:&quot;2368-2502&quot;} -->
<h2 class="sectionedit7" id="libuboxlisth">libubox/list.h</h2>
<div class="level2">

<p>
Utility to create lists. A way to create lists of structures just by adding struct list_head to your structures. It comes with a lot of iterator macros, with some of them allowing deletion on iteration (the ones ending in _safe). It also has some list operations like slicing, moving, and inserting in different points. It is a double linked list implementation (just in case). Uses the same <abbr title="Application Programming Interface">API</abbr> as the one present in the linux kernel.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;libubox\/list.h&quot;,&quot;hid&quot;:&quot;libuboxlisth&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:7,&quot;range&quot;:&quot;2503-2967&quot;} -->
<h2 class="sectionedit8" id="libuboxsafe-listh">libubox/safe-list.h</h2>
<div class="level2">

<p>
Uses list.h to provide protection against recursive iteration with deletes.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;libubox\/safe-list.h&quot;,&quot;hid&quot;:&quot;libuboxsafe-listh&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:8,&quot;range&quot;:&quot;2968-3077&quot;} -->
<h2 class="sectionedit9" id="libuboxkvlisth">libubox/kvlist.h</h2>
<div class="level2">

<p>
Key value lists, allowing duplicate elements. Keys are meant to be strings, values can be any datatype, the user has to provide a data measuring function though. If you are using strings or blobs (from blob.h), there are two measuring functions already, kvlist_strlen and kvlist_blob_len respectively.
</p>

<p>
kvlist.h implementation uses avl.h.
</p>
<ul>
<li class="level1"><div class="li"> <a href="http://git.openwrt.org/?p=project/libubox.git;a=summary" class="urlextern" title="http://git.openwrt.org/?p=project/libubox.git;a=summary" rel="ugc nofollow">Project&#039;s git</a></div>
</li>
</ul>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;libubox\/kvlist.h&quot;,&quot;hid&quot;:&quot;libuboxkvlisth&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:9,&quot;range&quot;:&quot;3078-&quot;} -->