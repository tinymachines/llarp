
<h1 class="sectionedit1" id="unetd">unetd</h1>
<div class="level1">

<p>
unetd is a WireGuard based <abbr title="Virtual Private Network">VPN</abbr> daemon that simplifies creating and managing fully-meshed <abbr title="Virtual Private Network">VPN</abbr> connections between OpenWrt routers.
</p>

<p>
Source: <a href="https://git.openwrt.org/project/unetd.git" class="interwiki iw_commit" title="https://git.openwrt.org/project/unetd.git">project/unetd.git</a>
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;unetd&quot;,&quot;hid&quot;:&quot;unetd&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:1,&quot;range&quot;:&quot;1-189&quot;} -->
<h2 class="sectionedit2" id="features">Features</h2>
<div class="level2">
<ul>
<li class="level1"><div class="li"> Splits network setup into network config (shared across all participating nodes) and local config (limited mostly to local private key, public signing device key, optionally tunnel device names)</div>
</li>
<li class="level2"><div class="li"> Supports automatic replication of peer <abbr title="Internet Protocol">IP</abbr> addresses</div>
</li>
<li class="level2 node"><div class="li"> Supports automatic replication of network config updates</div>
<ul>
<li class="level3"><div class="li"> network config data is secure and protected by a Ed25519 signature</div>
</li>
<li class="level3"><div class="li"> network config data replication is encrypted and only available to members of the network, even during bootstrap</div>
</li>
</ul>
</li>
<li class="level2"><div class="li"> Fully meshed (all nodes connect to each other directly unless configured otherwise)</div>
</li>
<li class="level2 node"><div class="li"> Supports automatic VXLAN setup with multiple peers</div>
<ul>
<li class="level3"><div class="li"> automatically installs eBPF program to deal with <abbr title="Maximum Transmission Unit">MTU</abbr> limitations and avoid fragmentation</div>
</li>
</ul>
</li>
<li class="level2"><div class="li"> Automatic setup of routes / <abbr title="Internet Protocol">IP</abbr> addresses based on network config data</div>
</li>
<li class="level2"><div class="li"> Supports direct connection through double-<abbr title="Network Address Translation">NAT</abbr>, as long as the network has one node with a public <abbr title="Internet Protocol">IP</abbr> address</div>
</li>
<li class="level2"><div class="li"> Simple CLI for creating and updating networks between OpenWrt hosts with very few commands</div>
</li>
<li class="level2"><div class="li"> Builds and runs on regular Linux distributions as well, and also macOS (with some limitations)</div>
</li>
<li class="level2"><div class="li"> Automatically assigns an <abbr title="Internet Protocol version 6">IPv6</abbr> address for each host, which is generated from the host public key</div>
</li>
<li class="level2 node"><div class="li"> writes a host file containing entries for all configured hosts</div>
<ul>
<li class="level3"><div class="li"> can be used with dnsmasq for local lookup</div>
</li>
<li class="level3"><div class="li"> configurable domain suffix</div>
</li>
</ul>
</li>
<li class="level2"><div class="li"> allows creating freeform service definitions, which allows services to query member <abbr title="Internet Protocol">IP</abbr> addresses using ubus</div>
</li>
<li class="level2"><div class="li"> Supports peer discovery via BitTorrent &#039;Mainline&#039; DHT, which works even through double-<abbr title="Network Address Translation">NAT</abbr></div>
</li>
</ul>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Features&quot;,&quot;hid&quot;:&quot;features&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:2,&quot;range&quot;:&quot;190-1829&quot;} -->
<h2 class="sectionedit3" id="building">Building</h2>
<div class="level2">

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Building&quot;,&quot;hid&quot;:&quot;building&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:3,&quot;range&quot;:&quot;1830-1850&quot;} -->
<h3 class="sectionedit4" id="openwrt">OpenWrt</h3>
<div class="level3">

<p>
TBC
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;OpenWrt&quot;,&quot;hid&quot;:&quot;openwrt&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:4,&quot;range&quot;:&quot;1851-1872&quot;} -->
<h3 class="sectionedit5" id="linux">Linux</h3>
<div class="level3">

<p>
The following build dependencies are required:
</p>
<ul>
<li class="level1"><div class="li"> cmake, pkg-config</div>
</li>
<li class="level2"><div class="li"> libelf-dev, zlib1g-dev, libjson-c-dev</div>
</li>
</ul>

<p>
To build:
</p>
<pre class="code">git clone https://git.openwrt.org/project/unetd.git
cd unetd
./build.sh</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Linux&quot;,&quot;hid&quot;:&quot;linux&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:5,&quot;range&quot;:&quot;1873-2101&quot;} -->
<h2 class="sectionedit6" id="example_setup">Example setup</h2>
<div class="level2">

</div>

<h4 id="preparation">Preparation</h4>
<div class="level4">

<p>
This set of example commands assumes two OpenWRT routers with the <abbr title="Internet Protocol">IP</abbr> addresses <code>192.168.1.13</code> and <code>192.168.1.15</code> which have <strong>not</strong> been configured for unetd yet, each has <code>unetd</code>, <code>unet-cli</code> and <code>unet-tool</code> installed. <code>vxlan</code> (and its implied <code>kmod-vxlan</code>) are also installed. The assumption here is that the local host, here say <code>192.168.1.2</code> has these installed, and also forms a unet node.
</p>

<p>
Note: <code>unetd</code> is not yet capable of installing these prerequisites above via <code>opkg</code>. 
</p>

</div>

<h4 id="example">Example</h4>
<div class="level4">

<p>
This creates a new JSON file <code>test.json</code> locally and also generates a signing key in <code>test.json.key</code> locally (if it doesn&#039;t exist already):
</p>
<pre class="code"># unet-cli test.json create</pre>

<p>
Result:
</p>
<pre class="code">test.json:
{
	&quot;config&quot;: {
		&quot;port&quot;: 51830,
		&quot;keepalive&quot;: 10,
		&quot;peer-exchange-port&quot;: 51831
	},
	&quot;hosts&quot;: {
	},
	&quot;services&quot;: {
	}
}</pre>

<p>
This creates a VXLAN tunnel definition in <code>test.json</code> and predicates hosts that are to be members of it via the <code>ap</code> group:
</p>
<pre class="code"># unet-cli test.json add-service l2-tunnel type=vxlan members=@ap</pre>

<p>
Result:
</p>
<pre class="code">test.json:
{
	...
	&quot;services&quot;: {
		&quot;l2-tunnel&quot;: {
			&quot;config&quot;: {
			},
			&quot;members&quot;: [
				&quot;@ap&quot;
			],
			&quot;type&quot;: &quot;vxlan&quot;
		}
	}
}</pre>

<p>
This connects to 192.168.1.13 over <abbr title="Secure Shell">SSH</abbr>, and on 192.168.1.13, generates an unetd interface named <code>unet</code>, along with new host keys, puts in the signing key and also tells it to create the <code>vx0</code> VXLAN device connected to the <code>l2-tunnel</code> service description we created in the last command, storing its public key in the local <code>test.json</code>, along with its endpoint address <code>192.168.1.13</code>:
</p>
<pre class="code"># unet-cli test.json add-ssh-host ap1 root@192.168.1.13 endpoint=192.168.1.13 tunnels=vx0:l2-tunnel groups=ap</pre>

<p>
Note: you will authenticate via <abbr title="Secure Shell">SSH</abbr>, either user:pass or key based, if that was set up in advance.
</p>

<p>
Result:
</p>
<pre class="code">test.json:
{
	...
	&quot;hosts&quot;: {
		&quot;ap1&quot;: {
			&quot;key&quot;: &quot;....=&quot;,
			&quot;endpoint&quot;: &quot;192.168.1.13&quot;,
			&quot;groups&quot;: [
				&quot;ap&quot;
			]
		}
	},
	...
}</pre>

<p>
This does the same for the other host:
</p>
<pre class="code"># unet-cli test.json add-ssh-host ap2 root@192.168.1.15 endpoint=192.168.1.15 tunnels=vx0:l2-tunnel groups=ap</pre>

<p>
Result:
</p>
<pre class="code">test.json:
{
	...
	&quot;hosts&quot;: {
		...
		&quot;ap2&quot;: {
			&quot;key&quot;: &quot;...=&quot;,
			&quot;endpoint&quot;: &quot;192.168.178.1&quot;,
			&quot;groups&quot;: [
				&quot;ap&quot;
			]
		}
	},
	...
}</pre>

<p>
This signs the network data and uploads it to unetd running on 192.168.1.13:
</p>
<pre class="code"># unet-cli test.json sign upload=192.168.1.13</pre>

<p>
By now, uploading the data to one of the two hosts is enough, because once it (192.168.1.13) has processed the update, it (192.168.1.13) will find the endpoint address of the other host (192.168.1.15) and sync the network data with it automatically. After that last command, the unetd network should be up on both sides, and the VXLAN tunnel created as well.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Example setup&quot;,&quot;hid&quot;:&quot;example_setup&quot;,&quot;codeblockOffset&quot;:1,&quot;secid&quot;:6,&quot;range&quot;:&quot;2102-4917&quot;} -->
<h2 class="sectionedit7" id="configuration">Configuration</h2>
<div class="level2">

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Configuration&quot;,&quot;hid&quot;:&quot;configuration&quot;,&quot;codeblockOffset&quot;:5,&quot;secid&quot;:7,&quot;range&quot;:&quot;4918-4944&quot;} -->
<h3 class="sectionedit8" id="uci_network_interface">UCI network interface</h3>
<div class="level3">

<p>
Configuration of a <code>interface</code> section in /etc/config/network for unetd.
</p>
<div class="table sectionedit9"><table class="inline">
	<thead>
	<tr class="row0">
		<th class="col0"> Name </th><th class="col1"> Type </th><th class="col2"> Required </th><th class="col3"> Description </th>
	</tr>
	</thead>
	<tr class="row1">
		<td class="col0"> <code>proto</code> </td><td class="col1"> string </td><td class="col2"> required </td><td class="col3"> Needs to be <code>unet</code> </td>
	</tr>
	<tr class="row2">
		<td class="col0"> <code>device</code> </td><td class="col1"> string </td><td class="col2"> required </td><td class="col3"> Name of the tunnel device </td>
	</tr>
	<tr class="row3">
		<td class="col0"> <code>key</code> </td><td class="col1"> string </td><td class="col2"> required </td><td class="col3"> Local wireguard key </td>
	</tr>
	<tr class="row4">
		<td class="col0"> <code>auth_key</code> </td><td class="col1"> string </td><td class="col2"> required </td><td class="col3"> Key used to sign network config </td>
	</tr>
	<tr class="row5">
		<td class="col0"> <code>tunnels</code> </td><td class="col1"> list </td><td class="col2"> </td><td class="col3"> List of tunnel devices mapped to VXLAN service definitions in the network config (format: <code>&lt;device&gt;=&lt;servicename&gt;</code>). </td>
	</tr>
	<tr class="row6">
		<td class="col0"> <code>connect</code> </td><td class="col1"> list </td><td class="col2"> </td><td class="col3"> List of external unetd host <abbr title="Internet Protocol">IP</abbr> addresses to download network config updates from </td>
	</tr>
	<tr class="row7">
		<td class="col0"> <code>domain</code> </td><td class="col1"> string </td><td class="col2"> </td><td class="col3"> Domain suffix for hosts in the generated hosts file </td>
	</tr>
	<tr class="row8">
		<td class="col0"> <code>dht</code> </td><td class="col1"> boolean </td><td class="col2"> </td><td class="col3"> Enable DHT peer discovery for this network </td>
	</tr>
</table></div>
<!-- EDIT{&quot;target&quot;:&quot;table&quot;,&quot;name&quot;:&quot;&quot;,&quot;hid&quot;:&quot;table&quot;,&quot;secid&quot;:9,&quot;range&quot;:&quot;5053-5742&quot;} -->
<p>
The <code>connect</code> option only needs to be used for bootstrapping the setup in case you&#039;re not uploading the network data to the node directly.
Once unetd has a working peer connection, it will always replicate updates over the tunnel.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;UCI network interface&quot;,&quot;hid&quot;:&quot;uci_network_interface&quot;,&quot;codeblockOffset&quot;:5,&quot;secid&quot;:8,&quot;range&quot;:&quot;4945-5977&quot;} -->
<h3 class="sectionedit10" id="network_config_data">Network config data</h3>
<div class="level3">

<p>
Network config is written as a JSON file.
</p>

</div>

<h5 id="example1">Example:</h5>
<div class="level5">
<pre class="code">{
        &quot;config&quot;: {
                &quot;port&quot;: 51830,
                &quot;keepalive&quot;: 10,
                &quot;peer-exchange-port&quot;: 51831,
                &quot;stun-servers&quot;: [
                        &quot;stun.l.google.com:19302&quot;,
                        &quot;stun1.l.google.com:19302&quot;
                ]
        },
        &quot;hosts&quot;: {
                &quot;ap1&quot;: {
                        &quot;key&quot;: &quot;yB3V0Wz37qheZoZiG0KNFAqfuI2TetO4sfXgqO/Gd0c=&quot;,
                        &quot;endpoint&quot;: &quot;192.168.1.13&quot;,
                        &quot;groups&quot;: [
                                &quot;ap&quot;
                        ]
                },
                &quot;ap2&quot;: {
                        &quot;key&quot;: &quot;aGNcyMLrN+C4WW0nJBUGwqw8ifIleUVefv/9vh+d1Fw=&quot;,
                        &quot;endpoint&quot;: &quot;192.168.1.15&quot;,
                        &quot;groups&quot;: [
                                &quot;ap&quot;
                        ]
                }
        },
        &quot;services&quot;: {
                &quot;l2-tunnel&quot;: {
                        &quot;config&quot;: {
                        },
                        &quot;members&quot;: [
                                &quot;@ap&quot;
                        ],
                        &quot;type&quot;: &quot;vxlan&quot;
                }
        }
}</pre>

</div>

<h5 id="config_properties">Config properties:</h5>
<div class="level5">
<div class="table sectionedit11"><table class="inline">
	<thead>
	<tr class="row0">
		<th class="col0 leftalign"> Name                    </th><th class="col1 leftalign"> Type              </th><th class="col2 leftalign"> Description                                                                 </th>
	</tr>
	</thead>
	<tr class="row1">
		<td class="col0 leftalign"> <code>port</code>                </td><td class="col1 leftalign"> int               </td><td class="col2 leftalign"> Wireguard tunnel port (can be overriden for individual hosts)               </td>
	</tr>
	<tr class="row2">
		<td class="col0 leftalign"> <code>keepalive</code>           </td><td class="col1 leftalign"> int               </td><td class="col2 leftalign"> Interval (in seconds) for keepalive and forcing peer reconnection attempts  </td>
	</tr>
	<tr class="row3">
		<td class="col0 leftalign"> <code>peer-exchange-port</code>  </td><td class="col1 leftalign"> int               </td><td class="col2 leftalign"> Port for exchanging peer messages on the WireGuard tunnel (0: disabled)     </td>
	</tr>
	<tr class="row4">
		<td class="col0 leftalign"> <code>stun-servers</code>        </td><td class="col1 leftalign"> array of strings  </td><td class="col2 leftalign"> List of STUN servers written as hostname:port strings                       </td>
	</tr>
</table></div>
<!-- EDIT{&quot;target&quot;:&quot;table&quot;,&quot;name&quot;:&quot;&quot;,&quot;hid&quot;:&quot;table1&quot;,&quot;secid&quot;:11,&quot;range&quot;:&quot;7271-7900&quot;} -->
</div>

<h5 id="host_properties">Host properties:</h5>
<div class="level5">
<div class="table sectionedit12"><table class="inline">
	<thead>
	<tr class="row0">
		<th class="col0 leftalign"> Name                    </th><th class="col1 leftalign"> Type              </th><th class="col2 leftalign"> Description                                                                                                               </th>
	</tr>
	</thead>
	<tr class="row1">
		<td class="col0 leftalign"> <code>key</code>                 </td><td class="col1 leftalign"> string            </td><td class="col2 leftalign"> Wireguard public key                                                                                                      </td>
	</tr>
	<tr class="row2">
		<td class="col0 leftalign"> <code>groups</code>              </td><td class="col1 leftalign"> array of strings  </td><td class="col2 leftalign"> Names of groups that the host is a member of                                                                              </td>
	</tr>
	<tr class="row3">
		<td class="col0 leftalign"> <code>ipaddr</code>              </td><td class="col1 leftalign"> array of strings  </td><td class="col2 leftalign"> Local <abbr title="Internet Protocol">IP</abbr> addresses of the host (<abbr title="Internet Protocol version 4">IPv4</abbr> or <abbr title="Internet Protocol version 6">IPv6</abbr>)                                                                             </td>
	</tr>
	<tr class="row4">
		<td class="col0 leftalign"> <code>subnet</code>              </td><td class="col1 leftalign"> array of strings  </td><td class="col2 leftalign"> Subnets routed by the host (<abbr title="Internet Protocol version 4">IPv4</abbr> or <abbr title="Internet Protocol version 6">IPv6</abbr>) (format: <code>&lt;addr&gt;/&lt;mask&gt;</code>)                                                     </td>
	</tr>
	<tr class="row5">
		<td class="col0 leftalign"> <code>port</code>                </td><td class="col1 leftalign"> int               </td><td class="col2 leftalign"> Wireguard tunnel port (overrides <code>config</code> property)                                                                     </td>
	</tr>
	<tr class="row6">
		<td class="col0 leftalign"> <code>peer-exchange-port</code>  </td><td class="col1 leftalign"> int               </td><td class="col2 leftalign"> Host specific port for exchanging peer messages on the WireGuard tunnel (0: disabled)                                     </td>
	</tr>
	<tr class="row7">
		<td class="col0 leftalign"> <code>endpoint</code>            </td><td class="col1 leftalign"> string            </td><td class="col2 leftalign"> Public endpoint address (format: <code>&lt;addr&gt;</code> for <abbr title="Internet Protocol version 4">IPv4</abbr>, <code>[&lt;addr&gt;]</code> for <abbr title="Internet Protocol version 6">IPv6</abbr> with optional <code>:&lt;port&gt;</code> suffix)             </td>
	</tr>
	<tr class="row8">
		<td class="col0 leftalign"> <code>gateway</code>             </td><td class="col1 leftalign"> string            </td><td class="col2 leftalign"> Name of another host to use as gateway (can be used for avoiding direct connections with all other peers from this host)  </td>
	</tr>
</table></div>
<!-- EDIT{&quot;target&quot;:&quot;table&quot;,&quot;name&quot;:&quot;&quot;,&quot;hid&quot;:&quot;table2&quot;,&quot;secid&quot;:12,&quot;range&quot;:&quot;7926-9473&quot;} -->
</div>

<h5 id="service_properties">Service properties</h5>
<div class="level5">
<div class="table sectionedit13"><table class="inline">
	<thead>
	<tr class="row0">
		<th class="col0 leftalign"> Name         </th><th class="col1 leftalign"> Type              </th><th class="col2 leftalign"> Description                                                    </th>
	</tr>
	</thead>
	<tr class="row1">
		<td class="col0 leftalign"> <code>type</code>     </td><td class="col1 leftalign"> string            </td><td class="col2 leftalign"> Service type                                                   </td>
	</tr>
	<tr class="row2">
		<td class="col0 leftalign"> <code>config</code>   </td><td class="col1 leftalign"> object            </td><td class="col2 leftalign"> Service type specific config options                           </td>
	</tr>
	<tr class="row3">
		<td class="col0 leftalign"> <code>members</code>  </td><td class="col1 leftalign"> array of strings  </td><td class="col2 leftalign"> Members assigned to this service (use <code>@&lt;name&gt;</code> for groups)  </td>
	</tr>
</table></div>
<!-- EDIT{&quot;target&quot;:&quot;table&quot;,&quot;name&quot;:&quot;&quot;,&quot;hid&quot;:&quot;table3&quot;,&quot;secid&quot;:13,&quot;range&quot;:&quot;9501-9908&quot;} -->
</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Network config data&quot;,&quot;hid&quot;:&quot;network_config_data&quot;,&quot;codeblockOffset&quot;:5,&quot;secid&quot;:10,&quot;range&quot;:&quot;5978-9909&quot;} -->
<h3 class="sectionedit14" id="cli_usage">CLI usage</h3>
<div class="level3">
<pre class="code">Usage: unet-cli [&lt;flags&gt;] &lt;file&gt; &lt;command&gt; [&lt;args&gt;] [&lt;option&gt;=&lt;value&gt; ...]

     Commands:
      - create:                                 Create a new network file
      - set-config:                             Change network config parameters
      - add-host &lt;name&gt;:                        Add a host
      - add-ssh-host &lt;name&gt; &lt;host&gt;:             Add a remote OpenWrt host via SSH
                                                (&lt;host&gt; can contain SSH options as well)
      - set-host &lt;name&gt;:                        Change host settings
      - set-ssh-host &lt;name&gt; &lt;host&gt;:             Update local and remote host settings
      - add-service &lt;name&gt;:                     Add a service
      - set-service &lt;name&gt;:                     Change service settings
      - sign                                    Sign network data

     Flags:
      -p:                                       Print modified JSON instead of updating file

     Options:
      - config options (create, set-config):
        port=&lt;val&gt;                              set tunnel port (default: 51830)
        pex_port=&lt;val&gt;                          set peer-exchange port (default: 51831, 0: disabled)
        keepalive=&lt;val&gt;                         set keepalive interval (seconds, 0: off, default: 10)
        stun=[+|-]&lt;host:port&gt;[,&lt;host:port&gt;...]  set/add/remove STUN servers
      - host options (add-host, add-ssh-host, set-host):
        key=&lt;val&gt;                               set host public key (required for add-host)
        port=&lt;val&gt;                              set host tunnel port number
        pex_port=&lt;val&gt;                          set host peer-exchange port (default: network pex_port, 0: disabled)
        groups=[+|-]&lt;val&gt;[,&lt;val&gt;...]            set/add/remove groups that the host is a member of
        ipaddr=[+|-]&lt;val&gt;[,&lt;val&gt;...]            set/add/remove host ip addresses
        subnet=[+|-]&lt;val&gt;[,&lt;val&gt;...]            set/add/remove host announced subnets
        endpoint=&lt;val&gt;                          set host endpoint address
        gateway=&lt;name&gt;                          set host gateway (using name of other host)
     - ssh host options (add-ssh-host, set-ssh-host)
        auth_key=&lt;key&gt;                          use &lt;key&gt; as public auth key on the remote host
        priv_key=&lt;key&gt;                          use &lt;key&gt; as private host key on the remote host (default: generate a new key)
        interface=&lt;name&gt;                        use &lt;name&gt; as interface in /etc/config/network on the remote host
        domain=&lt;name&gt;                           use &lt;name&gt; as hosts file domain on the remote host (default: unet)
        connect=&lt;val&gt;[,&lt;val&gt;...]                set IP addresses that the host will contact for network updates
        tunnels=&lt;ifname&gt;:&lt;service&gt;[,...]        set active tunnel devices
     - service options (add-service, set-service):
        type=&lt;val&gt;                              set service type (required for add-service)
        members=[+|-]&lt;val&gt;[,&lt;val&gt;...]           set/add/remove service member hosts/groups
     - vxlan service options (add-service, set-service):
        id=&lt;val&gt;                                set VXLAN ID
        port=&lt;val&gt;                              set VXLAN port
        mtu=&lt;val&gt;                               set VXLAN device MTU
        forward_ports=[+|-]&lt;val&gt;[,&lt;val&gt;...]     set members allowed to receive broadcast/multicast/unknown-unicast
     - sign options:
        upload=&lt;ip&gt;[,&lt;ip&gt;...]                   upload signed file to hosts
</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;CLI usage&quot;,&quot;hid&quot;:&quot;cli_usage&quot;,&quot;codeblockOffset&quot;:6,&quot;secid&quot;:14,&quot;range&quot;:&quot;9910-13465&quot;} -->
<h3 class="sectionedit15" id="dht_support">DHT support</h3>
<div class="level3">

<p>
For DHT peer discovery, the unet-dht package needs to be installed, and dht enabled in the interface on the nodes. For <abbr title="Network Address Translation">NAT</abbr> support, you also need to configure at least one working STUN server in the network data. While peers can find each other through DHT directly, STUN is needed for figuring out the external wireguard port and establishing a network connection over it.
Please note that DHT based discovery needs some time for peers to actually discover each other, sometimes 1-3 minutes.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;DHT support&quot;,&quot;hid&quot;:&quot;dht_support&quot;,&quot;codeblockOffset&quot;:7,&quot;secid&quot;:15,&quot;range&quot;:&quot;13466-&quot;} -->