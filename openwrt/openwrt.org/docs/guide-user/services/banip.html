
<h1 class="sectionedit1" id="banip">banIP</h1>
<div class="level1">

</div>
<!-- EDIT{&quot;target&quot;:&quot;plugin_include_start&quot;,&quot;name&quot;:&quot;meta:infobox:howto_links&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:2,&quot;range&quot;:&quot;0-&quot;} --><div class="plugin_include_content plugin_include__meta:infobox:howto_links">
<div class="level1">
<!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_start&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:4,&quot;range&quot;:&quot;0-&quot;} --><div class="wrap_info plugin_wrap">
<p>
This article relies on the following:
</p>
<ul>
<li class="level1"><div class="li"> Accessing <a href="/docs/guide-quick-start/walkthrough_login" class="wikilink1" title="docs:guide-quick-start:walkthrough_login" data-wiki-id="docs:guide-quick-start:walkthrough_login">web interface</a> / <a href="/docs/guide-quick-start/sshadministration" class="wikilink1" title="docs:guide-quick-start:sshadministration" data-wiki-id="docs:guide-quick-start:sshadministration">command-line interface</a></div>
</li>
<li class="level1"><div class="li"> Managing <a href="/docs/guide-user/base-system/uci" class="wikilink1" title="docs:guide-user:base-system:uci" data-wiki-id="docs:guide-user:base-system:uci">configs</a> / <a href="/docs/guide-user/additional-software/managing_packages" class="wikilink1" title="docs:guide-user:additional-software:managing_packages" data-wiki-id="docs:guide-user:additional-software:managing_packages">packages</a> / <a href="/docs/guide-user/base-system/managing_services" class="wikilink1" title="docs:guide-user:base-system:managing_services" data-wiki-id="docs:guide-user:base-system:managing_services">services</a> / <a href="/docs/guide-user/base-system/log.essentials" class="wikilink1" title="docs:guide-user:base-system:log.essentials" data-wiki-id="docs:guide-user:base-system:log.essentials">logs</a></div>
</li>
</ul>
</div><!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_end&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:5,&quot;range&quot;:&quot;0-&quot;} -->
</div>
<!-- EDIT{&quot;target&quot;:&quot;plugin_include_end&quot;,&quot;name&quot;:&quot;meta:infobox:howto_links&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:3,&quot;range&quot;:&quot;0-&quot;} --></div>
<div class="level1">

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;banIP&quot;,&quot;hid&quot;:&quot;banip&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:1,&quot;range&quot;:&quot;1-102&quot;} -->
<h2 class="sectionedit6" id="introduction">Introduction</h2>
<div class="level2">

<p>
<a href="https://github.com/openwrt/packages/blob/master/net/banip/files/README.md" class="urlextern" title="https://github.com/openwrt/packages/blob/master/net/banip/files/README.md" rel="ugc nofollow">banIP</a> can block services using <abbr title="Internet Protocol">IP</abbr>/CIDR lists including ASN and GeoIP lists.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Introduction&quot;,&quot;hid&quot;:&quot;introduction&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:6,&quot;range&quot;:&quot;103-282&quot;} -->
<h2 class="sectionedit7" id="command-line_instructions">Command-line instructions</h2>
<div class="level2">

<p>
Install and enable banIP.
</p>
<pre class="code bash"><span class="co0"># Install packages</span>
opkg update
opkg <span class="kw2">install</span> banip
&nbsp;
<span class="co0"># Enable banIP</span>
uci <span class="kw1">set</span> banip.global.ban_enabled=<span class="st0">&quot;1&quot;</span>
uci commit banip
service banip restart</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Command-line instructions&quot;,&quot;hid&quot;:&quot;command-line_instructions&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:7,&quot;range&quot;:&quot;283-510&quot;} -->
<h2 class="sectionedit8" id="extras">Extras</h2>
<div class="level2">

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Extras&quot;,&quot;hid&quot;:&quot;extras&quot;,&quot;codeblockOffset&quot;:1,&quot;secid&quot;:8,&quot;range&quot;:&quot;511-529&quot;} -->
<h3 class="sectionedit9" id="web_interface">Web interface</h3>
<div class="level3">

<p>
If you want to manage banIP settings using web interface.
Install the necessary packages.
</p>
<pre class="code bash"><span class="co0"># Install packages</span>
opkg update
opkg <span class="kw2">install</span> luci-app-banip
service rpcd restart</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Web interface&quot;,&quot;hid&quot;:&quot;web_interface&quot;,&quot;codeblockOffset&quot;:1,&quot;secid&quot;:9,&quot;range&quot;:&quot;530-745&quot;} -->
<h3 class="sectionedit10" id="blocking_domains">Blocking domains</h3>
<div class="level3">

<p>
Block domains by <abbr title="Internet Protocol">IP</abbr>.
</p>
<pre class="code bash"><span class="co0"># Block domains</span>
<span class="kw2">cat</span> <span class="sy0">&lt;&lt;</span> EOF <span class="sy0">&gt;&gt;</span> <span class="sy0">/</span>etc<span class="sy0">/</span>banip<span class="sy0">/</span>banip.blocklist
example.com
example.net
EOF
service banip restart</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Blocking domains&quot;,&quot;hid&quot;:&quot;blocking_domains&quot;,&quot;codeblockOffset&quot;:2,&quot;secid&quot;:10,&quot;range&quot;:&quot;746-922&quot;} -->
<h3 class="sectionedit11" id="blocking_asns">Blocking ASNs</h3>
<div class="level3">

<p>
Block Netflix by ASN.
</p>
<pre class="code bash"><span class="co0"># Block Netflix</span>
uci add_list banip.global.ban_feed=<span class="st0">&quot;asn&quot;</span>
uci add_list banip.global.ban_asn=<span class="st0">&quot;2906&quot;</span>
uci add_list banip.global.ban_asn=<span class="st0">&quot;40027&quot;</span>
uci commit banip
service banip restart</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Blocking ASNs&quot;,&quot;hid&quot;:&quot;blocking_asns&quot;,&quot;codeblockOffset&quot;:3,&quot;secid&quot;:11,&quot;range&quot;:&quot;923-1169&quot;} -->
<h3 class="sectionedit12" id="blocking_countries">Blocking countries</h3>
<div class="level3">

<p>
Block countries by GeoIP.
</p>
<pre class="code bash"><span class="co0"># Blocking countries</span>
uci add_list banip.global.ban_feed=<span class="st0">&quot;country&quot;</span>
uci add_list banip.global.ban_country=<span class="st0">&quot;cn&quot;</span>
uci add_list banip.global.ban_country=<span class="st0">&quot;ru&quot;</span>
uci commit banip
service banip restart</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Blocking countries&quot;,&quot;hid&quot;:&quot;blocking_countries&quot;,&quot;codeblockOffset&quot;:4,&quot;secid&quot;:12,&quot;range&quot;:&quot;1170-1437&quot;} -->
<h3 class="sectionedit13" id="blocking_doh">Blocking DoH</h3>
<div class="level3">

<p>
Block <abbr title="DNS over HTTPS">DoH</abbr> using a built-in list from <a href="https://github.com/dibdot/DoH-IP-blocklists" class="urlextern" title="https://github.com/dibdot/DoH-IP-blocklists" rel="ugc nofollow">dibdot/DoH-IP-blocklists</a>.
</p>
<pre class="code bash"><span class="co0"># Block DoH</span>
uci add_list banip.global.ban_feed=<span class="st0">&quot;doh&quot;</span>
uci commit banip
service banip restart</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Blocking DoH&quot;,&quot;hid&quot;:&quot;blocking_doh&quot;,&quot;codeblockOffset&quot;:5,&quot;secid&quot;:13,&quot;range&quot;:&quot;1438-1685&quot;} -->
<h3 class="sectionedit14" id="blocking_whatsapp">Blocking WhatsApp</h3>
<div class="level3">

<p>
Block WhatsApp using a custom list from <a href="https://github.com/HybridNetworks/whatsapp-cidr" class="urlextern" title="https://github.com/HybridNetworks/whatsapp-cidr" rel="ugc nofollow">HybridNetworks/whatsapp-cidr</a>.
</p>
<pre class="code bash"><span class="co0"># Block WhatsApp</span>
. <span class="sy0">/</span>usr<span class="sy0">/</span>share<span class="sy0">/</span>libubox<span class="sy0">/</span>jshn.sh
json_init
json_load_file <span class="sy0">/</span>etc<span class="sy0">/</span>banip<span class="sy0">/</span>banip.custom.feeds <span class="nu0">2</span><span class="sy0">&gt;</span> <span class="sy0">/</span>dev<span class="sy0">/</span>null
json_add_object <span class="st0">&quot;whatsapp&quot;</span>
json_add_string <span class="st0">&quot;descr&quot;</span> <span class="st0">&quot;WhatsApp CIDR&quot;</span>
json_add_string <span class="st0">&quot;url_4&quot;</span> <span class="st0">&quot;https://raw.githubusercontent.com/<span class="es1">\
</span>HybridNetworks/whatsapp-cidr/main/WhatsApp/whatsapp_cidr_ipv4.txt&quot;</span>
json_add_string <span class="st0">&quot;rule_4&quot;</span> <span class="st0">&quot;/^[^#]/{print <span class="es1">\$</span>1<span class="es1">\&quot;</span>,<span class="es1">\&quot;</span>}&quot;</span>
json_close_object
json_dump <span class="sy0">&gt;</span> <span class="sy0">/</span>etc<span class="sy0">/</span>banip<span class="sy0">/</span>banip.custom.feeds
uci add_list banip.global.ban_feed=<span class="st0">&quot;whatsapp&quot;</span>
uci commit banip
service banip restart</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Blocking WhatsApp&quot;,&quot;hid&quot;:&quot;blocking_whatsapp&quot;,&quot;codeblockOffset&quot;:6,&quot;secid&quot;:14,&quot;range&quot;:&quot;1686-2362&quot;} -->
<h3 class="sectionedit15" id="blocking_facebook">Blocking Facebook</h3>
<div class="level3">

<p>
Block Facebook using a custom list from <a href="https://github.com/SecOps-Institute/FacebookIPLists" class="urlextern" title="https://github.com/SecOps-Institute/FacebookIPLists" rel="ugc nofollow">SecOps-Institute/FacebookIPLists</a>.
</p>
<pre class="code bash"><span class="co0"># Block Facebook</span>
. <span class="sy0">/</span>usr<span class="sy0">/</span>share<span class="sy0">/</span>libubox<span class="sy0">/</span>jshn.sh
json_init
json_load_file <span class="sy0">/</span>etc<span class="sy0">/</span>banip<span class="sy0">/</span>banip.custom.feeds <span class="nu0">2</span><span class="sy0">&gt;</span> <span class="sy0">/</span>dev<span class="sy0">/</span>null
json_add_object <span class="st0">&quot;facebook&quot;</span>
json_add_string <span class="st0">&quot;descr&quot;</span> <span class="st0">&quot;Facebook CIDR&quot;</span>
json_add_string <span class="st0">&quot;url_4&quot;</span> <span class="st0">&quot;https://raw.githubusercontent.com/<span class="es1">\
</span>SecOps-Institute/FacebookIPLists/master/facebook_ipv4_cidr_blocks.lst&quot;</span>
json_add_string <span class="st0">&quot;rule_4&quot;</span> <span class="st0">&quot;/^[^#]/{print <span class="es1">\$</span>1<span class="es1">\&quot;</span>,<span class="es1">\&quot;</span>}&quot;</span>
json_add_string <span class="st0">&quot;url_6&quot;</span> <span class="st0">&quot;https://raw.githubusercontent.com/<span class="es1">\
</span>SecOps-Institute/FacebookIPLists/master/facebook_ipv6_list.lst&quot;</span>
json_add_string <span class="st0">&quot;rule_6&quot;</span> <span class="st0">&quot;/^[^#]/{print <span class="es1">\$</span>1<span class="es1">\&quot;</span>,<span class="es1">\&quot;</span>}&quot;</span>
json_close_object
json_dump <span class="sy0">&gt;</span> <span class="sy0">/</span>etc<span class="sy0">/</span>banip<span class="sy0">/</span>banip.custom.feeds
uci add_list banip.global.ban_feed=<span class="st0">&quot;facebook&quot;</span>
uci commit banip
service banip restart</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Blocking Facebook&quot;,&quot;hid&quot;:&quot;blocking_facebook&quot;,&quot;codeblockOffset&quot;:7,&quot;secid&quot;:15,&quot;range&quot;:&quot;2363-3227&quot;} -->
<h3 class="sectionedit16" id="whitelisting_networks">Whitelisting networks</h3>
<div class="level3">

<p>
Whitelist network interfaces.
</p>
<pre class="code bash"><span class="co0"># Whitelist interfaces</span>
uci add_list banip.global.ban_vlanallow=<span class="st0">&quot;br-lan&quot;</span>
uci add_list banip.global.ban_vlanallow=<span class="st0">&quot;br-dmz&quot;</span>
uci commit banip
service banip restart</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Whitelisting networks&quot;,&quot;hid&quot;:&quot;whitelisting_networks&quot;,&quot;codeblockOffset&quot;:8,&quot;secid&quot;:16,&quot;range&quot;:&quot;3228-3471&quot;} -->
<h3 class="sectionedit17" id="whitelisting_clients">Whitelisting clients</h3>
<div class="level3">

<p>
Whitelist client MACs.
</p>
<pre class="code bash"><span class="co0"># Whitelist MACs</span>
<span class="kw2">cat</span> <span class="sy0">&lt;&lt;</span> EOF <span class="sy0">&gt;&gt;</span> <span class="sy0">/</span>etc<span class="sy0">/</span>banip<span class="sy0">/</span>banip.allowlist
<span class="nu0">11</span>:<span class="nu0">22</span>:<span class="nu0">33</span>:<span class="nu0">44</span>:<span class="nu0">55</span>:<span class="nu0">66</span>
aa:bb:cc:dd:ee:ff
EOF
service banip restart</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Whitelisting clients&quot;,&quot;hid&quot;:&quot;whitelisting_clients&quot;,&quot;codeblockOffset&quot;:9,&quot;secid&quot;:17,&quot;range&quot;:&quot;3472-3667&quot;} -->
<h3 class="sectionedit18" id="whitelisting_domains">Whitelisting domains</h3>
<div class="level3">

<p>
Whitelist domains.
</p>
<pre class="code bash"><span class="co0"># Whitelist domains</span>
<span class="kw2">cat</span> <span class="sy0">&lt;&lt;</span> EOF <span class="sy0">&gt;&gt;</span> <span class="sy0">/</span>etc<span class="sy0">/</span>banip<span class="sy0">/</span>banip.allowlist
example.com
example.net
EOF
service banip restart</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Whitelisting domains&quot;,&quot;hid&quot;:&quot;whitelisting_domains&quot;,&quot;codeblockOffset&quot;:10,&quot;secid&quot;:18,&quot;range&quot;:&quot;3668-3850&quot;} -->
<h3 class="sectionedit19" id="whitelist_only">Whitelist only</h3>
<div class="level3">

<p>
Allow only whitelisted entries.
</p>
<pre class="code bash"><span class="co0"># Whitelist only</span>
uci <span class="kw1">set</span> banip.global.ban_allowlistonly=<span class="st0">&quot;1&quot;</span>
uci commit banip
service banip restart</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Whitelist only&quot;,&quot;hid&quot;:&quot;whitelist_only&quot;,&quot;codeblockOffset&quot;:11,&quot;secid&quot;:19,&quot;range&quot;:&quot;3851-&quot;} -->