
<h1 class="sectionedit1" id="kerberos_server_howto">Kerberos Server HowTo</h1>
<div class="level1">

<p>
Kerberos is a network authentication protocol which works on the basis of “tickets” to allow nodes communicating over a non-secure network to prove their identity to one another in a secure manner. (Source <a href="https://en.wikipedia.org/wiki/Kerberos_(protocol)" class="interwiki iw_wp" title="https://en.wikipedia.org/wiki/Kerberos_(protocol)">Kerberos_(protocol)</a>)
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Kerberos Server HowTo&quot;,&quot;hid&quot;:&quot;kerberos_server_howto&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:1,&quot;range&quot;:&quot;1-271&quot;} -->
<h2 class="sectionedit2" id="preparation">Preparation</h2>
<div class="level2">

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Preparation&quot;,&quot;hid&quot;:&quot;preparation&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:2,&quot;range&quot;:&quot;272-296&quot;} -->
<h3 class="sectionedit3" id="prerequisites">Prerequisites</h3>
<div class="level3">

<p>
Please read about here <a href="https://en.wikipedia.org/wiki/Kerberos_(protocol)" class="interwiki iw_wp" title="https://en.wikipedia.org/wiki/Kerberos_(protocol)">Kerberos_(protocol)</a> and especially <a href="http://www.kerberos.org/software/adminkerberos.pdf" class="urlextern" title="http://www.kerberos.org/software/adminkerberos.pdf" rel="ugc nofollow">Kerberos How-to</a>.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Prerequisites&quot;,&quot;hid&quot;:&quot;prerequisites&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:3,&quot;range&quot;:&quot;297-458&quot;} -->
<h3 class="sectionedit4" id="required_packages">Required Packages</h3>
<div class="level3">

</div>

<h4 id="server_openwrt">Server (OpenWrt)</h4>
<div class="level4">
<ul>
<li class="level1 node"><div class="li"><strong><code>krb5-server</code></strong></div>
<ul>
<li class="level2"><div class="li"><strong><code>krb5-libs</code></strong> (dependency of <em>krb5-server</em>)</div>
</li>
</ul>
</li>
</ul>

</div>

<h4 id="client_openwrt">Client (OpenWrt)</h4>
<div class="level4">
<ul>
<li class="level1"><div class="li"><strong><code>krb5-client</code></strong></div>
</li>
</ul>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Required Packages&quot;,&quot;hid&quot;:&quot;required_packages&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:4,&quot;range&quot;:&quot;459-639&quot;} -->
<h2 class="sectionedit5" id="installation">Installation</h2>
<div class="level2">

<p>
<a href="/docs/guide-user/additional-software/opkg" class="wikilink1" title="docs:guide-user:additional-software:opkg" data-wiki-id="docs:guide-user:additional-software:opkg">opkg</a>
</p>
<pre class="code bash">opkg <span class="kw2">install</span> krb5-server</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Installation&quot;,&quot;hid&quot;:&quot;installation&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:5,&quot;range&quot;:&quot;640-755&quot;} -->
<h2 class="sectionedit6" id="configuration">Configuration</h2>
<div class="level2">

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Configuration&quot;,&quot;hid&quot;:&quot;configuration&quot;,&quot;codeblockOffset&quot;:1,&quot;secid&quot;:6,&quot;range&quot;:&quot;756-781&quot;} -->
<h3 class="sectionedit7" id="server_configuration">Server configuration</h3>
<div class="level3">

<p>
Create the file <code>/etc/krb5.conf</code> with the following credentials. Example:
</p>
<pre class="code">[libdefaults]
    default_realm = YOURDOMAIN.ORG
    dns_lookup_realm = false
    dns_lookup_kdc = false
    ticket_lifetime = 24h
    forwardable = yes

[realms]
    YOURDOMAIN.ORG = {
        kdc = server_address_of_this_machine:88
        admin_server = server_address_of_this_machine:749
        default_domain = yourdomain.org
    }

[domain_realm]
    .yourdomain.org = YOURDOMAIN.ORG
    yourdomain.org = YOURDOMAIN.ORG</pre>

<p>
Replace <strong>YOURDOMAIN.ORG</strong> / <strong>yourdomain.org</strong> with the domain name of your domain the server should act for (names must be specified in UPPER- / lowercase as shown above). Replace <strong>server_address_of_this_machine</strong> with the host name/<abbr title="Internet Protocol">IP</abbr> adress of this server you&#039;re setting up.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Server configuration&quot;,&quot;hid&quot;:&quot;server_configuration&quot;,&quot;codeblockOffset&quot;:1,&quot;secid&quot;:7,&quot;range&quot;:&quot;782-1612&quot;} -->
<h3 class="sectionedit8" id="starting_the_server">Starting the server</h3>
<div class="level3">

<p>
Start the server by issuing 
</p>
<pre class="code">/etc/init.d/krb5kdc start</pre>

<p>
This should create the /etc/krb5kdc/ directory with the following files
</p>
<pre class="code">-rw-------    1 root     root         8192 Feb 13 11:17 principal
-rw-------    1 root     root         8192 Feb 13 09:12 principal.kadm5
-rw-------    1 root     root            0 Feb 13 09:12 principal.kadm5.lock
-rw-------    1 root     root            0 Feb 13 11:17 principal.ok</pre>

<p>
In case you don&#039;t get any error messages check your server by logging on with 
</p>
<pre class="code">kadmin.local</pre>

<p>
In case everything works well you will see the following message
</p>
<pre class="code">root@bridge:~# kadmin.local
Authenticating as principal xxxxxxx/admin@YOURDOMAIN.ORG with password.
kadmin.local:</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Starting the server&quot;,&quot;hid&quot;:&quot;starting_the_server&quot;,&quot;codeblockOffset&quot;:2,&quot;secid&quot;:8,&quot;range&quot;:&quot;1613-2384&quot;} -->
<h3 class="sectionedit9" id="testing_the_server">Testing the server</h3>
<div class="level3">

<p>
Perform the tests as described in the <a href="http://www.kerberos.org/software/adminkerberos.pdf" class="urlextern" title="http://www.kerberos.org/software/adminkerberos.pdf" rel="ugc nofollow">Kerberos How-to</a> document on page 16/17.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Testing the server&quot;,&quot;hid&quot;:&quot;testing_the_server&quot;,&quot;codeblockOffset&quot;:6,&quot;secid&quot;:9,&quot;range&quot;:&quot;2385-2548&quot;} -->
<h2 class="sectionedit10" id="start_on_boot">Start on boot</h2>
<div class="level2">

<p>
To enable/disable automatic start on boot:<br/>

</p>
<pre class="code">/etc/init.d/krb5kdc enable</pre>

<p>
  this simply creates a symlink: <code>/etc/rc.d/S60krb5kdc → /etc/init.d/krb5kdc</code><br/>

</p>
<pre class="code">/etc/init.d/krb5kdc disable</pre>

<p>
 this removes the symlink again<br/>

</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Start on boot&quot;,&quot;hid&quot;:&quot;start_on_boot&quot;,&quot;codeblockOffset&quot;:6,&quot;secid&quot;:10,&quot;range&quot;:&quot;2549-2816&quot;} -->
<h2 class="sectionedit11" id="notes">Notes</h2>
<div class="level2">
<ul>
<li class="level1"><div class="li"> The Project Homepage: <a href="http://web.mit.edu/kerberos/" class="urlextern" title="http://web.mit.edu/kerberos/" rel="ugc nofollow">http://web.mit.edu/kerberos/</a></div>
</li>
<li class="level1"><div class="li"> Kerberos How-To: <a href="http://www.kerberos.org/software/adminkerberos.pdf" class="urlextern" title="http://www.kerberos.org/software/adminkerberos.pdf" rel="ugc nofollow">http://www.kerberos.org/software/adminkerberos.pdf</a></div>
</li>
<li class="level1"><div class="li"> Kerberos Tutorial: <a href="http://www.kerberos.org/software/tutorial.html" class="urlextern" title="http://www.kerberos.org/software/tutorial.html" rel="ugc nofollow">http://www.kerberos.org/software/tutorial.html</a></div>
</li>
</ul>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Notes&quot;,&quot;hid&quot;:&quot;notes&quot;,&quot;codeblockOffset&quot;:8,&quot;secid&quot;:11,&quot;range&quot;:&quot;2817-&quot;} -->