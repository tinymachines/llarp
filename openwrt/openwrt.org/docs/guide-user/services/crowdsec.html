
<h1 class="sectionedit1" id="crowdsec">CrowdSec</h1>
<div class="level1">
<!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_start&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:2,&quot;range&quot;:&quot;0-&quot;} --><div class="wrap_center wrap_info plugin_wrap" style="width: 100%;">
<p>
This wiki page is currently a work in progress and information is currently in the process of being transferred from the community forum.
</p>
</div><!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_end&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:3,&quot;range&quot;:&quot;0-&quot;} -->
<p>
Main Website: <a href="https://crowdsec.net/" class="urlextern" title="https://crowdsec.net/" rel="ugc nofollow">https://crowdsec.net/</a> <br/>

Documentation : <a href="https://doc.crowdsec.net/" class="urlextern" title="https://doc.crowdsec.net/" rel="ugc nofollow">https://doc.crowdsec.net/</a> <br/>

Release info: <a href="https://github.com/crowdsecurity/crowdsec/releases" class="urlextern" title="https://github.com/crowdsecurity/crowdsec/releases" rel="ugc nofollow">https://github.com/crowdsecurity/crowdsec/releases</a> <br/>

OpenWrt Forum thread: <a href="https://forum.openwrt.org/t/crowdsec-packages-for-openwrt/102648" class="urlextern" title="https://forum.openwrt.org/t/crowdsec-packages-for-openwrt/102648" rel="ugc nofollow">https://forum.openwrt.org/t/crowdsec-packages-for-openwrt/102648</a> <br/>

CrowdSec Forum thread: <a href="https://discourse.crowdsec.net/t/crowdsec-package-for-openwrt/225" class="urlextern" title="https://discourse.crowdsec.net/t/crowdsec-package-for-openwrt/225" rel="ugc nofollow">https://discourse.crowdsec.net/t/crowdsec-package-for-openwrt/225</a> <br/>

CrowdSec Web-console: <a href="https://app.crowdsec.net/product-tour" class="urlextern" title="https://app.crowdsec.net/product-tour" rel="ugc nofollow">https://app.crowdsec.net/product-tour</a>
CrowdSec has already made some tutorials on their blog: <a href="https://crowdsec.net/blog/" class="urlextern" title="https://crowdsec.net/blog/" rel="ugc nofollow">https://crowdsec.net/blog/</a>
</p>

<p>
Crowdsec is an open-source and lightweight software that allows you to detect peers with malevolent behaviors and block them from accessing your systems at various level (infrastructural, system, application).
</p>

<p>
To achieve this, CrowdSec reads logs from different sources (files, streams ...) to parse, normalize and enrich them before matching them to threats patterns called scenarios.
</p>
<ul>
<li class="level1"><div class="li"> Package <a href="/packages/pkgdata/crowdsec" class="wikilink1" title="packages:pkgdata:crowdsec" data-wiki-id="packages:pkgdata:crowdsec">crowdsec</a> Main program bundle.</div>
</li>
<li class="level1"><div class="li"> Package <a href="/packages/pkgdata/crowdsec-firewall-bouncer" class="wikilink1" title="packages:pkgdata:crowdsec-firewall-bouncer" data-wiki-id="packages:pkgdata:crowdsec-firewall-bouncer">crowdsec-firewall-bouncer</a> - will fetch new and old decisions from a CrowdSec <abbr title="Application Programming Interface">API</abbr> to add them in a blacklist used by supported firewalls.</div>
</li>
</ul>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;CrowdSec&quot;,&quot;hid&quot;:&quot;crowdsec&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:1,&quot;range&quot;:&quot;1-1328&quot;} -->
<h2 class="sectionedit4" id="installation">Installation</h2>
<div class="level2">

<p>
<img src="/lib/images/smileys/exclaim.svg" class="icon smiley" alt=":!:" /> For installing the crowdsec-firewall-bouncer, installation of the crowdsec main package is not required. The bouncer just needs a &#039;local Crowdsec <abbr title="Application Programming Interface">API</abbr>&#039; to connect to.
</p>

<p>
The CrowdSec main package requires ~60MB of space, thus you may want to run your CrowdSec installation on a dedicated device in your network (maybe a Raspberry Pi) and only install the firewall bouncer on the OpenWrt device.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Installation&quot;,&quot;hid&quot;:&quot;installation&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:4,&quot;range&quot;:&quot;1329-1750&quot;} -->
<h3 class="sectionedit5" id="crowdsec_main_package">Crowdsec main package</h3>
<div class="level3">
<pre class="code">opkg install crowdsec</pre>

<p>
As OpenWrt does not have systemctl but initd you must use 
</p>
<pre class="code">/etc/init.d/crowdsec reload</pre>

<p>
 or 
</p>
<pre class="code">service crowdsec reload</pre>

<p>
 to reload crowdsec.
</p>

<p>
Follow crowdsec <a href="https://doc.crowdsec.net/docs/getting_started/crowdsec_tour" class="urlextern" title="https://doc.crowdsec.net/docs/getting_started/crowdsec_tour" rel="ugc nofollow">documentation</a> now it is installed.
</p>

<p>
<img src="/lib/images/smileys/exclaim.svg" class="icon smiley" alt=":!:" />
Keep in mind that the crowdsec package is only in charge of the “detection”, and won&#039;t block anything on its own. You need to deploy a bouncer to “apply” decisions.
</p>

</div>

<h4 id="check_status">Check status</h4>
<div class="level4">

<p>
You can read the main log at /var/log/crowdsec.log
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Crowdsec main package&quot;,&quot;hid&quot;:&quot;crowdsec_main_package&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:5,&quot;range&quot;:&quot;1751-2340&quot;} -->
<h3 class="sectionedit6" id="crowdsec_firewall_bouncer">Crowdsec firewall bouncer</h3>
<div class="level3">

<p>
You can install a <a href="https://doc.crowdsec.net/docs/bouncers/intro" class="urlextern" title="https://doc.crowdsec.net/docs/bouncers/intro" rel="ugc nofollow">bouncer</a> like this : 
</p>
<pre class="code">opkg install crowdsec-firewall-bouncer</pre>

<p>
<img src="/lib/images/smileys/exclaim.svg" class="icon smiley" alt=":!:" /> After installation and before you can use the CrowdSec firewall bouncer you need to configure it first.
<br/>

<br/>

</p>

<p>
You can list available bouncers with:
</p>
<pre class="code">cscli bouncers list</pre>

<p>
if the list is empty, you need to add the new bouncer (change the bouncer name to a more appropriate):
</p>
<pre class="code">cscli bouncers add TestBouncer</pre>

<p>
Sample output:
</p>
<pre class="code">API key for &#039;TestBouncer&#039;:

   HNoB4ifqBMa0Ytryy5EtyjEj6Q+/Aw09KRaJMew5iiU

Please keep this key since you will not be able to retrieve it!</pre>

<p>
Use the above <abbr title="Application Programming Interface">API</abbr> key in /etc/config/crowdsec.
</p>

<p>
As OpenWrt does not have systemctl but initd you must use
</p>
<pre class="code">/etc/init.d/crowdsec-firewall-bouncer reload</pre>

<p>
 or 
</p>
<pre class="code">service crowdsec-firewall-bouncer reload</pre>

<p>
to reload the bouncer (e.g. after config change).
<br/>

<br/>

</p>

</div>

<h4 id="configuration">Configuration</h4>
<div class="level4">

<p>
The configuration of the crowdsec-firewall-bouncer is a uci configuration file and found in /etc/config/crowdsec. 
</p>
<pre class="code">config bouncer
	option enabled &#039;0&#039;
	option ipv4 &#039;1&#039;
	option ipv6 &#039;1&#039;
	option api_url &#039;http://localhost:8080/&#039;
	option api_key &#039;&#039;
	option deny_action &#039;drop&#039;
	option deny_log &#039;0&#039;
	option log_prefix &#039;crowdsec: &#039;
	option log_level &#039;info&#039;
	option filter_input &#039;1&#039;
	option filter_forward &#039;1&#039;
	list interface &#039;eth1&#039;</pre>
<div class="sortable"><div class="table sectionedit7"><table class="inline">
	<thead>
	<tr class="row0">
		<th class="col0 leftalign"> Name                </th><th class="col1 leftalign"> Type     </th><th class="col2 leftalign"> Default                     </th><th class="col3 leftalign"> Option    </th><th class="col4 leftalign"> Description                                                                                                                                                                 </th>
	</tr>
	</thead>
	<tr class="row1">
		<td class="col0 leftalign"> <code>enabled</code>         </td><td class="col1 leftalign"> boolean  </td><td class="col2 leftalign"> <code>0</code>                       </td><td class="col3 leftalign"> required  </td><td class="col4 leftalign"> <img src="/lib/images/smileys/exclaim.svg" class="icon smiley" alt=":!:" /> Enable the crowdsec firewall bouncer. After first installation this value is 0 as api_url and api_key are required for the bouncer to function.                         </td>
	</tr>
	<tr class="row2">
		<td class="col0 leftalign"> <code>ipv4</code>            </td><td class="col1 leftalign"> boolean  </td><td class="col2 leftalign"> <code>1</code>                       </td><td class="col3 leftalign"> optional  </td><td class="col4 leftalign"> Enable filtering on Ipv4 addresses.                                                                                                                                         </td>
	</tr>
	<tr class="row3">
		<td class="col0 leftalign"> <code>ipv6</code>            </td><td class="col1 leftalign"> boolean  </td><td class="col2 leftalign"> <code>1</code>                       </td><td class="col3 leftalign"> optional  </td><td class="col4 leftalign"> Enable filtering on Ipv6 addresses.                                                                                                                                         </td>
	</tr>
	<tr class="row4">
		<td class="col0 leftalign"> <code>api_url</code>         </td><td class="col1 leftalign"> url      </td><td class="col2 leftalign"> <code><a href="http://localhost:8080/" class="urlextern" title="http://localhost:8080/" rel="ugc nofollow">http://localhost:8080/</a></code>  </td><td class="col3 leftalign"> required  </td><td class="col4 leftalign"> The url of the Crowdsec local <abbr title="Application Programming Interface">API</abbr> for the bouncer to connect to.                                                                                                            </td>
	</tr>
	<tr class="row5">
		<td class="col0 leftalign"> <code>api_key</code>         </td><td class="col1 leftalign"> string   </td><td class="col2 leftalign"> <code></code>                        </td><td class="col3 leftalign"> required  </td><td class="col4 leftalign"> The api key for the bouncer as generated when the bouncer is registered to the Crowdsec local <abbr title="Application Programming Interface">API</abbr>.                                                                          </td>
	</tr>
	<tr class="row6">
		<td class="col0 leftalign"> <code>deny_action</code>     </td><td class="col1 leftalign"> string   </td><td class="col2 leftalign"> <code>drop</code>                    </td><td class="col3 leftalign"> optional  </td><td class="col4 leftalign"> The nftables deny action for blocked ips. Can be drop or reject.                                                                                                            </td>
	</tr>
	<tr class="row7">
		<td class="col0 leftalign"> <code>deny_log</code>        </td><td class="col1 leftalign"> boolean  </td><td class="col2 leftalign"> <code>0</code>                       </td><td class="col3 leftalign"> optional  </td><td class="col4 leftalign"> Enables logging of blocked ips to system log.                                                                                                                               </td>
	</tr>
	<tr class="row8">
		<td class="col0 leftalign"> <code>log_prefix</code>      </td><td class="col1 leftalign"> string   </td><td class="col2 leftalign"> <code>crowdsec: </code>              </td><td class="col3 leftalign"> optional  </td><td class="col4 leftalign"> The prefix for the log messages of blocked ips in system log.                                                                                                               </td>
	</tr>
	<tr class="row9">
		<td class="col0 leftalign"> <code>log_level </code>      </td><td class="col1 leftalign"> string   </td><td class="col2 leftalign"> <code>info</code>                    </td><td class="col3 leftalign"> optional  </td><td class="col4 leftalign"> The log level for the bouncer&#039;s log (/var/log/crowdsec-firewall-bouncer.log)                                                                                                </td>
	</tr>
	<tr class="row10">
		<td class="col0 leftalign"> <code>filter_input</code>    </td><td class="col1 leftalign"> boolean  </td><td class="col2 leftalign"> <code>1</code>                       </td><td class="col3 leftalign"> optional  </td><td class="col4 leftalign"> Enables the filtering of the input chain. Useful in case of services running on the OpenWrt device itself.                                                                 </td>
	</tr>
	<tr class="row11">
		<td class="col0 leftalign"> <code>filter_forward</code>  </td><td class="col1 leftalign"> boolean  </td><td class="col2 leftalign"> <code>1</code>                       </td><td class="col3 leftalign"> optional  </td><td class="col4 leftalign"> Enables the filtering of the forward chain. Useful in case of services running on devices in your network.                                                                 </td>
	</tr>
	<tr class="row12">
		<td class="col0 leftalign">                     </td><td class="col1 leftalign">          </td><td class="col2 leftalign">                             </td><td class="col3 leftalign">           </td><td class="col4 leftalign">                                                                                                                                                                             </td>
	</tr>
	<tr class="row13">
		<td class="col0 leftalign"> <code>interface</code>       </td><td class="col1 leftalign"> string   </td><td class="col2 leftalign"> <code>eth1</code>                    </td><td class="col3 leftalign"> required  </td><td class="col4 leftalign"> The interface name of the wan interface. This is a list option and can be used multiple times to apply blocking on other interfaces like additional wan or vpn interfaces.  </td>
	</tr>
</table></div>
<!-- EDIT{&quot;target&quot;:&quot;table&quot;,&quot;name&quot;:&quot;&quot;,&quot;hid&quot;:&quot;table&quot;,&quot;secid&quot;:7,&quot;range&quot;:&quot;3783-7294&quot;} --></div>
</div>

<h4 id="check_status1">Check status</h4>
<div class="level4">

<p>
You can read the firewall bouncer log at /var/log/crowdsec-firewall-bouncer.log
</p>

<p>
You can test the crowdsec-firewall-bouncer configuration status with the following command:
</p>
<pre class="code">cs-firewall-bouncer -t -c /tmp/etc/crowdsec/bouncers/crowdsec-firewall-bouncer.yaml</pre>

<p>
then you&#039;ll must see a line like this one in the log:
</p>
<pre class="code">cat /var/log/crowdsec-firewall-bouncer.log</pre>
<pre class="code">time=&quot;15-01-2022 08:20:30&quot; level=info msg=&quot;config is valid&quot;</pre>

<p>
To check the bouncers status, use the main crowdsec client tool, cscli. If you haven&#039;t installed Crowdsec main package on your OpenWrt device you can do so on any other device (preferrably the local <abbr title="Application Programming Interface">API</abbr>) you have Crowdsec cscli installed.
</p>

<p>
cscli default output:
</p>
<pre class="code">cscli is the main command to interact with your crowdsec service, scenarios &amp; db.
It is meant to allow you to manage bans, parsers/scenarios/etc, api and generally manage you crowdsec setup.

Usage:
  cscli [command]

Available Commands:
  alerts        Manage alerts
  bouncers      Manage bouncers [requires local API]
  capi          Manage interaction with Central API (CAPI)
  collections   Manage collections from hub
  completion    Generate completion script
  config        Allows to view current config
  console       Manage interaction with Crowdsec console (https://app.crowdsec.net)
  dashboard     Manage your metabase dashboard container [requires local API]
  decisions     Manage decisions
  explain       Explain log pipeline
  help          Help about any command
  hub           Manage Hub
  hubtest       Run functional tests on hub configurations
  lapi          Manage interaction with Local API (LAPI)
  machines      Manage local API machines [requires local API]
  metrics       Display crowdsec prometheus metrics.
  parsers       Install/Remove/Upgrade/Inspect parser(s) from hub
  postoverflows Install/Remove/Upgrade/Inspect postoverflow(s) from hub
  scenarios     Install/Remove/Upgrade/Inspect scenario(s) from hub
  simulation    Manage simulation status of scenarios
  version       Display version and exit.

Flags:
  -c, --config string   path to crowdsec config file (default &quot;/etc/crowdsec/config.yaml&quot;)
  -o, --output string   Output format : human, json, raw.
      --debug           Set logging to debug.
      --info            Set logging to info.
      --warning         Set logging to warning.
      --error           Set logging to error.
      --trace           Set logging to trace.
  -h, --help            help for cscli

Use &quot;cscli [command] --help&quot; for more information about a command.</pre>
<pre class="code">cscli bouncers list</pre>

<p>
a sample working output will be:
</p>
<pre class="code">---------------------------------------------------------------------------------------------------------------------------------------
 NAME                                IP ADDRESS  VALID  LAST API PULL              TYPE                       VERSION                  
---------------------------------------------------------------------------------------------------------------------------------------
 crowdsec-firewall-bouncer-LK1HD1Vx  127.0.0.1   ✔️      2022-01-15T08:28:02+01:00  crowdsec-firewall-bouncer  v0.0.21-openwrt-0.0.21-1 
---------------------------------------------------------------------------------------------------------------------------------------</pre>

<p>
You can view your global status health:
</p>
<pre class="code">cscli metrics</pre>

<p>
Sample output:
</p>
<pre class="code">INFO[17-10-2021 10:36:19 AM] Local Api Metrics:                           
+----------------------+--------+--------+
|        ROUTE         | METHOD |  HITS  |
+----------------------+--------+--------+
| /v1/alerts           | GET    |      3 |
| /v1/decisions/stream | GET    | 108456 |
| /v1/watchers/login   | POST   |      6 |
+----------------------+--------+--------+
INFO[17-10-2021 10:36:19 AM] Local Api Machines Metrics:                  
+--------------------------------------------------+------------+--------+------+
|                     MACHINE                      |   ROUTE    | METHOD | HITS |
+--------------------------------------------------+------------+--------+------+
| db3e872e345f48848d0d85ab5c529947GWkbyXJtyNnJziiS | /v1/alerts | GET    |    3 |
+--------------------------------------------------+------------+--------+------+
INFO[17-10-2021 10:36:19 AM] Local Api Bouncers Metrics:                  
+------------------------------+----------------------+--------+--------+
|           BOUNCER            |        ROUTE         | METHOD |  HITS  |
+------------------------------+----------------------+--------+--------+
| cs-firewall-bouncer-LeCzIx9V | /v1/decisions/stream | GET    | 108456 |
+------------------------------+----------------------+--------+--------+</pre>

<p>
You can verify the process is up wit default system command like ps:
</p>
<pre class="code">ps | grep crowdsec</pre>
<pre class="code">cscli decisions list</pre>

<p>
sample output:
</p>
<pre class="code">+-------+----------+------------------+--------------------------------------+--------+---------+------------------+--------+--------------------+----------+
|  ID   |  SOURCE  |   SCOPE:VALUE    |                REASON                | ACTION | COUNTRY |        AS        | EVENTS |     EXPIRATION     | ALERT ID |
+-------+----------+------------------+--------------------------------------+--------+---------+------------------+--------+--------------------+----------+
| 15136 | crowdsec | Ip:37.173.175.13 | crowdsecurity/http-crawl-non_statics | ban    | FR      |  Free Mobile SAS |     57 | 2h47m27.230010039s |      215 |
+-------+----------+------------------+--------------------------------------+--------+---------+------------------+--------+--------------------+----------+</pre>

<p>
You can manage banned ip with 
</p>
<pre class="code">cscli decision</pre>

<p>
.
Check the actually banned IPs list:
</p>
<pre class="code">cscli decisions list
No active decisions</pre>

<p>
Manually add an <abbr title="Internet Protocol">IP</abbr> to the ban list:
</p>
<pre class="code">cscli decisions add --ip 37.172.100.86 --duration 1h
INFO[26-07-2021 08:40:29 AM] Decision successfully added                  </pre>

<p>
Check the banned <abbr title="Internet Protocol">IP</abbr> list:
</p>
<pre class="code">cscli decisions list
+------+--------+------------------+----------------------------------------------------+--------+---------+----+--------+-----------------+----------+
|  ID  | SOURCE |   SCOPE:VALUE    |                       REASON                       | ACTION | COUNTRY | AS | EVENTS |   EXPIRATION    | ALERT ID |
+------+--------+------------------+----------------------------------------------------+--------+---------+----+--------+-----------------+----------+
| 4203 | cscli  | Ip:37.172.100.86 | manual &#039;ban&#039; from                                  | ban    |         |    |      1 | 59m55.64019484s |       55 |
|      |        |                  | &#039;50c75c1635bd4935b1be5d95ae5f860epTkK2cAbb6nzI1fJ&#039; |        |         |    |        |                 |          |
+------+--------+------------------+----------------------------------------------------+--------+---------+----+--------+-----------------+----------+</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Crowdsec firewall bouncer&quot;,&quot;hid&quot;:&quot;crowdsec_firewall_bouncer&quot;,&quot;codeblockOffset&quot;:3,&quot;secid&quot;:6,&quot;range&quot;:&quot;2341-14346&quot;} -->
<h2 class="sectionedit8" id="check_nftables_status">Check nftables status</h2>
<div class="level2">

<p>
If you use nftables, you can use specific commands like:
</p>
<pre class="code">nft list tables</pre>
<pre class="code">nft list table crowdsec</pre>
<pre class="code">nft list chains</pre>
<pre class="code">nft list ruleset</pre>

<p>
cscli can also be used to check these alerts with: 
</p>
<pre class="code">cscli alerts list</pre>

<p>
sample output:
</p>
<pre class="code">+------+------------------------------+----------------------+---------+----+-----------+--------------------------------+
|  ID  |            VALUE             |        REASON        | COUNTRY | AS | DECISIONS |           CREATED AT           |
+------+------------------------------+----------------------+---------+----+-----------+--------------------------------+
| 1051 | crowdsec/community-blocklist | update : +728/-0 IPs |         |    | ban:728   | 2021-10-17 09:20:26 +0200      |
|      |                              |                      |         |    |           | +0200                          |
| 1050 | crowdsec/community-blocklist | update : +727/-0 IPs |         |    | ban:1     | 2021-10-17 07:20:26 +0200      |
|      |                              |                      |         |    |           | +0200                          |</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Check nftables status&quot;,&quot;hid&quot;:&quot;check_nftables_status&quot;,&quot;codeblockOffset&quot;:25,&quot;secid&quot;:8,&quot;range&quot;:&quot;14347-15540&quot;} -->
<h2 class="sectionedit9" id="notification_plugins">Notification Plugins</h2>
<div class="level2">

<p>
REFS:
</p>

<p>
- <a href="https://docs.crowdsec.net/docs/notification_plugins/intro" class="urlextern" title="https://docs.crowdsec.net/docs/notification_plugins/intro" rel="ugc nofollow">https://docs.crowdsec.net/docs/notification_plugins/intro</a>
</p>

<p>
- <a href="https://doc.crowdsec.net/docs/notification_plugins/email" class="urlextern" title="https://doc.crowdsec.net/docs/notification_plugins/email" rel="ugc nofollow">https://doc.crowdsec.net/docs/notification_plugins/email</a>
</p>

<p>
To enable email notifications plugins, you must uncomment the following section
</p>
<pre class="code">#notifications:
# - email_default</pre>

<p>
in 
</p>
<pre class="code">/etc/crowdsec/profiles.yaml</pre>

<p>
and modify:
</p>
<pre class="code">/etc/crowdsec/notifications/email.yaml</pre>

<p>
with:
</p>
<pre class="code">smtp_host: smtp.admin.net # eg value smtp.gmail.com
smtp_username: login@admin.net #Replace this with your actual username
smtp_password: theSECRETpassword #Replace this with your actual password
smtp_port: 587 # Common values are any of [25, 465, 587, 2525]
auth_type: login # Valid choices are either of &quot;none&quot;, &quot;crammd5&quot;, &quot;login&quot;, &quot;plain&quot; 
sender_email: postmaster@admin.net # eg: foo@gmail.com
email_subject: CrowdSec Notification
receiver_emails: 
 - me@admin.net
  # - email1@gmail.com
  # - email2@gmail.com
encryption_type: ssltls # eg valid choices are either &quot;ssltls&quot; or &quot;none&quot;</pre>

<p>
You must restart the CrowdSec service to enable the modifications with the command:
</p>
<pre class="code">service crowdsec restart</pre>

<p>
You can list configured notification plugins with
</p>
<pre class="code">cscli notifications list</pre>

<p>
And send a test email with
</p>
<pre class="code">cscli notifications test email_default</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Notification Plugins&quot;,&quot;hid&quot;:&quot;notification_plugins&quot;,&quot;codeblockOffset&quot;:31,&quot;secid&quot;:9,&quot;range&quot;:&quot;15541-16851&quot;} -->
<h2 class="sectionedit10" id="hub">HUB</h2>
<div class="level2">

<p>
To update the hub components available use the command:
</p>
<pre class="code">cscli hub update</pre>

<p>
To view the local used list of components use the command:
</p>
<pre class="code">cscli hub list</pre>

<p>
sample output:
</p>
<pre class="code">INFO[06-02-2022 10:16:20 PM] Loaded 41 collecs, 47 parsers, 57 scenarios, 3 post-overflow parsers 
POSTOVERFLOWS
--------------------------------------
 NAME  📦 STATUS  VERSION  LOCAL PATH 
--------------------------------------
--------------------------------------
PARSERS
----------------------------------------------------------------------------------------------------------------------------
 NAME                                    📦 STATUS   VERSION  LOCAL PATH                                                    
----------------------------------------------------------------------------------------------------------------------------
 crowdsecurity/sshd-logs                 ✔️  enabled  1.7      /etc/crowdsec/parsers/s01-parse/sshd-logs.yaml                
 crowdsecurity/iptables-logs             ✔️  enabled  0.2      /etc/crowdsec/parsers/s01-parse/iptables-logs.yaml            
 crowdsecurity/whitelists                ✔️  enabled  0.2      /etc/crowdsec/parsers/s02-enrich/whitelists.yaml              
 crowdsecurity/geoip-enrich              ✔️  enabled  0.2      /etc/crowdsec/parsers/s02-enrich/geoip-enrich.yaml            
 crowdsecurity/http-logs                 ✔️  enabled  0.7      /etc/crowdsec/parsers/s02-enrich/http-logs.yaml               
 crowdsecurity/syslog-logs               ✔️  enabled  0.8      /etc/crowdsec/parsers/s00-raw/syslog-logs.yaml                
 crowdsecurity/nextcloud-logs            ✔️  enabled  0.1      /etc/crowdsec/parsers/s01-parse/nextcloud-logs.yaml           
 crowdsecurity/dateparse-enrich          ✔️  enabled  0.2      /etc/crowdsec/parsers/s02-enrich/dateparse-enrich.yaml        
 crowdsecurity/nginx-proxy-manager-logs  ✔️  enabled  0.1      /etc/crowdsec/parsers/s01-parse/nginx-proxy-manager-logs.yaml 
----------------------------------------------------------------------------------------------------------------------------
COLLECTIONS
------------------------------------------------------------------------------------------------------------
 NAME                               📦 STATUS   VERSION  LOCAL PATH                                         
------------------------------------------------------------------------------------------------------------
 crowdsecurity/iptables             ✔️  enabled  0.1      /etc/crowdsec/collections/iptables.yaml            
 crowdsecurity/linux                ✔️  enabled  0.2      /etc/crowdsec/collections/linux.yaml               
 crowdsecurity/base-http-scenarios  ✔️  enabled  0.5      /etc/crowdsec/collections/base-http-scenarios.yaml 
 crowdsecurity/nextcloud            ✔️  enabled  0.2      /etc/crowdsec/collections/nextcloud.yaml           
 crowdsecurity/nginx-proxy-manager  ✔️  enabled  0.1      /etc/crowdsec/collections/nginx-proxy-manager.yaml 
 crowdsecurity/sshd                 ✔️  enabled  0.2      /etc/crowdsec/collections/sshd.yaml                
------------------------------------------------------------------------------------------------------------
SCENARIOS
--------------------------------------------------------------------------------------------------------------------------
 NAME                                       📦 STATUS   VERSION  LOCAL PATH                                               
--------------------------------------------------------------------------------------------------------------------------
 crowdsecurity/http-open-proxy              ✔️  enabled  0.2      /etc/crowdsec/scenarios/http-open-proxy.yaml             
 ltsich/http-w00tw00t                       ✔️  enabled  0.1      /etc/crowdsec/scenarios/http-w00tw00t.yaml               
 crowdsecurity/http-crawl-non_statics       ✔️  enabled  0.2      /etc/crowdsec/scenarios/http-crawl-non_statics.yaml      
 crowdsecurity/iptables-scan-multi_ports    ✔️  enabled  0.1      /etc/crowdsec/scenarios/iptables-scan-multi_ports.yaml   
 crowdsecurity/http-sensitive-files         ✔️  enabled  0.2      /etc/crowdsec/scenarios/http-sensitive-files.yaml        
 crowdsecurity/http-generic-bf              ✔️  enabled  0.1      /etc/crowdsec/scenarios/http-generic-bf.yaml             
 crowdsecurity/ssh-slow-bf                  ✔️  enabled  0.2      /etc/crowdsec/scenarios/ssh-slow-bf.yaml                 
 crowdsecurity/http-backdoors-attempts      ✔️  enabled  0.2      /etc/crowdsec/scenarios/http-backdoors-attempts.yaml     
 crowdsecurity/nextcloud-bf                 ✔️  enabled  0.1      /etc/crowdsec/scenarios/nextcloud-bf.yaml                
 crowdsecurity/ssh-bf                       ✔️  enabled  0.1      /etc/crowdsec/scenarios/ssh-bf.yaml                      
 crowdsecurity/http-path-traversal-probing  ✔️  enabled  0.2      /etc/crowdsec/scenarios/http-path-traversal-probing.yaml 
 crowdsecurity/http-bad-user-agent          ✔️  enabled  0.4      /etc/crowdsec/scenarios/http-bad-user-agent.yaml         
 crowdsecurity/http-probing                 ✔️  enabled  0.2      /etc/crowdsec/scenarios/http-probing.yaml                
 crowdsecurity/http-xss-probing             ✔️  enabled  0.2      /etc/crowdsec/scenarios/http-xss-probing.yaml            
 crowdsecurity/http-sqli-probing            ✔️  enabled  0.2      /etc/crowdsec/scenarios/http-sqli-probing.yaml           
--------------------------------------------------------------------------------------------------------------------------</pre>

<p>
To view the server list of available components from the CrowdSec hub, use the command:
</p>
<pre class="code">cscli hub list -a</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;HUB&quot;,&quot;hid&quot;:&quot;hub&quot;,&quot;codeblockOffset&quot;:38,&quot;secid&quot;:10,&quot;range&quot;:&quot;16852-22708&quot;} -->
<h3 class="sectionedit11" id="collections">Collections</h3>
<div class="level3">

</div>

<h4 id="nectcloud">NectCloud</h4>
<div class="level4">

<p>
REFS:
- <a href="https://hub.crowdsec.net/author/crowdsecurity/collections/nextcloud" class="urlextern" title="https://hub.crowdsec.net/author/crowdsecurity/collections/nextcloud" rel="ugc nofollow">https://hub.crowdsec.net/author/crowdsecurity/collections/nextcloud</a> <br/>

- <a href="https://hub.crowdsec.net/author/crowdsecurity/configurations/nextcloud-logs" class="urlextern" title="https://hub.crowdsec.net/author/crowdsecurity/configurations/nextcloud-logs" rel="ugc nofollow">https://hub.crowdsec.net/author/crowdsecurity/configurations/nextcloud-logs</a> <br/>

- <a href="https://hub.crowdsec.net/author/crowdsecurity/configurations/nextcloud-bf" class="urlextern" title="https://hub.crowdsec.net/author/crowdsecurity/configurations/nextcloud-bf" rel="ugc nofollow">https://hub.crowdsec.net/author/crowdsecurity/configurations/nextcloud-bf</a> <br/>

- <a href="https://docs.nextcloud.com/server/stable/admin_manual/configuration_server/config_sample_php_parameters.html?highlight=loglevel#logging" class="urlextern" title="https://docs.nextcloud.com/server/stable/admin_manual/configuration_server/config_sample_php_parameters.html?highlight=loglevel#logging" rel="ugc nofollow">https://docs.nextcloud.com/server/stable/admin_manual/configuration_server/config_sample_php_parameters.html?highlight=loglevel#logging</a> <br/>

- <a href="https://github.com/crowdsecurity/hub/blob/master/parsers/s01-parse/crowdsecurity/nextcloud-logs.yaml" class="urlextern" title="https://github.com/crowdsecurity/hub/blob/master/parsers/s01-parse/crowdsecurity/nextcloud-logs.yaml" rel="ugc nofollow">https://github.com/crowdsecurity/hub/blob/master/parsers/s01-parse/crowdsecurity/nextcloud-logs.yaml</a> <br/>

</p>

<p>
install the nextcloud community collection from the CrowdSec HUB with the command:
</p>
<pre class="code">cscli collections install crowdsecurity/nextcloud</pre>

<p>
Then add the default path of your nextcloud.log file to the CrowdSec acquis.yaml config file:
</p>
<pre class="code">/etc/crowdsec/acquis.yaml</pre>
<pre class="code">---
filenames:
# - /var/www/nextcloud/data/nextcloud.log
# Dockerized NextCloud
  - /srv/docker/volumes/nc_gnextcloud_data/_data/nextcloud.log
labels:
  type: Nextcloud</pre>

<p>
You must restart the CrowdSec service to enable the modifications with the command:
</p>
<pre class="code">service crowdsec restart</pre>

</div>

<h4 id="nginx_proxy_manager">Nginx Proxy Manager</h4>
<div class="level4">

<p>
REFS:
- <a href="https://hub.crowdsec.net/author/crowdsecurity/collections/nginx-proxy-manager" class="urlextern" title="https://hub.crowdsec.net/author/crowdsecurity/collections/nginx-proxy-manager" rel="ugc nofollow">https://hub.crowdsec.net/author/crowdsecurity/collections/nginx-proxy-manager</a> <br/>

</p>

<p>
install the nextcloud community collection from the CrowdSec HUB with the command:
</p>
<pre class="code">cscli collections install crowdsecurity/nginx-proxy-manager</pre>

<p>
Then add the default path of your nextcloud.log file to the CrowdSec acquis.yaml config file:
</p>
<pre class="code">/etc/crowdsec/acquis.yaml</pre>
<pre class="code">---
filenames:
#  - ~/data/logs/*.log
# Dockerized NGINX PROXY MANAGER
  - /srv/NGINX/data/nginx-proxy-manager/logs/*.log
labels:
  type: nginx-proxy-manager</pre>

<p>
You must restart the CrowdSec service to enable the modifications with the command:
</p>
<pre class="code">service crowdsec restart</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Collections&quot;,&quot;hid&quot;:&quot;collections&quot;,&quot;codeblockOffset&quot;:42,&quot;secid&quot;:11,&quot;range&quot;:&quot;22709-24570&quot;} -->
<h2 class="sectionedit12" id="tweaks_good_to_know">Tweaks &amp; Good to know</h2>
<div class="level2">

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Tweaks &amp; Good to know&quot;,&quot;hid&quot;:&quot;tweaks_good_to_know&quot;,&quot;codeblockOffset&quot;:50,&quot;secid&quot;:12,&quot;range&quot;:&quot;24571-24605&quot;} -->
<h3 class="sectionedit13" id="version">version</h3>
<div class="level3">

<p>
Call version to check the binary version installed;
</p>
<pre class="code">cscli version</pre>
<pre class="code">2022/02/07 09:45:21 version: v1.3.0-openwrt-1.3.0-4
2022/02/07 09:45:21 Codename: alphaga
2022/02/07 09:45:21 BuildDate: 2022-02-06_20:54:43
2022/02/07 09:45:21 GoVersion: 1.17.6
2022/02/07 09:45:21 Constraint_parser: &gt;= 1.0, &lt;= 2.0
2022/02/07 09:45:21 Constraint_scenario: &gt;= 1.0, &lt; 3.0
2022/02/07 09:45:21 Constraint_api: v1
2022/02/07 09:45:21 Constraint_acquis: &gt;= 1.0, &lt; 2.0</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;version&quot;,&quot;hid&quot;:&quot;version&quot;,&quot;codeblockOffset&quot;:50,&quot;secid&quot;:13,&quot;range&quot;:&quot;24606-25099&quot;} -->
<h3 class="sectionedit14" id="metrics">metrics</h3>
<div class="level3">

<p>
Call metrics to check the health and status;
</p>
<pre class="code">cscli metrics</pre>

<p>
Sample output:
</p>
<pre class="code">INFO[07-02-2022 09:45:23 AM] Buckets Metrics:                             
+--------------------------------------+---------------+-----------+--------------+--------+---------+
|                BUCKET                | CURRENT COUNT | OVERFLOWS | INSTANCIATED | POURED | EXPIRED |
+--------------------------------------+---------------+-----------+--------------+--------+---------+
| crowdsecurity/http-bad-user-agent    | -             |         1 |            5 |      6 |       4 |
| crowdsecurity/http-crawl-non_statics | -             | -         |           24 |     47 |      24 |
| crowdsecurity/http-probing           | -             |         2 |           19 |     44 |      17 |
| crowdsecurity/http-sensitive-files   | -             | -         |            1 |      1 |       1 |
+--------------------------------------+---------------+-----------+--------------+--------+---------+
INFO[07-02-2022 09:45:23 AM] Acquisition Metrics:                         
+-----------------------------------------------------------------------+------------+--------------+----------------+------------------------+
|                                SOURCE                                 | LINES READ | LINES PARSED | LINES UNPARSED | LINES POURED TO BUCKET |
+-----------------------------------------------------------------------+------------+--------------+----------------+------------------------+
| file:/srv/NGINX/data/nginx-proxy-manager/logs/default-host_access.log |         39 |           37 |              2 |                     67 |
| file:/srv/NGINX/data/nginx-proxy-manager/logs/fallback_access.log     |         40 |           28 |             12 |                     31 |
| file:/srv/NGINX/data/nginx-proxy-manager/logs/proxy-host-1_access.log |          3 | -            |              3 | -                      |
| file:/srv/docker/volumes/nc_gnextcloud_data/_data/nextcloud.log       |       4390 | -            |           4390 | -                      |
+-----------------------------------------------------------------------+------------+--------------+----------------+------------------------+
INFO[07-02-2022 09:45:23 AM] Parser Metrics:                              
+----------------------------------------------+------+--------+----------+
|                   PARSERS                    | HITS | PARSED | UNPARSED |
+----------------------------------------------+------+--------+----------+
| child-crowdsecurity/http-logs                |  195 |    114 |       81 |
| child-crowdsecurity/nextcloud-logs           | 8780 | -      |     8780 |
| child-crowdsecurity/nginx-proxy-manager-logs |  153 |     65 |       88 |
| crowdsecurity/dateparse-enrich               |   65 |     65 | -        |
| crowdsecurity/geoip-enrich                   |   65 |     65 | -        |
| crowdsecurity/http-logs                      |   65 |     44 |       21 |
| crowdsecurity/nextcloud-logs                 | 4390 | -      |     4390 |
| crowdsecurity/nginx-proxy-manager-logs       |   82 |     65 |       17 |
| crowdsecurity/non-syslog                     | 4472 |   4472 | -        |
| crowdsecurity/whitelists                     |   65 |     65 | -        |
+----------------------------------------------+------+--------+----------+
INFO[07-02-2022 09:45:23 AM] Local Api Metrics:                           
+----------------------+--------+------+
|        ROUTE         | METHOD | HITS |
+----------------------+--------+------+
| /v1/alerts           | GET    |    1 |
| /v1/alerts           | POST   |    2 |
| /v1/decisions/stream | GET    | 4150 |
| /v1/watchers/login   | POST   |    5 |
+----------------------+--------+------+
INFO[07-02-2022 09:45:23 AM] Local Api Machines Metrics:                  
+----------+------------+--------+------+
| MACHINE  |   ROUTE    | METHOD | HITS |
+----------+------------+--------+------+
| STARGATE | /v1/alerts | POST   |    2 |
| STARGATE | /v1/alerts | GET    |    1 |
+----------+------------+--------+------+
INFO[07-02-2022 09:45:23 AM] Local Api Bouncers Metrics:                  
+---------------------------+----------------------+--------+------+
|          BOUNCER          |        ROUTE         | METHOD | HITS |
+---------------------------+----------------------+--------+------+
| crowdsec-firewall-bouncer | /v1/decisions/stream | GET    | 4150 |
+---------------------------+----------------------+--------+------+</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;metrics&quot;,&quot;hid&quot;:&quot;metrics&quot;,&quot;codeblockOffset&quot;:52,&quot;secid&quot;:14,&quot;range&quot;:&quot;25100-29636&quot;} -->
<h3 class="sectionedit15" id="alerts">Alerts</h3>
<div class="level3">

</div>

<h4 id="alerts_clean_all">Alerts Clean All</h4>
<div class="level4">

<p>
If needed, you can reset all blacklisted IPs with the following command:
</p>
<pre class="code">cscli alerts delete --all</pre>

</div>

<h4 id="alerts_history_list">Alerts history list</h4>
<div class="level4">

<p>
Alerts listing;
</p>
<pre class="code">cscli alerts list</pre>

<p>
Sample output:
</p>
<pre class="code">+----+-----------------------------------+-----------------------------------+---------+--------------------------------+-----------+--------------------------------+
| ID |               VALUE               |              REASON               | COUNTRY |               AS               | DECISIONS |           CREATED AT           |
+----+-----------------------------------+-----------------------------------+---------+--------------------------------+-----------+--------------------------------+
| 19 | crowdsecurity/community-blocklist | update : +8933/-0 IPs             |         |                                | ban:8933  | 2022-02-07 07:11:45 +0000 UTC  |
| 18 | crowdsecurity/community-blocklist | update : +8909/-0 IPs             |         |                                | ban:19    | 2022-02-07 05:11:45 +0000 UTC  |
| 17 | Ip:144.76.38.10                   | crowdsecurity/http-bad-user-agent | DE      | 24940 Hetzner Online GmbH      | ban:1     | 2022-02-07 03:17:55.4087026    |
|    |                                   |                                   |         |                                |           | +0000 UTC                      |
| 16 | crowdsecurity/community-blocklist | update : +8851/-0 IPs             |         |                                | ban:9     | 2022-02-07 03:11:45 +0000 UTC  |
| 15 | Ip:122.152.199.105                | crowdsecurity/http-probing        | CN      | 45090 Shenzhen Tencent         | ban:1     | 2022-02-07 01:21:12.57294468   |
|    |                                   |                                   |         | Computer Systems Company       |           | +0000 UTC                      |
|    |                                   |                                   |         | Limited                        |           |                                |
| 14 | crowdsecurity/community-blocklist | update : +8811/-0 IPs             |         |                                | ban:12    | 2022-02-07 01:11:45 +0000 UTC  |
| 13 | crowdsecurity/community-blocklist | update : +8758/-0 IPs             |         |                                | ban:9     | 2022-02-06 23:11:45 +0000 UTC  |
| 12 | crowdsecurity/community-blocklist | update : +8600/-0 IPs             |         |                                | ban:21    | 2022-02-06 19:52:17 +0000 UTC  |
| 11 | crowdsecurity/community-blocklist | update : +8427/-0 IPs             |         |                                | ban:42    | 2022-02-06 12:35:44 +0000 UTC  |
| 10 | crowdsecurity/community-blocklist | update : +8407/-0 IPs             |         |                                | ban:10    | 2022-02-06 10:35:43 +0000 UTC  |
|  9 | crowdsecurity/community-blocklist | update : +8379/-0 IPs             |         |                                | ban:12    | 2022-02-06 08:35:45 +0000 UTC  |
|  8 | crowdsecurity/community-blocklist | update : +8354/-0 IPs             |         |                                | ban:8     | 2022-02-06 06:35:44 +0000 UTC  |
|  7 | crowdsecurity/community-blocklist | update : +8327/-0 IPs             |         |                                | ban:6     | 2022-02-06 04:35:43 +0000 UTC  |
|  6 | crowdsecurity/community-blocklist | update : +8295/-0 IPs             |         |                                | ban:12    | 2022-02-06 02:35:43 +0000 UTC  |
|  5 | crowdsecurity/community-blocklist | update : +8275/-0 IPs             |         |                                | ban:7     | 2022-02-06 00:35:44 +0000 UTC  |
|  4 | crowdsecurity/community-blocklist | update : +8252/-0 IPs             |         |                                | ban:17    | 2022-02-05 22:35:47 +0000 UTC  |
|  3 | crowdsecurity/community-blocklist | update : +8206/-0 IPs             |         |                                | ban:7     | 2022-02-05 20:34:47 +0000 UTC  |
|  2 | crowdsecurity/community-blocklist | update : +8182/-0 IPs             |         |                                | ban:2     | 2022-02-05 19:01:14 +0000 UTC  |
|  1 | crowdsecurity/community-blocklist | update : +6488/-0 IPs             |         |                                | ban:9     | 2022-02-05 16:55:48 +0000 UTC  |
+----+-----------------------------------+-----------------------------------+---------+--------------------------------+-----------+--------------------------------+</pre>

</div>

<h4 id="alerts_inspect_item">Alerts inspect item</h4>
<div class="level4">
<pre class="code">cscli alerts inspect 15</pre>
<pre class="code">################################################################################################

 - ID         : 15
 - Date       : 2022-02-07T01:21:19Z
 - Machine    : STARGATE
 - Simulation : false
 - Reason     : crowdsecurity/http-probing
 - Events Count : 11
 - Scope:Value: Ip:122.152.199.105
 - Country    : CN
 - AS         : Shenzhen Tencent Computer Systems Company Limited
 - Begin      : 2022-02-07 01:21:12.57294468 +0000 UTC
 - End        : 2022-02-07 01:21:17.285319 +0000 UTC</pre>
<pre class="code">cscli alerts inspect 17</pre>
<pre class="code">################################################################################################

 - ID         : 17
 - Date       : 2022-02-07T03:18:02Z
 - Machine    : STARGATE
 - Simulation : false
 - Reason     : crowdsecurity/http-bad-user-agent
 - Events Count : 2
 - Scope:Value: Ip:144.76.38.10
 - Country    : DE
 - AS         : Hetzner Online GmbH
 - Begin      : 2022-02-07 03:17:55.4087026 +0000 UTC
 - End        : 2022-02-07 03:18:00.62557932 +0000 UTC</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Alerts&quot;,&quot;hid&quot;:&quot;alerts&quot;,&quot;codeblockOffset&quot;:54,&quot;secid&quot;:15,&quot;range&quot;:&quot;29637-35336&quot;} -->
<h3 class="sectionedit16" id="configs">Configs</h3>
<div class="level3">

</div>

<h4 id="show">show</h4>
<div class="level4">
<pre class="code">cscli config show</pre>

<p>
Sample output:
</p>
<pre class="code">Global:
   - Configuration Folder   : /etc/crowdsec
   - Data Folder            : /srv/crowdsec/data
   - Hub Folder             : /etc/crowdsec/hub
   - Simulation File        : /etc/crowdsec/simulation.yaml
   - Log Folder             : /var/log/
   - Log level              : info
   - Log Media              : file
Crowdsec:
  - Acquisition File        : /etc/crowdsec/acquis.yaml
  - Parsers routines        : 1
cscli:
  - Output                  : human
  - Hub Branch              : 
  - Hub Folder              : /etc/crowdsec/hub
Local API Server:
  - Listen URL              : 127.0.0.1:9999
  - Profile File            : /etc/crowdsec/profiles.yaml
  - Database:
      - Type                : sqlite
      - Path                : /srv/crowdsec/data/crowdsec.db
      - Flush age           : 7d
      - Flush size          : 5000</pre>

</div>

<h4 id="backup">backup</h4>
<div class="level4">
<pre class="code">cscli config backup /srv/crowdsec/backup/202202071120</pre>

<p>
Sample output:
</p>
<pre class="code">cscli config backup /srv/crowdsec/backup/202202071120
INFO[07-02-2022 11:17:37 AM] Starting configuration backup                
INFO[07-02-2022 11:17:37 AM] Saved simulation to /srv/crowdsec/backup/202202071120/simulation.yaml 
INFO[07-02-2022 11:17:37 AM] Saved default yaml to /srv/crowdsec/backup/202202071120/config.yaml 
INFO[07-02-2022 11:17:37 AM] Saved online API credentials to /srv/crowdsec/backup/202202071120/online_api_credentials.yaml 
INFO[07-02-2022 11:17:37 AM] Saved local API credentials to /srv/crowdsec/backup/202202071120/local_api_credentials.yaml 
INFO[07-02-2022 11:17:37 AM] Saved profiles to /srv/crowdsec/backup/202202071120/profiles.yaml 
INFO[07-02-2022 11:17:37 AM] saving, version:0.2, up-to-date:true          file=crowdsecurity/geoip-enrich type=parsers
INFO[07-02-2022 11:17:37 AM] saving, version:0.2, up-to-date:true          file=crowdsecurity/dateparse-enrich type=parsers
INFO[07-02-2022 11:17:37 AM] saving, version:0.1, up-to-date:true          file=crowdsecurity/nginx-proxy-manager-logs type=parsers
INFO[07-02-2022 11:17:37 AM] saving, version:0.8, up-to-date:true          file=crowdsecurity/syslog-logs type=parsers
INFO[07-02-2022 11:17:37 AM] saving, version:1.7, up-to-date:true          file=crowdsecurity/sshd-logs type=parsers
INFO[07-02-2022 11:17:37 AM] saving, version:0.7, up-to-date:true          file=crowdsecurity/http-logs type=parsers
INFO[07-02-2022 11:17:37 AM] saving, version:0.2, up-to-date:true          file=crowdsecurity/iptables-logs type=parsers
INFO[07-02-2022 11:17:37 AM] saving, version:0.2, up-to-date:true          file=crowdsecurity/whitelists type=parsers
INFO[07-02-2022 11:17:37 AM] saving, version:0.1, up-to-date:true          file=crowdsecurity/nextcloud-logs type=parsers
INFO[07-02-2022 11:17:37 AM] Wrote 9 entries for parsers to /srv/crowdsec/backup/202202071120/parsers//upstream-parsers.json  file=crowdsecurity/tcpdump-logs type=parsers
INFO[07-02-2022 11:17:37 AM] Wrote 0 entries for postoverflows to /srv/crowdsec/backup/202202071120/postoverflows//upstream-postoverflows.json  file=crowdsecurity/seo-bots-whitelist type=postoverflows
INFO[07-02-2022 11:17:37 AM] saving, version:0.1, up-to-date:true          file=crowdsecurity/iptables-scan-multi_ports type=scenarios
INFO[07-02-2022 11:17:37 AM] saving, version:0.4, up-to-date:true          file=crowdsecurity/http-bad-user-agent type=scenarios
INFO[07-02-2022 11:17:37 AM] saving, version:0.2, up-to-date:true          file=crowdsecurity/ssh-slow-bf type=scenarios
INFO[07-02-2022 11:17:37 AM] saving, version:0.2, up-to-date:true          file=crowdsecurity/http-backdoors-attempts type=scenarios
INFO[07-02-2022 11:17:37 AM] saving, version:0.2, up-to-date:true          file=crowdsecurity/http-open-proxy type=scenarios
INFO[07-02-2022 11:17:37 AM] saving, version:0.1, up-to-date:true          file=crowdsecurity/ssh-bf type=scenarios
INFO[07-02-2022 11:17:38 AM] saving, version:0.1, up-to-date:true          file=crowdsecurity/http-generic-bf type=scenarios
INFO[07-02-2022 11:17:38 AM] saving, version:0.2, up-to-date:true          file=crowdsecurity/http-sensitive-files type=scenarios
INFO[07-02-2022 11:17:38 AM] saving, version:0.1, up-to-date:true          file=crowdsecurity/nextcloud-bf type=scenarios
INFO[07-02-2022 11:17:38 AM] saving, version:0.1, up-to-date:true          file=ltsich/http-w00tw00t type=scenarios
INFO[07-02-2022 11:17:38 AM] saving, version:0.2, up-to-date:true          file=crowdsecurity/http-xss-probing type=scenarios
INFO[07-02-2022 11:17:38 AM] saving, version:0.2, up-to-date:true          file=crowdsecurity/http-probing type=scenarios
INFO[07-02-2022 11:17:38 AM] saving, version:0.2, up-to-date:true          file=crowdsecurity/http-path-traversal-probing type=scenarios
INFO[07-02-2022 11:17:38 AM] saving, version:0.2, up-to-date:true          file=crowdsecurity/http-sqli-probing type=scenarios
INFO[07-02-2022 11:17:38 AM] saving, version:0.2, up-to-date:true          file=crowdsecurity/http-crawl-non_statics type=scenarios
INFO[07-02-2022 11:17:38 AM] Wrote 15 entries for scenarios to /srv/crowdsec/backup/202202071120/scenarios//upstream-scenarios.json  file=crowdsecurity/thinkphp-cve-2018-20062 type=scenarios
INFO[07-02-2022 11:17:38 AM] saving, version:0.2, up-to-date:true          file=crowdsecurity/sshd type=collections
INFO[07-02-2022 11:17:38 AM] saving, version:0.1, up-to-date:true          file=crowdsecurity/nginx-proxy-manager type=collections
INFO[07-02-2022 11:17:38 AM] saving, version:0.1, up-to-date:true          file=crowdsecurity/iptables type=collections
INFO[07-02-2022 11:17:38 AM] saving, version:0.2, up-to-date:true          file=crowdsecurity/nextcloud type=collections
INFO[07-02-2022 11:17:38 AM] saving, version:0.5, up-to-date:true          file=crowdsecurity/base-http-scenarios type=collections
INFO[07-02-2022 11:17:38 AM] saving, version:0.2, up-to-date:true          file=crowdsecurity/linux type=collections
INFO[07-02-2022 11:17:38 AM] Wrote 6 entries for collections to /srv/crowdsec/backup/202202071120/collections//upstream-collections.json  file=crowdsecurity/wordpress type=collections</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Configs&quot;,&quot;hid&quot;:&quot;configs&quot;,&quot;codeblockOffset&quot;:61,&quot;secid&quot;:16,&quot;range&quot;:&quot;35337-41525&quot;} -->
<h2 class="sectionedit17" id="addons">AddOns</h2>
<div class="level2">

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;AddOns&quot;,&quot;hid&quot;:&quot;addons&quot;,&quot;codeblockOffset&quot;:65,&quot;secid&quot;:17,&quot;range&quot;:&quot;41526-41544&quot;} -->
<h3 class="sectionedit18" id="external_tools">External tools</h3>
<div class="level3">

</div>

<h4 id="cs_scriptssh">cs_scripts.sh</h4>
<div class="level4">

<p>
A new external script for CrowdSec specific actions was added in 
</p>
<pre class="code">/usr/lib/crowdsec/scripts/cs_script.sh</pre>

<p>
You can load it with:
&lt;/code&gt;
. /usr/lib/crowdsec/scripts/cs_script.sh 
&lt;/code&gt;
</p>

<p>
Then, internal function can be called like;
</p>
<pre class="code">cs_hub</pre>

<p>
sample output:
</p>
<pre class="code">INFO[07-02-2022 08:39:16 AM] Wrote new 277818 bytes index to /etc/crowdsec/hub/.index.json 
WARN[07-02-2022 08:39:17 AM] crowdsecurity/syslog-logs : overwrite        
WARN[07-02-2022 08:39:17 AM] crowdsecurity/geoip-enrich : overwrite       
WARN[07-02-2022 08:39:17 AM] crowdsecurity/dateparse-enrich : overwrite   
WARN[07-02-2022 08:39:17 AM] crowdsecurity/sshd-logs : overwrite          
WARN[07-02-2022 08:39:17 AM] crowdsecurity/ssh-bf : overwrite             
WARN[07-02-2022 08:39:17 AM] crowdsecurity/ssh-slow-bf : overwrite        
WARN[07-02-2022 08:39:17 AM] crowdsecurity/sshd : overwrite               
WARN[07-02-2022 08:39:17 AM] crowdsecurity/sshd : overwrite               
WARN[07-02-2022 08:39:18 AM] crowdsecurity/linux : overwrite              
INFO[07-02-2022 08:39:18 AM] /etc/crowdsec/collections/sshd.yaml already exists. 
INFO[07-02-2022 08:39:18 AM] /etc/crowdsec/collections/linux.yaml already exists. 
INFO[07-02-2022 08:39:18 AM] Enabled crowdsecurity/linux                  
INFO[07-02-2022 08:39:18 AM] Run &#039;sudo systemctl reload crowdsec&#039; for the new configuration to be effective. 
WARN[07-02-2022 08:39:18 AM] crowdsecurity/iptables-logs : overwrite      
WARN[07-02-2022 08:39:18 AM] crowdsecurity/iptables-scan-multi_ports : overwrite 
WARN[07-02-2022 08:39:18 AM] crowdsecurity/iptables : overwrite           
INFO[07-02-2022 08:39:18 AM] /etc/crowdsec/collections/iptables.yaml already exists. 
INFO[07-02-2022 08:39:18 AM] Enabled crowdsecurity/iptables               
INFO[07-02-2022 08:39:18 AM] Run &#039;sudo systemctl reload crowdsec&#039; for the new configuration to be effective. 
WARN[07-02-2022 08:39:19 AM] crowdsecurity/whitelists : overwrite         
INFO[07-02-2022 08:39:19 AM] Enabled crowdsecurity/whitelists             
INFO[07-02-2022 08:39:19 AM] Run &#039;sudo systemctl reload crowdsec&#039; for the new configuration to be effective. 
INFO[07-02-2022 08:39:20 AM] Upgrading collections                        
INFO[07-02-2022 08:39:20 AM] crowdsecurity/base-http-scenarios : up-to-date 
INFO[07-02-2022 08:39:20 AM] crowdsecurity/nginx-proxy-manager : up-to-date 
INFO[07-02-2022 08:39:20 AM] crowdsecurity/linux : up-to-date             
INFO[07-02-2022 08:39:20 AM] crowdsecurity/nextcloud : up-to-date         
INFO[07-02-2022 08:39:20 AM] crowdsecurity/iptables : up-to-date          
INFO[07-02-2022 08:39:20 AM] crowdsecurity/sshd : up-to-date              
INFO[07-02-2022 08:39:20 AM] All collections are already up-to-date       
INFO[07-02-2022 08:39:20 AM] Upgrading parsers                            
INFO[07-02-2022 08:39:20 AM] crowdsecurity/nextcloud-logs : up-to-date    
INFO[07-02-2022 08:39:20 AM] crowdsecurity/nginx-proxy-manager-logs : up-to-date 
INFO[07-02-2022 08:39:20 AM] crowdsecurity/http-logs : up-to-date         
INFO[07-02-2022 08:39:20 AM] crowdsecurity/iptables-logs : up-to-date     
INFO[07-02-2022 08:39:20 AM] crowdsecurity/geoip-enrich : up-to-date      
INFO[07-02-2022 08:39:20 AM] crowdsecurity/sshd-logs : up-to-date         
INFO[07-02-2022 08:39:20 AM] crowdsecurity/whitelists : up-to-date        
INFO[07-02-2022 08:39:20 AM] crowdsecurity/dateparse-enrich : up-to-date  
INFO[07-02-2022 08:39:20 AM] crowdsecurity/syslog-logs : up-to-date       
INFO[07-02-2022 08:39:20 AM] All parsers are already up-to-date           
INFO[07-02-2022 08:39:20 AM] Upgrading scenarios                          
INFO[07-02-2022 08:39:20 AM] crowdsecurity/http-open-proxy : up-to-date   
INFO[07-02-2022 08:39:20 AM] crowdsecurity/ssh-bf : up-to-date            
INFO[07-02-2022 08:39:20 AM] ltsich/http-w00tw00t : up-to-date            
INFO[07-02-2022 08:39:20 AM] crowdsecurity/nextcloud-bf : up-to-date      
INFO[07-02-2022 08:39:20 AM] crowdsecurity/http-xss-probing : up-to-date  
INFO[07-02-2022 08:39:20 AM] crowdsecurity/http-probing : up-to-date      
INFO[07-02-2022 08:39:20 AM] crowdsecurity/http-path-traversal-probing : up-to-date 
INFO[07-02-2022 08:39:20 AM] crowdsecurity/http-generic-bf : up-to-date   
INFO[07-02-2022 08:39:20 AM] crowdsecurity/http-sqli-probing : up-to-date 
INFO[07-02-2022 08:39:20 AM] crowdsecurity/iptables-scan-multi_ports : up-to-date 
INFO[07-02-2022 08:39:20 AM] crowdsecurity/http-bad-user-agent : up-to-date 
INFO[07-02-2022 08:39:20 AM] crowdsecurity/http-crawl-non_statics : up-to-date 
INFO[07-02-2022 08:39:20 AM] crowdsecurity/http-sensitive-files : up-to-date 
INFO[07-02-2022 08:39:20 AM] crowdsecurity/ssh-slow-bf : up-to-date       
INFO[07-02-2022 08:39:20 AM] crowdsecurity/http-backdoors-attempts : up-to-date 
INFO[07-02-2022 08:39:20 AM] All scenarios are already up-to-date         
INFO[07-02-2022 08:39:20 AM] Upgrading postoverflows                      
INFO[07-02-2022 08:39:20 AM] No postoverflows installed, nothing to upgrade </pre>

<p>
This tool will be extended for automating usability... <br/>

actually, it contains these functions: <br/>

</p>
<pre class="code">cs_prepare # to check the necessary directories...
cs_init # to prepare the config file with modified settings...
cs_register # to check the LAPI and CAPI registering status and register the local host...
cs_hub # to update hub, install collections from hub, and upgrade from hub...</pre>

</div>

<h4 id="web_console">Web Console</h4>
<div class="level4">

<p>
<em>TODO
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;External tools&quot;,&quot;hid&quot;:&quot;external_tools&quot;,&quot;codeblockOffset&quot;:65,&quot;secid&quot;:18,&quot;range&quot;:&quot;41545-&quot;} -->