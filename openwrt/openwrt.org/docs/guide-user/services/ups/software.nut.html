
<h1 class="sectionedit1" id="nut_network_ups_tools">NUT (Network UPS Tools)</h1>
<div class="level1">

<p>
The <a href="http://www.networkupstools.org/" class="urlextern" title="http://www.networkupstools.org/" rel="ugc nofollow">NUT</a> package can be useful if you have an UPS connected to the router. For example, you have multiple devices connected to the UPS (PC, NAS ...), but your router is the only device that runs 24/7 (or at least it runs most of the time). In this case you run NUT in <em class="u">netserver</em> mode, where other devices connect to router to see UPS status and be able to shut down correctly if power fails. NUT must be installed on every machine using this feature.
</p>

<p>
NUT can be installed from packages feed.
</p>

<p>
NUT was updated with more UCI in commit <a href="https://github.com/openwrt/packages/commit/a23c4e85c5f6c9f9dcf67743b93c492ba833e365" class="urlextern" title="https://github.com/openwrt/packages/commit/a23c4e85c5f6c9f9dcf67743b93c492ba833e365" rel="ugc nofollow">a23c4e85</a>, which appears in the 18.06 release.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;NUT (Network UPS Tools)&quot;,&quot;hid&quot;:&quot;nut_network_ups_tools&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:1,&quot;range&quot;:&quot;1-746&quot;} -->
<h2 class="sectionedit2" id="and_beyond">18.06 and beyond</h2>
<div class="level2">

<p>
<span style='color:#ed1c24; '>NOTE: configuration has <strong>changed</strong></span>:  It&#039;s now all done through UCI (see below) (and the UCI is changed).
</p>
<!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_start&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:3,&quot;range&quot;:&quot;0-&quot;} --><div class="wrap_center wrap_round wrap_tip plugin_wrap" style="width: 60%;">
<p>
If you wish to use a &#039;standard&#039; NUT config just remove the symlinks in /etc/nut and replace them with regular NUT configuration files.
</p>
</div><!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_end&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:4,&quot;range&quot;:&quot;0-&quot;} -->
</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;18.06 and beyond&quot;,&quot;hid&quot;:&quot;and_beyond&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:2,&quot;range&quot;:&quot;747-1079&quot;} -->
<h3 class="sectionedit5" id="commit_a23c4e85">18.06 / Commit a23c4e85</h3>
<div class="level3">
<!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_start&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:6,&quot;range&quot;:&quot;0-&quot;} --><div class="wrap_center wrap_round wrap_alert plugin_wrap" style="width: 60%;">
<p>
Due to changes in procd (or the OpenWrt shell wrapper around starting and stopping services with procd) stopping/restarting NUT stopped working properly.  Work is underway to remedy this.  Unfortunately issues were not reported before the 18.06 release.  18.06.1 has fixes for the most troublesome of the issues, and 18.06.2 should resolve the rest.
</p>

<p>
<a href="https://github.com/openwrt/packages/pull/7638" class="urlextern" title="https://github.com/openwrt/packages/pull/7638" rel="ugc nofollow">PR #7638</a> / <a href="https://github.com/openwrt/packages/commit/c95a1d3da89cb62eacc1d8217b861b36194d8838" class="urlextern" title="https://github.com/openwrt/packages/commit/c95a1d3da89cb62eacc1d8217b861b36194d8838" rel="ugc nofollow">Commmit c95a1d3</a> Resolves these issues in the 18.06 branch.
This should be in the next 18.06.x point release (18.06.2).
</p>

<p>
See <del><a href="https://github.com/openwrt/packages/pull/6897" class="urlextern" title="https://github.com/openwrt/packages/pull/6897" rel="ugc nofollow">PR #6987</a>, <a href="https://github.com/openwrt/packages/issues/6997" class="urlextern" title="https://github.com/openwrt/packages/issues/6997" rel="ugc nofollow">Issue #6997</a>, <a href="https://github.com/openwrt/packages/issues/6966" class="urlextern" title="https://github.com/openwrt/packages/issues/6966" rel="ugc nofollow">Issue #6966</a>, and <a href="https://github.com/openwrt/packages/issues/6843" class="urlextern" title="https://github.com/openwrt/packages/issues/6843" rel="ugc nofollow">Issue #6843</a></del>
</p>
</div><!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_end&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:7,&quot;range&quot;:&quot;0-&quot;} -->
</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;18.06 \/ Commit a23c4e85&quot;,&quot;hid&quot;:&quot;commit_a23c4e85&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:5,&quot;range&quot;:&quot;1080-2046&quot;} -->
<h3 class="sectionedit8" id="commit_f48b060_on_master">Commit f48b060 on master</h3>
<div class="level3">
<!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_start&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:9,&quot;range&quot;:&quot;0-&quot;} --><div class="wrap_center wrap_round wrap_important plugin_wrap" style="width: 60%;">
<p>
With <a href="https://github.com/openwrt/packages/commit/f48b060fa752fdf6556080dc1af221363f9b1ef4" class="urlextern" title="https://github.com/openwrt/packages/commit/f48b060fa752fdf6556080dc1af221363f9b1ef4" rel="ugc nofollow">Commit f48b060 on master</a> all known issues are resolved.
</p>
</div><!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_end&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:10,&quot;range&quot;:&quot;0-&quot;} --><!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_start&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:11,&quot;range&quot;:&quot;0-&quot;} --><div class="wrap_center wrap_round wrap_important plugin_wrap" style="width: 60%;">
<p>
<a href="https://github.com/openwrt/packages/pull/7167/commits/8ff6a83a541b114437eab170a0760c1c04263aa2" class="urlextern" title="https://github.com/openwrt/packages/pull/7167/commits/8ff6a83a541b114437eab170a0760c1c04263aa2" rel="ugc nofollow">Commit 8ff6a83</a> adds building of serial drivers by default.
</p>

<p>
<a href="https://github.com/openwrt/packages/pull/7167/commits/daa974cff0bef94c71277e703c32b3fd36f1411b" class="urlextern" title="https://github.com/openwrt/packages/pull/7167/commits/daa974cff0bef94c71277e703c32b3fd36f1411b" rel="ugc nofollow">Commit daa974c</a> completes the USB UPS hotplugging in which a USB UPS driver can be run as non-root and the USB device will be given the right permissions.
</p>

<p>
<a href="https://github.com/openwrt/packages/pull/7592/commits/a5d06ce1106644b26a1b9d0ad87220d772d6b862" class="urlextern" title="https://github.com/openwrt/packages/pull/7592/commits/a5d06ce1106644b26a1b9d0ad87220d772d6b862" rel="ugc nofollow">Commit a5d06ce</a> adds hotplug support for serial UPSes when using a standare serial-to-USB cable.
</p>
</div><!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_end&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:12,&quot;range&quot;:&quot;0-&quot;} -->
</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Commit f48b060 on master&quot;,&quot;hid&quot;:&quot;commit_f48b060_on_master&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:8,&quot;range&quot;:&quot;2047-2925&quot;} -->
<h3 class="sectionedit13" id="package_selection">Package Selection</h3>
<div class="level3">
<div class="table sectionedit14"><table class="inline">
	<thead>
	<tr class="row0">
		<th class="col0 leftalign"> Package                                 </th><th class="col1"> Purpose </th>
	</tr>
	</thead>
	<tr class="row1">
		<td class="col0"> nut </td><td class="col1"> Required to enable the &#039;real&#039; packages </td>
	</tr>
	<tr class="row2">
		<td class="col0"> nut-common </td><td class="col1"> Required for all NUT packages </td>
	</tr>
	<tr class="row3">
		<td class="col0"> nut-server </td><td class="col1"> NUT server or standalone; only for the host attached directly to the UPS.  Note will require a &#039;nut-dirver-xxx&#039; driver to actually connect to the UPS. </td>
	</tr>
	<tr class="row4">
		<td class="col0"> nut-upsmon </td><td class="col1 leftalign"> Monitoring and/or triggering shutdown (e.g. client mode; can be on a server too and is in fact recommended on all hosts).  </td>
	</tr>
	<tr class="row5">
		<td class="col0"> nut-upsc </td><td class="col1"> Command line client for querying UPS status </td>
	</tr>
	<tr class="row6">
		<td class="col0"> nut-upscmd </td><td class="col1"> Perform &#039;instant commands&#039; on UPS (e.g. remote shutdown) if supported by UPS </td>
	</tr>
	<tr class="row7">
		<td class="col0"> nut-upslog </td><td class="col1"> Read UPS log variables and write them to a file </td>
	</tr>
	<tr class="row8">
		<td class="col0"> nut-upsrw </td><td class="col1"> Set variables on UPS (e.g. buzzer status) if supported by UPS </td>
	</tr>
	<tr class="row9">
		<td class="col0"> nut-upssched </td><td class="col1"> Schedule script actions from some time after a UPS event </td>
	</tr>
	<tr class="row10">
		<td class="col0"> nut-upsmon-sendmail-notify </td><td class="col1"> Send an email via sendmail command on a UPS event.  In 18.06, added in commit <a href="https://github.com/openwrt/packages/commit/c94e334c4e5251d09995e3f6c8b80d61928a451c#diff-4ea671be370e4ab06ffeb50e1312d11e" class="urlextern" title="https://github.com/openwrt/packages/commit/c94e334c4e5251d09995e3f6c8b80d61928a451c#diff-4ea671be370e4ab06ffeb50e1312d11e" rel="ugc nofollow">c94e334c4</a> </td>
	</tr>
	<tr class="row11">
		<td class="col0"> nut-web-cgi </td><td class="col1"> A &#039;web&#039; (e.g. uhttpd) <abbr title="Graphical User Interface">GUI</abbr> for monitoring the UPS </td>
	</tr>
	<tr class="row12">
		<td class="col0"> nut-avahi-service </td><td class="col1"> Advertise the UPS server via mDNS (avahi-daemon only) </td>
	</tr>
	<tr class="row13">
		<td class="col0"> nut-driver-xxx </td><td class="col1"> Where xxx is a driver from the list below </td>
	</tr>
</table></div>
<!-- EDIT{&quot;target&quot;:&quot;table&quot;,&quot;name&quot;:&quot;&quot;,&quot;hid&quot;:&quot;table&quot;,&quot;secid&quot;:14,&quot;range&quot;:&quot;2955-4239&quot;} -->
</div>

<h4 id="ups_drivers">UPS Drivers</h4>
<div class="level4">
<!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_start&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:15,&quot;range&quot;:&quot;0-&quot;} --><div class="wrap_center wrap_round wrap_tip plugin_wrap" style="width: 60%;">
<p>
See <a href="https://networkupstools.org/stable-hcl.html" class="urlextern" title="https://networkupstools.org/stable-hcl.html" rel="ugc nofollow">NUT Stable Hardware Compatibility List</a> to match your UPS model to a driver.
</p>
</div><!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_end&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:16,&quot;range&quot;:&quot;0-&quot;} -->
</div>

<h5 id="serial">Serial</h5>
<div class="level5">
<!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_start&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:17,&quot;range&quot;:&quot;0-&quot;} --><div class="group plugin_wrap"><!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_start&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:19,&quot;range&quot;:&quot;0-&quot;} --><div class="wrap_half wrap_column plugin_wrap"><!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_start&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:21,&quot;range&quot;:&quot;0-&quot;} --><div class="group plugin_wrap"><!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_start&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:23,&quot;range&quot;:&quot;0-&quot;} --><div class="wrap_half wrap_column plugin_wrap"><ul>
<li class="level1"><div class="li"> al175 </div>
</li>
<li class="level1"><div class="li"> bcmxcp </div>
</li>
<li class="level1"><div class="li"> belkin </div>
</li>
<li class="level1"><div class="li"> belkinunv </div>
</li>
<li class="level1"><div class="li"> bestfcom </div>
</li>
<li class="level1"><div class="li"> bestfortress </div>
</li>
<li class="level1"><div class="li"> bestuferrups </div>
</li>
<li class="level1"><div class="li"> bestups </div>
</li>
<li class="level1"><div class="li"> dummy-ups </div>
</li>
<li class="level1"><div class="li"> etapro </div>
</li>
<li class="level1"><div class="li"> everups</div>
</li>
<li class="level1"><div class="li"> gamatronic </div>
</li>
<li class="level1"><div class="li"> genericups </div>
</li>
<li class="level1"><div class="li"> isbmex </div>
</li>
<li class="level1"><div class="li"> liebert </div>
</li>
<li class="level1"><div class="li"> liebert-esp2 </div>
</li>
<li class="level1"><div class="li"> masterguard </div>
</li>
<li class="level1"><div class="li"> metasys </div>
</li>
<li class="level1"><div class="li"> oldm </div>
</li>
<li class="level1"><div class="li"> e-shut </div>
</li>
<li class="level1"><div class="li"> mge-utalk </div>
</li>
</ul>
</div><!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_end&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:24,&quot;range&quot;:&quot;0-&quot;} --><!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_start&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:25,&quot;range&quot;:&quot;0-&quot;} --><div class="wrap_half wrap_column plugin_wrap"><ul>
<li class="level1"><div class="li"> microdowell </div>
</li>
<li class="level1"><div class="li"> mge-shut </div>
</li>
<li class="level1"><div class="li"> oneac </div>
</li>
<li class="level1"><div class="li"> optiups </div>
</li>
<li class="level1"><div class="li"> powercom </div>
</li>
<li class="level1"><div class="li"> rhino</div>
</li>
<li class="level1"><div class="li"> safenet </div>
</li>
<li class="level1"><div class="li"> solis </div>
</li>
<li class="level1"><div class="li"> tripplite </div>
</li>
<li class="level1"><div class="li"> tripplitesu </div>
</li>
<li class="level1"><div class="li"> upscode2 </div>
</li>
<li class="level1"><div class="li"> victronups </div>
</li>
<li class="level1"><div class="li"> powerpanel </div>
</li>
<li class="level1"><div class="li"> blazer_ser </div>
</li>
<li class="level1"><div class="li"> clone </div>
</li>
<li class="level1"><div class="li"> ivtscd </div>
</li>
<li class="level1"><div class="li"> apcsmart </div>
</li>
<li class="level1"><div class="li"> apcsmart-old </div>
</li>
<li class="level1"><div class="li"> apcupsd-ups </div>
</li>
<li class="level1"><div class="li"> riello_ser</div>
</li>
</ul>
</div><!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_end&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:26,&quot;range&quot;:&quot;0-&quot;} --></div><!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_end&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:22,&quot;range&quot;:&quot;0-&quot;} --></div><!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_end&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:20,&quot;range&quot;:&quot;0-&quot;} --><!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_start&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:27,&quot;range&quot;:&quot;0-&quot;} --><div class="wrap_half wrap_column plugin_wrap">
<h5 id="snmp">SNMP</h5>
<ul>
<li class="level1"><div class="li"> snmp-ups</div>
</li>
</ul>

<h5 id="usb">USB</h5>
<ul>
<li class="level1"><div class="li"> usbhid-ups </div>
</li>
<li class="level1"><div class="li"> bcmxcp_usb </div>
</li>
<li class="level1"><div class="li"> tripplite_usb </div>
</li>
<li class="level1"><div class="li"> blazer_usb </div>
</li>
<li class="level1"><div class="li"> richcomm_usb </div>
</li>
<li class="level1"><div class="li"> riello_usb </div>
</li>
<li class="level1"><div class="li"> nutdrv_atcl_</div>
</li>
<li class="level1"><div class="li"> usb nutdrv_qx</div>
</li>
</ul>
</div><!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_end&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:28,&quot;range&quot;:&quot;0-&quot;} --></div><!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_end&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:18,&quot;range&quot;:&quot;0-&quot;} -->
</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Package Selection&quot;,&quot;hid&quot;:&quot;package_selection&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:13,&quot;range&quot;:&quot;2926-5347&quot;} -->
<h2 class="sectionedit29" id="luci_app">LuCI app</h2>
<div class="level2">

<p>
There was a Pull Request (<a href="https://github.com/openwrt/luci/pull/936" class="urlextern" title="https://github.com/openwrt/luci/pull/936" rel="ugc nofollow">#936</a>) for a LuCI app for the new configuration that sadly never made into 18.06, for complicated reasons that are non-technical, but is merged in a modified form into master.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;LuCI app&quot;,&quot;hid&quot;:&quot;luci_app&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:29,&quot;range&quot;:&quot;5348-5616&quot;} -->
<h2 class="sectionedit30" id="x_uci_files">18.06.x+ UCI files</h2>
<div class="level2">
<div class="table sectionedit31"><table class="inline">
	<thead>
	<tr class="row0">
		<th class="col0 leftalign"> File                                                        </th><th class="col1 leftalign"> Purpose                 </th>
	</tr>
	</thead>
	<tr class="row1">
		<td class="col0 leftalign"> <a href="/docs/guide-user/services/ups/software.nut#nut_cgi" class="wikilink1" title="docs:guide-user:services:ups:software.nut" data-wiki-id="docs:guide-user:services:ups:software.nut">nut_cgi</a>       </td><td class="col1 leftalign"> configure nut-cgi       </td>
	</tr>
	<tr class="row2">
		<td class="col0 leftalign"> <a href="/docs/guide-user/services/ups/software.nut#nut_monitor" class="wikilink1" title="docs:guide-user:services:ups:software.nut" data-wiki-id="docs:guide-user:services:ups:software.nut">nut_monitor</a>   </td><td class="col1 leftalign"> configure nut-monitor   </td>
	</tr>
	<tr class="row3">
		<td class="col0 leftalign"> <a href="/docs/guide-user/services/ups/software.nut#nut_server" class="wikilink1" title="docs:guide-user:services:ups:software.nut" data-wiki-id="docs:guide-user:services:ups:software.nut">nut_server</a>    </td><td class="col1 leftalign"> configure nut-server    </td>
	</tr>
</table></div>
<!-- EDIT{&quot;target&quot;:&quot;table&quot;,&quot;name&quot;:&quot;&quot;,&quot;hid&quot;:&quot;table1&quot;,&quot;secid&quot;:31,&quot;range&quot;:&quot;5649-6008&quot;} -->
</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;18.06.x+ UCI files&quot;,&quot;hid&quot;:&quot;x_uci_files&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:30,&quot;range&quot;:&quot;5617-6009&quot;} -->
<h2 class="sectionedit32" id="uci_configuration_1806x">UCI Configuration (18.06.x+)</h2>
<div class="level2">

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;UCI Configuration (18.06.x+)&quot;,&quot;hid&quot;:&quot;uci_configuration_1806x&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:32,&quot;range&quot;:&quot;6010-6051&quot;} -->
<h3 class="sectionedit33" id="nut_server">nut_server</h3>
<div class="level3">

<p>
There can be more than one of each section (as appropriate)
</p>

</div>

<h4 id="config_driver_global">config driver_global</h4>
<div class="level4">
<!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_start&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:34,&quot;range&quot;:&quot;0-&quot;} --><div class="wrap_center wrap_round wrap_important plugin_wrap" style="width: 60%;">
<p>
<a href="https://github.com/openwrt/packages/commit/44e57d4bdfe93214e9c031f181533bb0e4ef25ca" class="urlextern" title="https://github.com/openwrt/packages/commit/44e57d4bdfe93214e9c031f181533bb0e4ef25ca" rel="ugc nofollow">Commit 44e57d4</a> (adds the following variables) and <a href="https://github.com/openwrt/packages/commit/f48b060fa752fdf6556080dc1af221363f9b1ef4" class="urlextern" title="https://github.com/openwrt/packages/commit/f48b060fa752fdf6556080dc1af221363f9b1ef4" rel="ugc nofollow"> Commit f48b060</a> (fixes synchronous setting)
</p>
</div><!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_end&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:35,&quot;range&quot;:&quot;0-&quot;} --><div class="table sectionedit36"><table class="inline">
	<thead>
	<tr class="row0">
		<th class="col0 leftalign"> Option           </th><th class="col1 leftalign"> Type           </th><th class="col2"> Required </th><th class="col3 leftalign"> Default      </th><th class="col4 leftalign"> Description    </th>
	</tr>
	</thead>
	<tr class="row1">
		<th class="col0 leftalign"> chroot             </th><td class="col1 leftalign"> string         </td><td class="col2 leftalign"> no       </td><td class="col3 leftalign"> <em>none</em>     </td><td class="col4"> chroot directory </td>
	</tr>
	<tr class="row2">
		<th class="col0 leftalign"> driverpath         </th><td class="col1 leftalign"> string         </td><td class="col2 leftalign"> no       </td><td class="col3 leftalign"> /lib/nut     </td><td class="col4"> Where to search for drivers </td>
	</tr>
	<tr class="row3">
		<th class="col0 leftalign"> maxstartdelay      </th><td class="col1 leftalign"> integer        </td><td class="col2 leftalign"> no       </td><td class="col3 leftalign"> <em>none</em>     </td><td class="col4"> Override default for UPSes not specifying this field </td>
	</tr>
	<tr class="row4">
		<th class="col0 leftalign"> maxretry           </th><td class="col1 leftalign"> integer        </td><td class="col2 leftalign"> no       </td><td class="col3 centeralign">   1          </td><td class="col4"> Number of time to retry loading driver (apart from procd&#039;s respawn) initially </td>
	</tr>
	<tr class="row5">
		<th class="col0 leftalign"> retrydelay         </th><td class="col1 leftalign"> integer        </td><td class="col2 leftalign"> no       </td><td class="col3 centeralign">   5          </td><td class="col4"> Number of seconds between retries </td>
	</tr>
	<tr class="row6">
		<th class="col0 leftalign"> pollinterval       </th><td class="col1 leftalign"> integer        </td><td class="col2 leftalign"> no       </td><td class="col3 centeralign">   2          </td><td class="col4"> Maximum number of seconds between UPS status refresh </td>
	</tr>
	<tr class="row7">
		<th class="col0 leftalign"> synchronous        </th><td class="col1"> boolean string </td><td class="col2 leftalign"> no       </td><td class="col3 centeralign">   no         </td><td class="col4"> Whether reading from UPS has to empty pipe before more data written </td>
	</tr>
	<tr class="row8">
		<th class="col0 leftalign"> user               </th><td class="col1 leftalign"> string         </td><td class="col2 leftalign"> no       </td><td class="col3 centeralign">   nut        </td><td class="col4"> If run as root, user to which to drop privileges </td>
	</tr>
</table></div>
<!-- EDIT{&quot;target&quot;:&quot;table&quot;,&quot;name&quot;:&quot;&quot;,&quot;hid&quot;:&quot;table2&quot;,&quot;secid&quot;:36,&quot;range&quot;:&quot;6478-7482&quot;} -->
</div>

<h4 id="config_driver_upsname">config driver &#039;upsname&#039;</h4>
<div class="level4">

<p>
<strong>NB</strong>: From 18.06
</p>

<p>
The config section name (e.g. &#039;upsname&#039; above) will be used a the ups name.
</p>
<div class="table sectionedit37"><table class="inline">
	<thead>
	<tr class="row0">
		<th class="col0 leftalign"> Option           </th><th class="col1 leftalign"> Type           </th><th class="col2"> Required </th><th class="col3 leftalign"> Default      </th><th class="col4 leftalign"> Description    </th>
	</tr>
	</thead>
	<tr class="row1">
		<th class="col0 leftalign"> driver           </th><td class="col1 leftalign"> string         </td><td class="col2 leftalign"> yes       </td><td class="col3 leftalign"> <em>none</em>   </td><td class="col4"> Driver for the model of UPS (see list above and <a href="https://networkupstools.org/stable-hcl.html" class="urlextern" title="https://networkupstools.org/stable-hcl.html" rel="ugc nofollow">NUT HCL for stable release</a>) </td>
	</tr>
	<tr class="row2">
		<th class="col0 leftalign"> port             </th><td class="col1 leftalign"> string         </td><td class="col2 leftalign"> yes       </td><td class="col3"> ? (shouldn&#039;t rely on anyway) </td><td class="col4"> Port on which the UPS is attached (or auto for auto-detection with USB) </td>
	</tr>
	<tr class="row3">
		<th class="col0 leftalign"> other            </th><td class="col1 leftalign"> string         </td><td class="col2 leftalign"> varies    </td><td class="col3 leftalign"> <em>none</em>   </td><td class="col4"> see HCL above </td>
	</tr>
	<tr class="row4">
		<th class="col0 leftalign"> runas            </th><td class="col1 leftalign"> string         </td><td class="col2 leftalign"> no        </td><td class="col3 leftalign"> <em>none</em>   </td><td class="col4"> User as which to run the daemon (note that means the USB device has in /dev/bus/usb/xxxx has to be <em>writable</em> by this user) </td>
	</tr>
</table></div>
<!-- EDIT{&quot;target&quot;:&quot;table&quot;,&quot;name&quot;:&quot;&quot;,&quot;hid&quot;:&quot;table3&quot;,&quot;secid&quot;:37,&quot;range&quot;:&quot;7614-8308&quot;} --><!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_start&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:38,&quot;range&quot;:&quot;0-&quot;} --><div class="wrap_center wrap_round wrap_important plugin_wrap" style="width: 60%;">
<p>
As of <a href="https://github.com/openwrt/packages/commit/ceff68837d4b8d5a9bd8bf1962e913b5203d95e5" class="urlextern" title="https://github.com/openwrt/packages/commit/ceff68837d4b8d5a9bd8bf1962e913b5203d95e5" rel="ugc nofollow">ceff6883</a> adding random parameters was removed and only pre-defined parameters are allowed.
</p>
</div><!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_end&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:39,&quot;range&quot;:&quot;0-&quot;} --><div class="table sectionedit40"><table class="inline">
	<thead>
	<tr class="row0">
		<th class="col0 leftalign"> Option           </th><th class="col1 leftalign"> Type           </th><th class="col2"> Required </th><th class="col3 leftalign"> Default      </th><th class="col4 leftalign"> Description    </th>
	</tr>
	</thead>
	<tr class="row1">
		<th class="col0 leftalign"> mfr              </th><td class="col1 leftalign"> string         </td><td class="col2 leftalign"> no       </td><td class="col3 leftalign"> <em>none</em>     </td><td class="col4"> Manufacturer description string </td>
	</tr>
	<tr class="row2">
		<th class="col0 leftalign"> model            </th><td class="col1 leftalign"> string         </td><td class="col2 leftalign"> no       </td><td class="col3 leftalign"> <em>none</em>     </td><td class="col4"> Model description string </td>
	</tr>
	<tr class="row3">
		<th class="col0 leftalign"> serial           </th><td class="col1 leftalign"> string         </td><td class="col2 leftalign"> no       </td><td class="col3 leftalign"> <em>none</em>     </td><td class="col4"> Serial number description string or regex match for serial number (depends on driver) </td>
	</tr>
	<tr class="row4">
		<th class="col0 leftalign"> sdtime           </th><td class="col1 leftalign"> integer        </td><td class="col2 leftalign"> no       </td><td class="col3 leftalign"> <em>none</em>     </td><td class="col4"> Number of seconds for driver to sleep after sending shutdown signal </td>
	</tr>
	<tr class="row5">
		<th class="col0 leftalign"> offdelay         </th><td class="col1 leftalign"> integer        </td><td class="col2 leftalign"> no       </td><td class="col3 leftalign"> 20           </td><td class="col4"> Number of seconds UPS will wait before shutting down after receiving shutdown signal </td>
	</tr>
	<tr class="row6">
		<th class="col0 leftalign"> ondelay          </th><td class="col1 leftalign"> integer        </td><td class="col2 leftalign"> no       </td><td class="col3 leftalign"> 30           </td><td class="col4"> Number of seconds UPS will wait before powering up if still on mains after shutdown (must be less than ondelay) </td>
	</tr>
	<tr class="row7">
		<th class="col0 leftalign"> pollfreq         </th><td class="col1 leftalign"> integer        </td><td class="col2 leftalign"> no       </td><td class="col3 leftalign"> 30           </td><td class="col4"> How often driver will poll UPS for data </td>
	</tr>
	<tr class="row8">
		<th class="col0 leftalign"> vendor           </th><td class="col1 leftalign"> string         </td><td class="col2 leftalign"> no       </td><td class="col3 leftalign"> <em>none</em>     </td><td class="col4"> regex to match USB vendor string </td>
	</tr>
	<tr class="row9">
		<th class="col0 leftalign"> product          </th><td class="col1 leftalign"> string         </td><td class="col2 leftalign"> no       </td><td class="col3 leftalign"> <em>none</em>     </td><td class="col4"> regex to match USB product string </td>
	</tr>
	<tr class="row10">
		<th class="col0 leftalign"> bus              </th><td class="col1 leftalign"> string         </td><td class="col2 leftalign"> no       </td><td class="col3 leftalign"> <em>none</em>     </td><td class="col4"> regex to match a specific USB bus or group of busses </td>
	</tr>
	<tr class="row11">
		<th class="col0 leftalign"> interruptonly    </th><td class="col1 leftalign"> boolean        </td><td class="col2 leftalign"> no       </td><td class="col3 leftalign"> false        </td><td class="col4"> flag to driver to do no polling, only get data by interrupts (push) from UPS </td>
	</tr>
	<tr class="row12">
		<th class="col0 leftalign"> interruptsize    </th><td class="col1 leftalign"> integer        </td><td class="col2 leftalign"> no       </td><td class="col3 leftalign"> <em>none</em>     </td><td class="col4"> limit interrupt data to given number of bytes; e.g. for some PowerCom units </td>
	</tr>
	<tr class="row13">
		<th class="col0 leftalign"> maxreport        </th><td class="col1 leftalign"> boolean        </td><td class="col2 leftalign"> no       </td><td class="col3 leftalign"> false        </td><td class="col4"> With this option, the driver activates a tweak to workaround buggy firmware returning invalid HID report length. Some APC Back-UPS units are known to have this bug. </td>
	</tr>
	<tr class="row14">
		<th class="col0 leftalign"> vendorid         </th><td class="col1 leftalign"> string         </td><td class="col2 leftalign"> no       </td><td class="col3 leftalign"> <em>none</em>     </td><td class="col4"> regex: Match only UPSes with this USB vendorid </td>
	</tr>
	<tr class="row15">
		<th class="col0 leftalign"> productid        </th><td class="col1 leftalign"> string         </td><td class="col2 leftalign"> no       </td><td class="col3 leftalign"> <em>none</em>     </td><td class="col4"> regex: Match only UPSes with this USB productid </td>
	</tr>
	<tr class="row16">
		<th class="col0 leftalign"> community        </th><td class="col1 leftalign"> string         </td><td class="col2 leftalign"> no       </td><td class="col3 leftalign"> public       </td><td class="col4"> For snmp-ups: community to poll UPS </td>
	</tr>
	<tr class="row17">
		<th class="col0 leftalign"> snmp_version     </th><td class="col1"> v1, v2c, or v3 </td><td class="col2 leftalign"> no       </td><td class="col3 centeralign">   v1         </td><td class="col4"> For snmp-ups: SNMP version </td>
	</tr>
	<tr class="row18">
		<th class="col0 leftalign"> snmp_retries     </th><td class="col1 leftalign"> integer        </td><td class="col2 leftalign"> no       </td><td class="col3 centeralign">    5         </td><td class="col4"> Number of Net-SNMP tries </td>
	</tr>
	<tr class="row19">
		<th class="col0 leftalign"> snmp_timeout     </th><td class="col1 leftalign"> integer        </td><td class="col2 leftalign"> no       </td><td class="col3 centeralign">    1         </td><td class="col4"> Number of seconds between Net-SNMP retries </td>
	</tr>
	<tr class="row20">
		<th class="col0 leftalign"> notransferoids   </th><td class="col1 leftalign"> boolean        </td><td class="col2 leftalign"> no       </td><td class="col3 leftalign"> false        </td><td class="col4"> Disable the monitoring of the low and high voltage transfer OIDs in the hardware. This will remove input.transfer.low and input.transfer.high from the list of variables. This should only be used on APCC Symmetra equipment which has strangeness in the three-phase power reporting. </td>
	</tr>
</table></div>
<!-- EDIT{&quot;target&quot;:&quot;table&quot;,&quot;name&quot;:&quot;&quot;,&quot;hid&quot;:&quot;table4&quot;,&quot;secid&quot;:40,&quot;range&quot;:&quot;8538-11330&quot;} --><!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_start&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:41,&quot;range&quot;:&quot;0-&quot;} --><div class="wrap_center wrap_round wrap_important plugin_wrap" style="width: 60%;">
<p>
<a href="https://github.com/openwrt/packages/commit/44e57d4bdfe93214e9c031f181533bb0e4ef25ca" class="urlextern" title="https://github.com/openwrt/packages/commit/44e57d4bdfe93214e9c031f181533bb0e4ef25ca" rel="ugc nofollow">Commit 44e57d4</a> (adds the following variables)
</p>
</div><!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_end&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:42,&quot;range&quot;:&quot;0-&quot;} --><div class="table sectionedit43"><table class="inline">
	<thead>
	<tr class="row0">
		<th class="col0 leftalign"> Option           </th><th class="col1 leftalign"> Type            </th><th class="col2 leftalign"> Required                </th><th class="col3 leftalign"> Default      </th><th class="col4 leftalign"> Description    </th>
	</tr>
	</thead>
	<tr class="row1">
		<th class="col0 leftalign"> synchronous      </th><td class="col1 leftalign"> yes or no       </td><td class="col2 leftalign"> no                      </td><td class="col3 centeralign">    no        </td><td class="col4"> Whether UPS must read all data from UPS before getting new data </td>
	</tr>
	<tr class="row2">
		<th class="col0 leftalign"> maxstartdelay    </th><td class="col1 leftalign"> integer         </td><td class="col2 leftalign"> no                      </td><td class="col3 centeralign">    45        </td><td class="col4"> How long NUT waits for driver to start before giving up </td>
	</tr>
	<tr class="row3">
		<th class="col0 leftalign"> retrydelay       </th><td class="col1 leftalign"> integer         </td><td class="col2 leftalign"> no                      </td><td class="col3 centeralign">     5        </td><td class="col4"> How long NUT waits to retry starting driver </td>
	</tr>
	<tr class="row4">
		<th class="col0 leftalign"> override         </th><td class="col1"> list of strings </td><td class="col2 leftalign"> no                      </td><td class="col3 leftalign"> <em>none</em>     </td><td class="col4"> names of &#039;override&#039; config sections (below) </td>
	</tr>
	<tr class="row5">
		<th class="col0 leftalign"> default          </th><td class="col1"> list of strings </td><td class="col2 leftalign"> no                      </td><td class="col3 leftalign"> <em>none</em>     </td><td class="col4"> names of &#039;default&#039; config sections (below) </td>
	</tr>
	<tr class="row6">
		<th class="col0 leftalign"> other            </th><td class="col1"> list of strings </td><td class="col2 leftalign"> no                      </td><td class="col3 leftalign"> <em>none</em>     </td><td class="col4"> names of &#039;other&#039; config sections (below) </td>
	</tr>
	<tr class="row7">
		<th class="col0 leftalign"> otherflags       </th><td class="col1"> list of strings </td><td class="col2 leftalign"> no                      </td><td class="col3 leftalign"> <em>none</em>     </td><td class="col4"> names of &#039;otherflag&#039; config sections (below) </td>
	</tr>
</table></div>
<!-- EDIT{&quot;target&quot;:&quot;table&quot;,&quot;name&quot;:&quot;&quot;,&quot;hid&quot;:&quot;table5&quot;,&quot;secid&quot;:43,&quot;range&quot;:&quot;11510-12517&quot;} -->
<p>
config override &#039;override_[variable_name]&#039;
</p>

<p>
e.g. <code>config override &#039;override_battery_charge_low</code>&#039; creates ups.conf entry for <code>override.battery.charge.low = </code>
</p>
<div class="table sectionedit44"><table class="inline">
	<thead>
	<tr class="row0">
		<th class="col0 leftalign"> Option           </th><th class="col1 leftalign"> Type           </th><th class="col2 leftalign"> Required                </th><th class="col3 leftalign"> Default       </th><th class="col4 leftalign"> Description    </th>
	</tr>
	</thead>
	<tr class="row1">
		<th class="col0 leftalign"> value            </th><td class="col1 leftalign"> varies         </td><td class="col2 leftalign"> yes                     </td><td class="col3 leftalign"> <em>none</em>      </td><td class="col4"> Value driver &#039;pretends&#039; UPS sent </td>
	</tr>
</table></div>
<!-- EDIT{&quot;target&quot;:&quot;table&quot;,&quot;name&quot;:&quot;&quot;,&quot;hid&quot;:&quot;table6&quot;,&quot;secid&quot;:44,&quot;range&quot;:&quot;12681-12892&quot;} -->
<p>
config default &#039;default_[variable_name]&#039;
</p>

<p>
e.g. <code>config default &#039;default_battery_charge_low</code>&#039; creates ups.conf entry for <code>default.battery.charge.low = </code>
</p>
<div class="table sectionedit45"><table class="inline">
	<thead>
	<tr class="row0">
		<th class="col0 leftalign"> Option           </th><th class="col1 leftalign"> Type           </th><th class="col2 leftalign"> Required                </th><th class="col3 leftalign"> Default       </th><th class="col4 leftalign"> Description    </th>
	</tr>
	</thead>
	<tr class="row1">
		<th class="col0 leftalign"> value            </th><td class="col1 leftalign"> varies         </td><td class="col2 leftalign"> yes                     </td><td class="col3 leftalign"> <em>none</em>      </td><td class="col4"> Value driver &#039;pretends&#039; UPS sent unless UPS actually sends a value </td>
	</tr>
</table></div>
<!-- EDIT{&quot;target&quot;:&quot;table&quot;,&quot;name&quot;:&quot;&quot;,&quot;hid&quot;:&quot;table7&quot;,&quot;secid&quot;:45,&quot;range&quot;:&quot;13050-13295&quot;} -->
<p>
config override &#039;other_[parameter]&#039;
</p>

<p>
e.g. <code>config other &#039;other_parameter</code>&#039; creates ups.conf entry for <code>parameter = </code>
</p>
<div class="table sectionedit46"><table class="inline">
	<thead>
	<tr class="row0">
		<th class="col0 leftalign"> Option           </th><th class="col1 leftalign"> Type           </th><th class="col2 leftalign"> Required                </th><th class="col3 leftalign"> Default       </th><th class="col4 leftalign"> Description    </th>
	</tr>
	</thead>
	<tr class="row1">
		<th class="col0 leftalign"> value            </th><td class="col1 leftalign"> varies         </td><td class="col2 leftalign"> yes                     </td><td class="col3 leftalign"> <em>none</em>      </td><td class="col4"> A way to handle currently unknown (to UCI) parameters </td>
	</tr>
</table></div>
<!-- EDIT{&quot;target&quot;:&quot;table&quot;,&quot;name&quot;:&quot;&quot;,&quot;hid&quot;:&quot;table8&quot;,&quot;secid&quot;:46,&quot;range&quot;:&quot;13419-13651&quot;} -->
<p>
config override &#039;otherflag_[parameter]&#039;
</p>

<p>
e.g. <code>config override &#039;otherflag_extraflag</code>&#039; creates ups.conf entry for <code>extraflag</code>
</p>
<div class="table sectionedit47"><table class="inline">
	<thead>
	<tr class="row0">
		<th class="col0 leftalign"> Option           </th><th class="col1 leftalign"> Type           </th><th class="col2 leftalign"> Required                </th><th class="col3 leftalign"> Default       </th><th class="col4 leftalign"> Description    </th>
	</tr>
	</thead>
	<tr class="row1">
		<th class="col0 leftalign"> value            </th><td class="col1 leftalign"> boolean        </td><td class="col2 leftalign"> yes                     </td><td class="col3 leftalign"> false         </td><td class="col4"> A way to handle currently unknown (to UCI) flags </td>
	</tr>
</table></div>
<!-- EDIT{&quot;target&quot;:&quot;table&quot;,&quot;name&quot;:&quot;&quot;,&quot;hid&quot;:&quot;table9&quot;,&quot;secid&quot;:47,&quot;range&quot;:&quot;13783-14010&quot;} -->
</div>

<h4 id="config_user">config user</h4>
<div class="level4">

<p>
<strong>NB</strong> From 18.06
</p>
<div class="table sectionedit48"><table class="inline">
	<thead>
	<tr class="row0">
		<th class="col0 leftalign"> Option           </th><th class="col1 leftalign"> Type           </th><th class="col2"> Required </th><th class="col3 leftalign"> Default           </th><th class="col4 leftalign"> Description    </th>
	</tr>
	</thead>
	<tr class="row1">
		<th class="col0 leftalign"> username         </th><td class="col1 leftalign"> string         </td><td class="col2 leftalign"> yes       </td><td class="col3"> ? (probably not) </td><td class="col4"> &#039;username&#039; (NUT only) for accessing a this server with e.g. upsmon (local or remote) </td>
	</tr>
	<tr class="row2">
		<th class="col0 leftalign"> password         </th><td class="col1 leftalign"> password       </td><td class="col2 leftalign"> yes       </td><td class="col3 leftalign"> <em>none</em>         </td><td class="col4"> password for the above user </td>
	</tr>
	<tr class="row3">
		<th class="col0 leftalign"> actions          </th><td class="col1 leftalign"> string         </td><td class="col2 leftalign"> no        </td><td class="col3 leftalign"> <em>none</em>         </td><td class="col4"> optional action (only listed allowed) </td>
	</tr>
	<tr class="row4">
		<th class="col0 leftalign"> instcmd          </th><td class="col1"> list of strings </td><td class="col2 leftalign"> no       </td><td class="col3 leftalign"> <em>none</em>         </td><td class="col4"></td>
	</tr>
	<tr class="row5">
		<th class="col0 leftalign"> upsmon           </th><td class="col1"> (&#039;slave&#039; or &#039;master&#039;) </td><td class="col2 leftalign"> yes    </td><td class="col3 leftalign"> ?                </td><td class="col4"> Whether client is a &#039;slave&#039; for &#039;master&#039;.  slaves are dependent on masters and can&#039;t shutdown the UPS on low UPS power; used for multiple hosts on the same UPS </td>
	</tr>
</table></div>
<!-- EDIT{&quot;target&quot;:&quot;table&quot;,&quot;name&quot;:&quot;&quot;,&quot;hid&quot;:&quot;table10&quot;,&quot;secid&quot;:48,&quot;range&quot;:&quot;14052-14859&quot;} -->
</div>

<h4 id="config_listen_address">config listen_address</h4>
<div class="level4">
<div class="table sectionedit49"><table class="inline">
	<thead>
	<tr class="row0">
		<th class="col0 leftalign"> Option           </th><th class="col1 leftalign"> Type                  </th><th class="col2"> Required </th><th class="col3 leftalign"> Default           </th><th class="col4 leftalign"> Description    </th>
	</tr>
	</thead>
	<tr class="row1">
		<th class="col0 leftalign"> address          </th><td class="col1 leftalign"> <abbr title="Internet Protocol version 4">IPv4</abbr> or <abbr title="Internet Protocol version 6">IPv6</abbr> address  </td><td class="col2 leftalign"> yes      </td><td class="col3 leftalign"> ::1             </td><td class="col4"> Address to which to bind server (can be a wildcard address such as 0.0.0.0) </td>
	</tr>
	<tr class="row2">
		<th class="col0 leftalign"> port             </th><td class="col1 leftalign"> tcp port              </td><td class="col2 leftalign"> yes      </td><td class="col3 leftalign"> 3493            </td><td class="col4"> Port on which to listen </td>
	</tr>
</table></div>
<!-- EDIT{&quot;target&quot;:&quot;table&quot;,&quot;name&quot;:&quot;&quot;,&quot;hid&quot;:&quot;table11&quot;,&quot;secid&quot;:49,&quot;range&quot;:&quot;14892-15236&quot;} -->
</div>

<h4 id="config_upsd_upsd">config upsd &#039;upsd&#039;</h4>
<div class="level4">

<p>
There should only be on &#039;upsd&#039; section and it should be named &#039;upsd&#039;
</p>
<div class="table sectionedit50"><table class="inline">
	<thead>
	<tr class="row0">
		<th class="col0 leftalign"> Option           </th><th class="col1 leftalign"> Type           </th><th class="col2"> Required </th><th class="col3 leftalign"> Default           </th><th class="col4 leftalign"> Description    </th>
	</tr>
	</thead>
	<tr class="row1">
		<th class="col0 leftalign"> maxage           </th><td class="col1 leftalign"> integer        </td><td class="col2 leftalign"> yes       </td><td class="col3 leftalign"> 15               </td><td class="col4"> Maximum number of seconds before data is considered &#039;stale&#039; </td>
	</tr>
	<tr class="row2">
		<th class="col0 leftalign"> statepath        </th><td class="col1 leftalign"> string         </td><td class="col2 leftalign"> yes       </td><td class="col3 leftalign"> /var/run/nut     </td><td class="col4"> Where to store runtime data </td>
	</tr>
	<tr class="row3">
		<th class="col0 leftalign"> maxconn          </th><td class="col1 leftalign"> integer        </td><td class="col2 leftalign"> yes       </td><td class="col3 leftalign"> 102              </td><td class="col4"> Maximum number of connections to accept at once </td>
	</tr>
	<tr class="row4">
		<th class="col0 leftalign"> certfile         </th><td class="col1 leftalign"> path           </td><td class="col2 leftalign"> no        </td><td class="col3 leftalign"> <em>none</em>         </td><td class="col4"> Only for <abbr title="Secure Socket Layer">SSL</abbr>-enabled builds; path to <abbr title="Secure Socket Layer">SSL</abbr> certificate </td>
	</tr>
</table></div>
<!-- EDIT{&quot;target&quot;:&quot;table&quot;,&quot;name&quot;:&quot;&quot;,&quot;hid&quot;:&quot;table12&quot;,&quot;secid&quot;:50,&quot;range&quot;:&quot;15336-15894&quot;} -->
</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;nut_server&quot;,&quot;hid&quot;:&quot;nut_server&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:33,&quot;range&quot;:&quot;6052-15895&quot;} -->
<h3 class="sectionedit51" id="nut_server_default_file">nut_server default file</h3>
<div class="level3">
<pre class="code">#config driver &#039;upsname&#039;
#	option driver usbhid-ups
#	option port auto
#	option other other-value
#	option runas root

#config user
#	option username upsuser
#	option password upspassword
#	option actions optional-action
#	list instcmd optional-instant-command
#	option upsmon slave|master

#config listen_address
#	option address ::1
#	option port 3493

#config upsd &#039;upsd&#039;
#	option maxage 15
#	option statepath /var/run/nut
#	option maxconn 1024
# NB: certificates only apply to SSL-enabled version
#       option certfile /usr/local/etc/upsd.pem</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;nut_server default file&quot;,&quot;hid&quot;:&quot;nut_server_default_file&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:51,&quot;range&quot;:&quot;15896-16495&quot;} -->
<h3 class="sectionedit52" id="nut_server_working_example">nut_server working example</h3>
<div class="level3">
<pre class="code">config driver &#039;eaton5p&#039;
  option driver usbhid-ups
  option port auto
  
config user
   option username upsuser
   option password somepassword
   option upsmon master
   # For a netserver, otherwise the default ::1 (localhost) is fine

config listen_address
   option 0.0.0.0

config upsd upsd</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;nut_server working example&quot;,&quot;hid&quot;:&quot;nut_server_working_example&quot;,&quot;codeblockOffset&quot;:1,&quot;secid&quot;:52,&quot;range&quot;:&quot;16496-16847&quot;} -->
<h3 class="sectionedit53" id="nut_monitor">nut_monitor</h3>
<div class="level3">

</div>

<h4 id="config_upsmon_upsmon">config upsmon &#039;upsmon&#039;</h4>
<div class="level4">

<p>
There should be only one upsmon section and should be named &#039;upsmon&#039;
</p>
<div class="table sectionedit54"><table class="inline">
	<thead>
	<tr class="row0">
		<th class="col0 leftalign"> Option       </th><th class="col1 leftalign"> Type        </th><th class="col2 leftalign"> Required        </th><th class="col3 leftalign"> Default           </th><th class="col4"> Description </th>
	</tr>
	</thead>
	<tr class="row1">
		<th class="col0 leftalign"> runas        </th><td class="col1 leftalign"> string      </td><td class="col2 leftalign"> yes             </td><td class="col3 leftalign"> nut               </td><td class="col4"> User as which to execute upsmon </td>
	</tr>
	<tr class="row2">
		<th class="col0 leftalign"> minsupplies  </th><td class="col1 leftalign"> integer     </td><td class="col2 leftalign"> yes             </td><td class="col3 leftalign"> 1                 </td><td class="col4"> Not OpenWrt relevent (Datacentre use) minimum number of UPSes that have to be supplying power to host </td>
	</tr>
	<tr class="row3">
		<th class="col0 leftalign"> shutdowncmd  </th><td class="col1 leftalign"> path        </td><td class="col2 leftalign"> yes             </td><td class="col3 leftalign"> /sbin/halt        </td><td class="col4"> Command to run on UPS clean shutdown (either due to lower power, or NUT action </td>
	</tr>
	<tr class="row4">
		<th class="col0 leftalign"> notifycmd    </th><td class="col1 leftalign"> path        </td><td class="col2 leftalign"> no              </td><td class="col3 leftalign"> <em>none</em>           </td><td class="col4"> Command to execute if &#039;notify&#039; type EXEC is set </td>
	</tr>
	<tr class="row5">
		<th class="col0"> defaultnotify </th><td class="col1"> list of SYSLOG or EXEC or IGNORE or WALL </td><td class="col2"> yes </td><td class="col3"> SYSLOG </td><td class="col4"> How to notify of UPS monitoring events.  Note that nut-upsmond-sendmail-notify sets <em>notifycmd</em> to a script which emits a message via email (using &#039;sendmail&#039; command in standard location) and adds EXEC to <em>defaultnotify</em> </td>
	</tr>
	<tr class="row6">
		<th class="col0 leftalign"> pollfreq     </th><td class="col1 leftalign"> integer     </td><td class="col2 leftalign"> yes             </td><td class="col3 leftalign"> 5                 </td><td class="col4"> Time in seconds to query the NUT server </td>
	</tr>
	<tr class="row7">
		<th class="col0"> pollfreqalert </th><td class="col1 leftalign"> integer   </td><td class="col2 leftalign"> yes             </td><td class="col3 leftalign"> 5                 </td><td class="col4"> Time in seconds to query the NUT server while on battery </td>
	</tr>
	<tr class="row8">
		<th class="col0 leftalign"> hostsync     </th><td class="col1 leftalign"> integer     </td><td class="col2 leftalign"> yes            </td><td class="col3 leftalign"> 15                </td><td class="col4"> From  <a href="https://networkupstools.org/docs/man/upsmon.conf.html" class="urlextern" title="https://networkupstools.org/docs/man/upsmon.conf.html" rel="ugc nofollow">upsmon.conf man page (official)</a>   upsmon will wait up to this many seconds in master mode for the slaves to disconnect during a shutdown situation. By default, this is 15 seconds.  When a UPS goes critical (on battery + low battery, or “FSD”: forced shutdown), the slaves are supposed to disconnect and shut down right away. The HOSTSYNC timer keeps the master upsmon from sitting there forever if one of the slaves gets stuck. This value is also used to keep slave systems from getting stuck if the master fails to respond in time. After a UPS becomes critical, the slave will wait up to HOSTSYNC seconds for the master to set the FSD flag. If that timer expires, the slave will assume that the master is broken and will shut down anyway.  This keeps the slaves from shutting down during a short-lived status change to “OB LB” that the slaves see but the master misses. </td>
	</tr>
	<tr class="row9">
		<th class="col0 leftalign"> deadtime     </th><td class="col1 leftalign"> integer     </td><td class="col2 leftalign"> yes           </td><td class="col3 leftalign"> 15                 </td><td class="col4"> How long a server can go missing before declaring it &#039;dead&#039; </td>
	</tr>
	<tr class="row10">
		<th class="col0"> powerdownflags </th><td class="col1 leftalign"> path      </td><td class="col2 leftalign"> no            </td><td class="col3"> /var/run/killpower </td><td class="col4"> If NUT sees this file it will powerdown the UPS(es) </td>
	</tr>
	<tr class="row11">
		<th class="col0 leftalign"> finaldelay   </th><td class="col1 leftalign"> integer     </td><td class="col2 leftalign"> yes           </td><td class="col3 leftalign"> 15                 </td><td class="col4"> From  <a href="https://networkupstools.org/docs/man/upsmon.conf.html" class="urlextern" title="https://networkupstools.org/docs/man/upsmon.conf.html" rel="ugc nofollow">upsmon.conf man page (official)</a> When running in master mode, upsmon waits this long after sending the NOTIFY_SHUTDOWN to warn the users. After the timer elapses, it then runs your SHUTDOWNCMD. By default this is set to 5 seconds.  If you need to let your users do something in between those events, increase this number. Remember, at this point your UPS battery is almost depleted, so don’t make this too big.  Alternatively, you can set this very low so you don’t wait around when it’s time to shut down. Some UPSes don’t give much warning for low battery and will require a value of 0 here for a safe shutdown. </td>
	</tr>
	<tr class="row12">
		<th class="col0 leftalign"> certpath     </th><td class="col1 leftalign"> path        </td><td class="col2 leftalign"> no            </td><td class="col3 leftalign"> /etc/ssl/certs     </td><td class="col4"> Only for <abbr title="Secure Socket Layer">SSL</abbr>-enabled builds: Path to directory containing CA certificates for validating <abbr title="Secure Socket Layer">SSL</abbr> certificates </td>
	</tr>
	<tr class="row13">
		<th class="col0 leftalign"> certverify    </th><td class="col1 leftalign"> boolean     </td><td class="col2 leftalign"> no           </td><td class="col3 leftalign"> false              </td><td class="col4"> Only for <abbr title="Secure Socket Layer">SSL</abbr>-enabled builds: server CommonName must match <abbr title="Domain Name System">DNS</abbr> name we are using </td>
	</tr>
	<tr class="row14">
		<th class="col0 leftalign"> forcessl      </th><td class="col1 leftalign"> boolean    </td><td class="col2 leftalign"> no            </td><td class="col3 leftalign"> false              </td><td class="col4"> Only for <abbr title="Secure Socket Layer">SSL</abbr>-enabled builds: implied by certverify; without certverfy requires the connection is at least encrypted </td>
	</tr>
</table></div>
<!-- EDIT{&quot;target&quot;:&quot;table&quot;,&quot;name&quot;:&quot;&quot;,&quot;hid&quot;:&quot;table13&quot;,&quot;secid&quot;:54,&quot;range&quot;:&quot;16973-20666&quot;} -->
<p>
For each of (lowercased):
</p>
<ul>
<li class="level1"><div class="li"> COMOK</div>
</li>
<li class="level1"><div class="li"> COMBAD</div>
</li>
<li class="level1"><div class="li"> SHUTDOWN</div>
</li>
<li class="level1"><div class="li"> REPLBATTERY</div>
</li>
<li class="level1"><div class="li"> NOCOMMS</div>
</li>
<li class="level1"><div class="li"> NOPARENT</div>
</li>
<li class="level1"><div class="li"> ONLINE</div>
</li>
<li class="level1"><div class="li"> ONBATT</div>
</li>
<li class="level1"><div class="li"> LOWBATT</div>
</li>
<li class="level1"><div class="li"> FSD</div>
</li>
</ul>

<p>
There are &#039;XXXmsg&#039; and &#039;XXXnotifyflag&#039; options (e.g. &#039;comokmsg&#039; and &#039;comoknotifyflag&#039;).
</p>

<p>
This are all optional.  The &#039;msg&#039; options are strings and are messages to emit instead of the default on one of the above conditions (see <a href="https://networkupstools.org/docs/man/upsmon.conf.html" class="urlextern" title="https://networkupstools.org/docs/man/upsmon.conf.html" rel="ugc nofollow">upsmon.conf man page (official)</a>).
</p>

<p>
The &#039;notifyflag&#039; options are boolean (default true) and indicate whether to emit the message using the &#039;defaultnotify&#039; setting or to not emit a message (IGNORE) setting for that message. 
</p>

</div>

<h4 id="config_master_and_config_slave">config master and config slave</h4>
<div class="level4">

</div>

<h5 id="slave_vs_master">Slave vs. Master</h5>
<div class="level5">

<p>
From &#039;UPS TYPES&#039; in <a href="https://networkupstools.org/docs/man/upsmon.html" class="urlextern" title="https://networkupstools.org/docs/man/upsmon.html" rel="ugc nofollow">upsmon manpage (official)</a>
</p>

<p>
upsmon and upsd(8) don’t always run on the same system. When they do, any UPSes that are directly attached to the upsmon host should be monitored in “master” mode. This makes upsmon take charge of that equipment, and it will wait for slaves to disconnect before shutting down the local system. This allows the distant systems (monitoring over the network) to shut down cleanly before upsdrvctl shutdown runs and turns them all off.
</p>

<p>
When upsmon runs as a slave, it is relying on the distant system to tell it about the state of the UPS. When that UPS goes critical (on battery and low battery), it immediately invokes the local shutdown command. This needs to happen quickly. Once it disconnects from the distant upsd(8) server, the master upsmon will start its own shutdown process. Your slaves must all shut down before the master turns off the power or filesystem damage may result.
</p>

<p>
upsmon deals with slaves that get wedged, hang, or otherwise fail to disconnect from upsd(8) in a timely manner with the HOSTSYNC timer. During a shutdown situation, the master upsmon will give up after this interval and it will shut down anyway. This keeps the master from sitting there forever (which would endanger that host) if a slave should break somehow. This defaults to 15 seconds.
</p>

<p>
If your master system is shutting down too quickly, set the FINALDELAY interval to something greater than the default 15 seconds. Don’t set this too high, or your UPS battery may run out of power before the master upsmon process shuts down that system
</p>

</div>

<h5 id="options">options</h5>
<div class="level5">
<div class="table sectionedit55"><table class="inline">
	<thead>
	<tr class="row0">
		<th class="col0 leftalign"> Option      </th><th class="col1 leftalign"> Type      </th><th class="col2 centeralign">   Required    </th><th class="col3 leftalign"> Default     </th><th class="col4 leftalign"> Description                   </th>
	</tr>
	</thead>
	<tr class="row1">
		<th class="col0 leftalign"> upsname     </th><td class="col1 leftalign"> string    </td><td class="col2 centeralign">    yes         </td><td class="col3 leftalign"> <em>none</em>    </td><td class="col4 leftalign"> name assigned to the UPS by the server      </td>
	</tr>
	<tr class="row2">
		<th class="col0 leftalign"> hostname    </th><td class="col1 leftalign"> string    </td><td class="col2 centeralign">    yes         </td><td class="col3 leftalign"> <em>none</em>    </td><td class="col4 leftalign"> host with the UPS server (dns name or ip)   </td>
	</tr>
	<tr class="row3">
		<th class="col0 leftalign"> port        </th><td class="col1 leftalign"> tcp port  </td><td class="col2 centeralign">    no          </td><td class="col3 leftalign"> 3493        </td><td class="col4 leftalign"> port on which to connect to server          </td>
	</tr>
	<tr class="row4">
		<th class="col0 leftalign"> powervalue  </th><td class="col1 leftalign"> integer   </td><td class="col2 centeralign">    yes         </td><td class="col3 leftalign"> 1           </td><td class="col4 leftalign"> Number of UPSes supplying this host from the server        </td>
	</tr>
	<tr class="row5">
		<th class="col0 leftalign"> username    </th><td class="col1 leftalign"> string    </td><td class="col2 centeralign">    yes         </td><td class="col3 leftalign"> <em> none </em>  </td><td class="col4"> NUT username for connecting to the server </td>
	</tr>
	<tr class="row6">
		<th class="col0 leftalign"> password    </th><td class="col1 leftalign"> password  </td><td class="col2 centeralign">    yes         </td><td class="col3 leftalign"> <em>none</em>    </td><td class="col4"> NUT password for the user for connecting to  the server </td>
	</tr>
</table></div>
<!-- EDIT{&quot;target&quot;:&quot;table&quot;,&quot;name&quot;:&quot;&quot;,&quot;hid&quot;:&quot;table14&quot;,&quot;secid&quot;:55,&quot;range&quot;:&quot;23037-23782&quot;} -->
</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;nut_monitor&quot;,&quot;hid&quot;:&quot;nut_monitor&quot;,&quot;codeblockOffset&quot;:2,&quot;secid&quot;:53,&quot;range&quot;:&quot;16848-23783&quot;} -->
<h3 class="sectionedit56" id="nut_monitor_default_file">nut_monitor default file</h3>
<div class="level3">
<pre class="code">#config upsmon &#039;upsmon&#039;
#	option runas run-as-user
#	option minsupplies 1
#	option shutdowncmd /sbin/halt
#	option notifycmd /path/to/cmd
#	list defaultnotify SYSLOG
#	option pollfreq 5
#	option pollfreqalert 5
# 	option hostsync 15
#	option deadtime 15
#	option powerdownflags /var/run/killpower
#	option onlinemsg &quot;online message&quot;
#	option onbattmsg &quot;on battery message&quot;
#	option lowbattmsg &quot;low battery message&quot;
#	option fsdmsg &quot;forced shutdown message&quot;
#	option comokmsg &quot;communications restored message&quot;
#	option combadmsg &quot;communications bad message&quot;
#	option shutdowmsg &quot;shutdown message&quot;
#	option replbattmsg &quot;replace battery message&quot;
#	option nocommmsg &quot;no communications message&quot;
#	option noparentmsg &quot;no parent message&quot;
#	option onlinenotify &quot;online notify flag 1|0&quot;
#	option onbattnotify &quot;on battery notify flag 1|0&quot;
#	option lowbattnotify &quot;low battery notify flag 1|0&quot;
#	option fsdnotify &quot;forced shutdown notify flag 1|0&quot;
#	option comoknotify &quot;communications restored notify flag 1|0&quot;
#	option combadnotify &quot;communications bad notify flag 1|0&quot;
#	option shutdownotify &quot;shutdown notify flag 1|0&quot;
#	option replbattnotify &quot;replace battery notify flag 1|0&quot;
#	option nocommnotify &quot;no communications notify flag 1|0&quot;
#	option noparentnotify &quot;no parent notify flag 1|0&quot;
#	option rbwarntime 4200 # replace battery warn time
#	option nocommwarntime 300 # no communications warn time
#	option finaldelay 5 # final delay
#	option certpath /path/to/ca/dir
#	option certverify 0
#	option forcessl 0

#config master
#	option upsname upsname
#	option hostname localhost
#	option port # optional port number
#	option powervalue 1
#	option username upsuser
#	option password upspassword

#config slave
#	option upsname upsname
#	option hostname localhost
#	option port # optional port number
#	option powervalue 1
#	option username upsuser
#	option password upspassword</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;nut_monitor default file&quot;,&quot;hid&quot;:&quot;nut_monitor_default_file&quot;,&quot;codeblockOffset&quot;:2,&quot;secid&quot;:56,&quot;range&quot;:&quot;23784-25699&quot;} -->
<h3 class="sectionedit57" id="nut_monitor_working_example">nut_monitor working example</h3>
<div class="level3">
<pre class="code">config &#039;upsmon&#039; upsmon

config master
  option upsname eaton5p
  option hostname localhost
  option username upsuser
  option password somepassword</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;nut_monitor working example&quot;,&quot;hid&quot;:&quot;nut_monitor_working_example&quot;,&quot;codeblockOffset&quot;:3,&quot;secid&quot;:57,&quot;range&quot;:&quot;25700-25901&quot;} -->
<h3 class="sectionedit58" id="nut_cgi">nut_cgi</h3>
<div class="level3">
<!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_start&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:59,&quot;range&quot;:&quot;0-&quot;} --><div class="wrap_center wrap_round wrap_tip plugin_wrap" style="width: 60%;">
<p>
The NUT CGI doensn&#039;t have to be on the same server as nut-monitor or nut-server.
</p>

<p>
It does however require a webserver installed (default configuration is for uhttpd).
</p>
</div><!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_end&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:60,&quot;range&quot;:&quot;0-&quot;} --><div class="table sectionedit61"><table class="inline">
	<thead>
	<tr class="row0">
		<th class="col0 leftalign"> Option      </th><th class="col1 leftalign"> Type     </th><th class="col2 leftalign"> Required     </th><th class="col3 centeralign">  Default      </th><td class="col4"></td>
	</tr>
	</thead>
	<tr class="row1">
		<td class="col0 leftalign"> upsname     </td><td class="col1 leftalign"> upsname  </td><td class="col2 leftalign"> yes          </td><td class="col3 leftalign"> <em>none</em>      </td><td class="col4"> Name of UPS to monitor (as configured in nut_server) </td>
	</tr>
	<tr class="row2">
		<td class="col0 leftalign"> hostname    </td><td class="col1"> hostname </td><td class="col2 leftalign"> yes          </td><td class="col3 leftalign"> <em>none</em>      </td><td class="col4"> Name or <abbr title="Internet Protocol">IP</abbr> of NUT server </td>
	</tr>
	<tr class="row3">
		<td class="col0 leftalign"> port        </td><td class="col1"> tcp port </td><td class="col2 leftalign"> no           </td><td class="col3 leftalign"> 3493          </td><td class="col4"> Port on which to connect to NUT server </td>
	</tr>
	<tr class="row4">
		<td class="col0"> displayname </td><td class="col1 leftalign"> string   </td><td class="col2 leftalign"> yes          </td><td class="col3 leftalign"> none          </td><td class="col4"> What to show in Web UI as the UPS name </td>
	</tr>
</table></div>
<!-- EDIT{&quot;target&quot;:&quot;table&quot;,&quot;name&quot;:&quot;&quot;,&quot;hid&quot;:&quot;table15&quot;,&quot;secid&quot;:61,&quot;range&quot;:&quot;26125-26590&quot;} -->
</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;nut_cgi&quot;,&quot;hid&quot;:&quot;nut_cgi&quot;,&quot;codeblockOffset&quot;:4,&quot;secid&quot;:58,&quot;range&quot;:&quot;25902-26591&quot;} -->
<h3 class="sectionedit62" id="nut_cgi_default_config_file">nut_cgi default config file</h3>
<div class="level3">
<pre class="code">#config host
#	option upsname upsname
#	option hostname localhost
#	option port # optional port number
#	option displayname &quot;Display Name&quot;</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;nut_cgi default config file&quot;,&quot;hid&quot;:&quot;nut_cgi_default_config_file&quot;,&quot;codeblockOffset&quot;:4,&quot;secid&quot;:62,&quot;range&quot;:&quot;26592-26784&quot;} -->
<h3 class="sectionedit63" id="nut_cgi_working_example">nut_cgi working example</h3>
<div class="level3">
<pre class="code">config host
  option uspsname eaton5p
  option hostname localhost
  option displayname &quot;Eaton 5P&quot;</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;nut_cgi working example&quot;,&quot;hid&quot;:&quot;nut_cgi_working_example&quot;,&quot;codeblockOffset&quot;:5,&quot;secid&quot;:63,&quot;range&quot;:&quot;26785-26932&quot;} -->
<h2 class="sectionedit64" id="pre_1806">Pre 18.06</h2>
<div class="level2">

<p>
<span>
In <em class="u">older release(s)</em> there&#039;s problem with some USB UPSes (e.g. EATON) that are not recognized by usbhid-ups. This is apparently a bug in libusb-compat, since libusb (0.1.4) can recognize them.

You can work around this by installing Attitude Adjustment, manually installing packages <em class="u">libusb-compat</em> and <strong>nut-driver-usbhid-ups</strong>, then manualy remove <em class="u">libusb-compat</em> and install <strong>libusb</strong> istead (packages in trunk may break on having manually installed libusb)
</span>
</p>

<p>
You will want to have packages <strong>nut</strong>, <strong>nut-server</strong> and <strong>nut-client</strong> packages installed to have main functionality.
</p>

<p>
<span style='color:#ed1c24; '><strong>NOTE</strong> UCI configuration has changed for 18.06 (as of the commit above).</span>
</p>

<p>
You may want to have nut-monitor installed, if you want to shutdown your router when UPS power goes critical and your device can turn itself off. Otherwise, the UPS will only provide information for you and clients. 
</p>

<p>
NUT expects configuration by <a href="/docs/techref/uci" class="wikilink1" title="docs:techref:uci" data-wiki-id="docs:techref:uci">UCI</a>, by putting the following into <strong>/etc/config/ups</strong>:
</p>
<pre class="code">config driver &#039;eaton&#039;
        option driver &#039;usbhid-ups&#039;
        option port &#039;auto&#039;

config user
        option username &#039;guest&#039;
        option password &#039;guest&#039;
        option upsmon &#039;slave&#039;</pre>

<p>
For the NUT to run at all, you must change the MODE in <strong>/etc/nut/nut.conf</strong> to e.g. netserver:
</p>
<pre class="code">MODE=netserver</pre>

<p>
If you want the upsd be acccessible from network (why otherwise would you want to run nut on router?), you must put a LISTEN directive to <strong>/etc/nut/upsd.conf</strong>:
</p>
<pre class="code">LISTEN 0.0.0.0</pre>

<p>
You may want to change options according to the type of UPS you have and options you want to use.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Pre 18.06&quot;,&quot;hid&quot;:&quot;pre_1806&quot;,&quot;codeblockOffset&quot;:6,&quot;secid&quot;:64,&quot;range&quot;:&quot;26933-28610&quot;} -->
<h3 class="sectionedit65" id="configuring_upsmon">Configuring upsmon</h3>
<div class="level3">

<p>
After you installed and configured NUT, you may want to setup your router for monitoring UPS.
You need to install <em class="u">nut-monitor</em> package and add your config to <strong>/etc/config/upsmon</strong>
</p>

<p>
Sample upsmon config
</p>
<pre class="code">config upsmon
        option &#039;shutdowncmd&#039; &#039;/lib/nut/upsdrvctl shutdown&#039;
        option &#039;notifycmd&#039; &#039;/etc/nut/notify.sh&#039;
        option &#039;onlinemsg&#039; &#039;UPS %s on line power&#039;
        option &#039;onbattmsg&#039; &#039;UPS %s on battery&#039;
        option &#039;lowbattmsg&#039; &#039;UPS %s battery is low&#039;
        option &#039;fsdmsg&#039; &#039;UPS %s: forced shutdown in progress&#039;
        option &#039;commokmsg&#039; &#039;Communications with UPS %s established&#039;
        option &#039;commbadmsg&#039; &#039;Communications with UPS %s lost&#039;
        option &#039;shutdownmsg&#039; &#039;Auto logout and shutdown proceeding&#039;
        option &#039;replbattmsg&#039; &#039;UPS %s battery needs to be replaced&#039;
        option &#039;nocommmsg&#039; &#039;UPS %s is unavailable&#039;
        option &#039;noparentmsg&#039; &#039;upsmon parent process died - shutdown impossible&#039;
        option &#039;onlinenotify&#039; &#039;EXEC+SYSLOG&#039;
        option &#039;onbattnotify&#039; &#039;EXEC+SYSLOG&#039;
        option &#039;lowbattnotify&#039; &#039;EXEC+SYSLOG&#039;
        option &#039;fsdnotify&#039; &#039;EXEC+SYSLOG&#039;
        option &#039;commoknotify&#039; &#039;EXEC+SYSLOG&#039;
        option &#039;commbadnotify&#039; &#039;EXEC+SYSLOG&#039;
        option &#039;shutdownnotify&#039; &#039;EXEC+SYSLOG&#039;
        option &#039;replbattnotify&#039; &#039;EXEC+SYSLOG&#039;
        option &#039;nocommnotify&#039; &#039;EXEC+SYSLOG&#039;
        option &#039;noparentnotify&#039; &#039;EXEC+SYSLOG&#039;
config master
        option &#039;upsname&#039; &#039;UPS&#039;
        option &#039;user&#039; &#039;guest&#039;
        option &#039;password&#039; &#039;guest&#039;</pre>

<p>
Upsmon will send to <em class="u">notifycmd</em> script some environment strings:
</p>
<pre class="code">$UPSNAME - will contain the name of UPS specified in /etc/config/ups
$NOTIFYTYPE - will contain the type string of whatever caused this event to happen.</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Configuring upsmon&quot;,&quot;hid&quot;:&quot;configuring_upsmon&quot;,&quot;codeblockOffset&quot;:9,&quot;secid&quot;:65,&quot;range&quot;:&quot;28611-&quot;} -->