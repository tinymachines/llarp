
<h1 class="sectionedit1" id="pptp_extras">PPTP extras</h1>
<div class="level1">

</div>
<!-- EDIT{&quot;target&quot;:&quot;plugin_include_start&quot;,&quot;name&quot;:&quot;meta:infobox:howto_links&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:2,&quot;range&quot;:&quot;0-&quot;} --><div class="plugin_include_content plugin_include__meta:infobox:howto_links">
<div class="level1">
<!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_start&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:4,&quot;range&quot;:&quot;0-&quot;} --><div class="wrap_info plugin_wrap">
<p>
This article relies on the following:
</p>
<ul>
<li class="level1"><div class="li"> Accessing <a href="/docs/guide-quick-start/walkthrough_login" class="wikilink1" title="docs:guide-quick-start:walkthrough_login" data-wiki-id="docs:guide-quick-start:walkthrough_login">web interface</a> / <a href="/docs/guide-quick-start/sshadministration" class="wikilink1" title="docs:guide-quick-start:sshadministration" data-wiki-id="docs:guide-quick-start:sshadministration">command-line interface</a></div>
</li>
<li class="level1"><div class="li"> Managing <a href="/docs/guide-user/base-system/uci" class="wikilink1" title="docs:guide-user:base-system:uci" data-wiki-id="docs:guide-user:base-system:uci">configs</a> / <a href="/docs/guide-user/additional-software/managing_packages" class="wikilink1" title="docs:guide-user:additional-software:managing_packages" data-wiki-id="docs:guide-user:additional-software:managing_packages">packages</a> / <a href="/docs/guide-user/base-system/managing_services" class="wikilink1" title="docs:guide-user:base-system:managing_services" data-wiki-id="docs:guide-user:base-system:managing_services">services</a> / <a href="/docs/guide-user/base-system/log.essentials" class="wikilink1" title="docs:guide-user:base-system:log.essentials" data-wiki-id="docs:guide-user:base-system:log.essentials">logs</a></div>
</li>
</ul>
</div><!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_end&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:5,&quot;range&quot;:&quot;0-&quot;} -->
</div>
<!-- EDIT{&quot;target&quot;:&quot;plugin_include_end&quot;,&quot;name&quot;:&quot;meta:infobox:howto_links&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:3,&quot;range&quot;:&quot;0-&quot;} --></div>
<div class="level1">

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;PPTP extras&quot;,&quot;hid&quot;:&quot;pptp_extras&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:1,&quot;range&quot;:&quot;1-108&quot;} -->
<h2 class="sectionedit6" id="introduction">Introduction</h2>
<div class="level2">
<ul>
<li class="level1"><div class="li"> This how-to describes the most common <a href="https://en.wikipedia.org/wiki/Point-to-Point_Tunneling_Protocol" class="interwiki iw_wp" title="https://en.wikipedia.org/wiki/Point-to-Point_Tunneling_Protocol">PPTP</a> tuning scenarios adapted for OpenWrt.</div>
</li>
<li class="level1"><div class="li"> Follow <a href="/docs/guide-user/services/vpn/pptp/server" class="wikilink1" title="docs:guide-user:services:vpn:pptp:server" data-wiki-id="docs:guide-user:services:vpn:pptp:server">PPTP server</a> for server setup and <a href="/docs/guide-user/services/vpn/pptp/client" class="wikilink1" title="docs:guide-user:services:vpn:pptp:client" data-wiki-id="docs:guide-user:services:vpn:pptp:client">PPTP client</a> for client setup.</div>
</li>
<li class="level1"><div class="li"> Follow <a href="/docs/guide-user/network/tunneling_interface_protocols#protocol_pptp_point-to-point_tunneling_protocol" class="wikilink1" title="docs:guide-user:network:tunneling_interface_protocols" data-wiki-id="docs:guide-user:network:tunneling_interface_protocols">PPTP protocol</a> for client configuration.</div>
</li>
<li class="level1"><div class="li"> Follow <a href="/docs/guide-user/services/ddns/client" class="wikilink1" title="docs:guide-user:services:ddns:client" data-wiki-id="docs:guide-user:services:ddns:client">DDNS client</a> to use own server with dynamic <abbr title="Internet Protocol">IP</abbr> address.</div>
</li>
<li class="level1"><div class="li"> Follow <a href="/docs/guide-user/services/rng" class="wikilink1" title="docs:guide-user:services:rng" data-wiki-id="docs:guide-user:services:rng">Random generator</a> to overcome low entropy issues.</div>
</li>
</ul>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Introduction&quot;,&quot;hid&quot;:&quot;introduction&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:6,&quot;range&quot;:&quot;109-781&quot;} -->
<h2 class="sectionedit7" id="extras">Extras</h2>
<div class="level2">

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Extras&quot;,&quot;hid&quot;:&quot;extras&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:7,&quot;range&quot;:&quot;782-800&quot;} -->
<h3 class="sectionedit8" id="references">References</h3>
<div class="level3">
<ul>
<li class="level1"><div class="li"> <a href="http://poptop.sourceforge.net/dox/" class="urlextern" title="http://poptop.sourceforge.net/dox/" rel="ugc nofollow">Poptop server documentation</a></div>
</li>
</ul>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;References&quot;,&quot;hid&quot;:&quot;references&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:8,&quot;range&quot;:&quot;801-893&quot;} -->
<h3 class="sectionedit9" id="web_interface">Web interface</h3>
<div class="level3">

<p>
If you want to manage <abbr title="Virtual Private Network">VPN</abbr> settings using web interface.
Install the necessary packages.
</p>
<pre class="code bash"><span class="co0"># Install packages</span>
opkg update
opkg <span class="kw2">install</span> luci-proto-ppp
service rpcd restart</pre>

<p>
Navigate to <strong>LuCI → Network → Interfaces</strong> to configure PPTP.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Web interface&quot;,&quot;hid&quot;:&quot;web_interface&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:9,&quot;range&quot;:&quot;894-1173&quot;} -->
<h3 class="sectionedit10" id="dynamic_connection">Dynamic connection</h3>
<div class="level3">

</div>
<!-- EDIT{&quot;target&quot;:&quot;plugin_include_start&quot;,&quot;name&quot;:&quot;docs:guide-user:services:vpn:wireguard:extras&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:11,&quot;range&quot;:&quot;0-&quot;} --><div class="plugin_include_content plugin_include__docs:guide-user:services:vpn:wireguard:extras">
<div class="level3">

<p>
Preserve default route to restore <abbr title="Wide Area Network">WAN</abbr> connectivity when <abbr title="Virtual Private Network">VPN</abbr> is disconnected.
</p>
<pre class="code bash"><span class="co0"># Preserve default route</span>
uci <span class="kw1">set</span> network.wan.metric=<span class="st0">&quot;1024&quot;</span>
uci commit network
service network restart</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;plugin_include_end&quot;,&quot;name&quot;:&quot;docs:guide-user:services:vpn:wireguard:extras&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:12,&quot;range&quot;:&quot;0-&quot;} --></div>
<div class="level3">

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Dynamic connection&quot;,&quot;hid&quot;:&quot;dynamic_connection&quot;,&quot;codeblockOffset&quot;:1,&quot;secid&quot;:10,&quot;range&quot;:&quot;1174-1311&quot;} -->
<h3 class="sectionedit13" id="nat_traversal">NAT traversal</h3>
<div class="level3">

<p>
Provide PPTP passthrough for <abbr title="Local Area Network">LAN</abbr> clients over your router.
</p>
<pre class="code bash"><span class="co0"># Install packages</span>
opkg update
opkg <span class="kw2">install</span> kmod-nf-nathelper-extra
service firewall restart</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;NAT traversal&quot;,&quot;hid&quot;:&quot;nat_traversal&quot;,&quot;codeblockOffset&quot;:2,&quot;secid&quot;:13,&quot;range&quot;:&quot;1312-1509&quot;} -->
<h3 class="sectionedit14" id="static_addresses">Static addresses</h3>
<div class="level3">

<p>
Provide static <abbr title="Internet Protocol">IP</abbr> address allocation on <abbr title="Virtual Private Network">VPN</abbr> server.
</p>
<pre class="code bash"><span class="co0"># Configure VPN service</span>
<span class="kw2">rm</span> <span class="re5">-f</span> <span class="sy0">/</span>tmp<span class="sy0">/</span>etc<span class="sy0">/</span>chap-secrets
uci <span class="kw1">set</span> pptpd.client.remoteip=<span class="st0">&quot;192.168.9.2&quot;</span>
uci commit pptpd
service pptpd restart</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Static addresses&quot;,&quot;hid&quot;:&quot;static_addresses&quot;,&quot;codeblockOffset&quot;:3,&quot;secid&quot;:14,&quot;range&quot;:&quot;1510-1745&quot;} -->
<h3 class="sectionedit15" id="site-to-site">Site-to-site</h3>
<div class="level3">

<p>
Implement plain routing between server side <abbr title="Local Area Network">LAN</abbr> and client side <abbr title="Local Area Network">LAN</abbr> assuming that:
</p>
<ul>
<li class="level1"><div class="li"> <code>192.168.1.0/24</code> - server side <abbr title="Local Area Network">LAN</abbr></div>
</li>
<li class="level1"><div class="li"> <code>192.168.2.0/24</code> - client side <abbr title="Local Area Network">LAN</abbr></div>
</li>
</ul>

<p>
Set up <a href="/docs/guide-user/services/vpn/pptp/extras#static_addresses" class="wikilink1" title="docs:guide-user:services:vpn:pptp:extras" data-wiki-id="docs:guide-user:services:vpn:pptp:extras">static address</a> allocation on <abbr title="Virtual Private Network">VPN</abbr> server, add route to client side <abbr title="Local Area Network">LAN</abbr>.
</p>
<pre class="code bash"><span class="kw2">cat</span> <span class="sy0">&lt;&lt;</span> <span class="st0">&quot;EOF&quot;</span> <span class="sy0">&gt;</span> <span class="sy0">/</span>etc<span class="sy0">/</span>ppp<span class="sy0">/</span>ip-up
<span class="co0">#!/bin/sh</span>
<span class="kw1">case</span> <span class="co1">${IPREMOTE}</span> <span class="kw1">in</span>
<span class="br0">&#40;</span>192.168.9.2<span class="br0">&#41;</span> <span class="kw2">ip route</span> add 192.168.2.0<span class="sy0">/</span><span class="nu0">24</span> via <span class="co1">${IPREMOTE}</span> dev <span class="co1">${IFNAME}</span> <span class="sy0">;;</span>
<span class="kw1">esac</span>
EOF
<span class="kw2">chmod</span> +x <span class="sy0">/</span>etc<span class="sy0">/</span>ppp<span class="sy0">/</span>ip-up</pre>

<p>
Consider <abbr title="Virtual Private Network">VPN</abbr> network as private and assign <abbr title="Virtual Private Network">VPN</abbr> interface to <abbr title="Local Area Network">LAN</abbr> zone on <abbr title="Virtual Private Network">VPN</abbr> client, add route to server side <abbr title="Local Area Network">LAN</abbr>.
</p>
<pre class="code bash">uci del_list firewall.wan.network=<span class="st0">&quot;vpn&quot;</span>
uci add_list firewall.lan.network=<span class="st0">&quot;vpn&quot;</span>
uci commit firewall
service firewall restart
uci <span class="re5">-q</span> delete network.vpn_rt
uci <span class="kw1">set</span> network.vpn_rt=<span class="st0">&quot;route&quot;</span>
uci <span class="kw1">set</span> network.vpn_rt.interface=<span class="st0">&quot;vpn&quot;</span>
uci <span class="kw1">set</span> network.vpn_rt.target=<span class="st0">&quot;192.168.1.0/24&quot;</span>
uci <span class="kw1">set</span> network.vpn_rt.gateway=<span class="st0">&quot;192.168.9.1&quot;</span>
uci commit network
service network restart</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Site-to-site&quot;,&quot;hid&quot;:&quot;site-to-site&quot;,&quot;codeblockOffset&quot;:4,&quot;secid&quot;:15,&quot;range&quot;:&quot;1746-2759&quot;} -->
<h3 class="sectionedit16" id="default_gateway">Default gateway</h3>
<div class="level3">

</div>
<!-- EDIT{&quot;target&quot;:&quot;plugin_include_start&quot;,&quot;name&quot;:&quot;docs:guide-user:services:vpn:openconnect:extras&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:17,&quot;range&quot;:&quot;0-&quot;} --><div class="plugin_include_content plugin_include__docs:guide-user:services:vpn:openconnect:extras">
<div class="level3">

</div>
<!-- EDIT{&quot;target&quot;:&quot;plugin_include_start&quot;,&quot;name&quot;:&quot;meta:infobox:howto_links&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:19,&quot;range&quot;:&quot;0-&quot;} --><div class="plugin_include_content plugin_include__meta:infobox:howto_links">
<div class="level4">
<!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_start&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:21,&quot;range&quot;:&quot;0-&quot;} --><div class="wrap_info plugin_wrap">
<p>
This article relies on the following:
</p>
<ul>
<li class="level1"><div class="li"> Accessing <a href="/docs/guide-quick-start/walkthrough_login" class="wikilink1" title="docs:guide-quick-start:walkthrough_login" data-wiki-id="docs:guide-quick-start:walkthrough_login">web interface</a> / <a href="/docs/guide-quick-start/sshadministration" class="wikilink1" title="docs:guide-quick-start:sshadministration" data-wiki-id="docs:guide-quick-start:sshadministration">command-line interface</a></div>
</li>
<li class="level1"><div class="li"> Managing <a href="/docs/guide-user/base-system/uci" class="wikilink1" title="docs:guide-user:base-system:uci" data-wiki-id="docs:guide-user:base-system:uci">configs</a> / <a href="/docs/guide-user/additional-software/managing_packages" class="wikilink1" title="docs:guide-user:additional-software:managing_packages" data-wiki-id="docs:guide-user:additional-software:managing_packages">packages</a> / <a href="/docs/guide-user/base-system/managing_services" class="wikilink1" title="docs:guide-user:base-system:managing_services" data-wiki-id="docs:guide-user:base-system:managing_services">services</a> / <a href="/docs/guide-user/base-system/log.essentials" class="wikilink1" title="docs:guide-user:base-system:log.essentials" data-wiki-id="docs:guide-user:base-system:log.essentials">logs</a></div>
</li>
</ul>
</div><!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_end&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:22,&quot;range&quot;:&quot;0-&quot;} -->
</div>
<!-- EDIT{&quot;target&quot;:&quot;plugin_include_end&quot;,&quot;name&quot;:&quot;meta:infobox:howto_links&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:20,&quot;range&quot;:&quot;0-&quot;} --></div>
<div class="level4">

</div>

<h4 id="introduction1">Introduction</h4>
<div class="level4">
<ul>
<li class="level1"><div class="li"> This how-to describes the most common <a href="https://en.wikipedia.org/wiki/OpenConnect" class="interwiki iw_wp" title="https://en.wikipedia.org/wiki/OpenConnect">OpenConnect</a> tuning scenarios adapted for OpenWrt.</div>
</li>
<li class="level1"><div class="li"> Follow <a href="/docs/guide-user/services/vpn/openconnect/server" class="wikilink1" title="docs:guide-user:services:vpn:openconnect:server" data-wiki-id="docs:guide-user:services:vpn:openconnect:server">OpenConnect server</a> for server setup and <a href="/docs/guide-user/services/vpn/openconnect/client" class="wikilink1" title="docs:guide-user:services:vpn:openconnect:client" data-wiki-id="docs:guide-user:services:vpn:openconnect:client">OpenConnect client</a> for client setup.</div>
</li>
<li class="level1"><div class="li"> Follow <a href="/docs/guide-user/network/tunneling_interface_protocols#protocol_openconnect_openconnect_vpn" class="wikilink1" title="docs:guide-user:network:tunneling_interface_protocols" data-wiki-id="docs:guide-user:network:tunneling_interface_protocols">OpenConnect protocol</a> for client configuration.</div>
</li>
<li class="level1"><div class="li"> Follow <a href="/docs/guide-user/services/ddns/client" class="wikilink1" title="docs:guide-user:services:ddns:client" data-wiki-id="docs:guide-user:services:ddns:client">DDNS client</a> to use own server with dynamic <abbr title="Internet Protocol">IP</abbr> address.</div>
</li>
<li class="level1"><div class="li"> Follow <a href="/docs/guide-user/services/rng" class="wikilink1" title="docs:guide-user:services:rng" data-wiki-id="docs:guide-user:services:rng">Random generator</a> to overcome low entropy issues.</div>
</li>
</ul>

</div>

<h4 id="extras1">Extras</h4>
<div class="level4">

</div>

<h5 id="references1">References</h5>
<div class="level5">
<ul>
<li class="level1"><div class="li"> <a href="https://www.infradead.org/openconnect/" class="urlextern" title="https://www.infradead.org/openconnect/" rel="ugc nofollow">OpenConnect official site</a></div>
</li>
<li class="level1"><div class="li"> <a href="https://ocserv.gitlab.io/www/manual.html" class="urlextern" title="https://ocserv.gitlab.io/www/manual.html" rel="ugc nofollow">ocserv server documentation</a></div>
</li>
<li class="level1"><div class="li"> <a href="https://github.com/openwrt/packages/tree/master/net/ocserv" class="urlextern" title="https://github.com/openwrt/packages/tree/master/net/ocserv" rel="ugc nofollow">OpenConnect configuration examples</a></div>
</li>
</ul>

</div>

<h5 id="server_certificate">Server certificate</h5>
<div class="level5">

<p>
Fetch server certificate from remote <abbr title="Virtual Private Network">VPN</abbr> server. Beware of possible <abbr title="Man-In-The-Middle">MITM</abbr>.
</p>
<pre class="code bash">openssl s_client <span class="re5">-showcerts</span> <span class="re5">-connect</span> <span class="co1">${VPN_SERV}</span>:<span class="co1">${VPN_PORT}</span> \
<span class="sy0">&lt;</span> <span class="sy0">/</span>dev<span class="sy0">/</span>null <span class="sy0">&gt;</span> server-cert.pem</pre>

</div>

<h5 id="keep_existing_gateway">Keep existing gateway</h5>
<div class="level5">

</div>
<!-- EDIT{&quot;target&quot;:&quot;plugin_include_start&quot;,&quot;name&quot;:&quot;docs:guide-user:services:vpn:wireguard:extras&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:23,&quot;range&quot;:&quot;0-&quot;} --><div class="plugin_include_content plugin_include__docs:guide-user:services:vpn:wireguard:extras">
<div class="level5">

<p>
Preserve default route to restore <abbr title="Wide Area Network">WAN</abbr> connectivity when <abbr title="Virtual Private Network">VPN</abbr> is disconnected.
</p>
<pre class="code bash"><span class="co0"># Preserve default route</span>
uci <span class="kw1">set</span> network.wan.metric=<span class="st0">&quot;1024&quot;</span>
uci commit network
service network restart</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;plugin_include_end&quot;,&quot;name&quot;:&quot;docs:guide-user:services:vpn:wireguard:extras&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:24,&quot;range&quot;:&quot;0-&quot;} --></div>
<div class="level6">

</div>

<h5 id="gateway_redirection">Gateway redirection</h5>
<div class="level5">

<p>
Disable gateway redirection in the client if you don&#039;t need to route all traffic through <abbr title="Virtual Private Network">VPN</abbr>.
</p>
<pre class="code bash">uci <span class="kw1">set</span> network.vpn.defaultroute=<span class="st0">&quot;0&quot;</span>
uci commit network
service network restart</pre>

</div>

<h5 id="split_gateway">Split gateway</h5>
<div class="level5">

<p>
If <abbr title="Virtual Private Network">VPN</abbr> gateway is separate from your <abbr title="Local Area Network">LAN</abbr> gateway.
Implement plain routing between <abbr title="Local Area Network">LAN</abbr> and <abbr title="Virtual Private Network">VPN</abbr> networks assuming that:
</p>
<ul>
<li class="level1"><div class="li"> <code>192.168.1.0/24</code> - <abbr title="Local Area Network">LAN</abbr> network</div>
</li>
<li class="level1"><div class="li"> <code>192.168.1.2/24</code> - <abbr title="Virtual Private Network">VPN</abbr> gateway</div>
</li>
<li class="level1"><div class="li"> <code>192.168.9.0/24</code> - <abbr title="Virtual Private Network">VPN</abbr> network</div>
</li>
</ul>

<p>
Add port forwarding for <abbr title="Virtual Private Network">VPN</abbr> server on <abbr title="Local Area Network">LAN</abbr> gateway.
</p>
<pre class="code bash">uci <span class="re5">-q</span> delete firewall.oc
uci <span class="kw1">set</span> firewall.oc=<span class="st0">&quot;redirect&quot;</span>
uci <span class="kw1">set</span> firewall.oc.name=<span class="st0">&quot;Redirect-OpenConnect&quot;</span>
uci <span class="kw1">set</span> firewall.oc.src=<span class="st0">&quot;wan&quot;</span>
uci <span class="kw1">set</span> firewall.oc.src_dport=<span class="st0">&quot;4443&quot;</span>
uci <span class="kw1">set</span> firewall.oc.dest=<span class="st0">&quot;lan&quot;</span>
uci <span class="kw1">set</span> firewall.oc.dest_ip=<span class="st0">&quot;192.168.1.2&quot;</span>
uci <span class="kw1">set</span> firewall.oc.family=<span class="st0">&quot;ipv4&quot;</span>
uci <span class="kw1">set</span> firewall.oc.proto=<span class="st0">&quot;tcp udp&quot;</span>
uci <span class="kw1">set</span> firewall.oc.target=<span class="st0">&quot;DNAT&quot;</span>
uci commit firewall
service firewall restart</pre>

<p>
Add route to <abbr title="Virtual Private Network">VPN</abbr> network via <abbr title="Virtual Private Network">VPN</abbr> gateway on <abbr title="Local Area Network">LAN</abbr> gateway.
</p>
<pre class="code bash">uci <span class="re5">-q</span> delete network.vpn
uci <span class="kw1">set</span> network.vpn=<span class="st0">&quot;route&quot;</span>
uci <span class="kw1">set</span> network.vpn.interface=<span class="st0">&quot;lan&quot;</span>
uci <span class="kw1">set</span> network.vpn.target=<span class="st0">&quot;192.168.9.0/24&quot;</span>
uci <span class="kw1">set</span> network.vpn.gateway=<span class="st0">&quot;192.168.1.2&quot;</span>
uci commit network
service network restart</pre>

</div>

<h5 id="ipv6_gateway">IPv6 gateway</h5>
<div class="level5">

<p>
Set up <a href="/docs/guide-user/network/ipv6/ipv6_henet" class="wikilink1" title="docs:guide-user:network:ipv6:ipv6_henet" data-wiki-id="docs:guide-user:network:ipv6:ipv6_henet">IPv6 tunnel broker</a> or use <a href="/docs/guide-user/firewall/fw3_configurations/fw3_nat#ipv6_nat" class="wikilink1" title="docs:guide-user:firewall:fw3_configurations:fw3_nat" data-wiki-id="docs:guide-user:firewall:fw3_configurations:fw3_nat">IPv6 NAT or NPT</a> if necessary.
Enable <abbr title="Internet Protocol version 6">IPv6</abbr> tunnel on <abbr title="Virtual Private Network">VPN</abbr> server, offer <abbr title="Internet Protocol version 6">IPv6</abbr> <abbr title="Domain Name System">DNS</abbr>, redirect <abbr title="Internet Protocol version 6">IPv6</abbr> gateway.
</p>
<pre class="code bash"><span class="re2">VPN_POOL6</span>=<span class="st0">&quot;fd00:9::/64&quot;</span>
<span class="re2">VPN_DNS6</span>=<span class="st0">&quot;<span class="es3">${VPN_POOL6%:*}</span>:1&quot;</span>
uci <span class="kw1">set</span> ocserv.config.ip6<span class="re2">addr</span>=<span class="st0">&quot;<span class="es3">${VPN_POOL6}</span>&quot;</span>
uci <span class="re5">-q</span> delete ocserv.dns6
uci <span class="kw1">set</span> ocserv.dns6=<span class="st0">&quot;dns&quot;</span>
uci <span class="kw1">set</span> ocserv.dns6.ip=<span class="st0">&quot;<span class="es3">${VPN_DNS6}</span>&quot;</span>
uci commit ocserv
service ocserv restart</pre>

<p>
Disable <a href="/docs/guide-user/network/ipv6/ipv6_extras#disabling_gua_prefix" class="wikilink1" title="docs:guide-user:network:ipv6:ipv6_extras" data-wiki-id="docs:guide-user:network:ipv6:ipv6_extras">ISP prefix delegation</a> to prevent <abbr title="Internet Protocol version 6">IPv6</abbr> leaks on <abbr title="Virtual Private Network">VPN</abbr> client.
</p>

</div>

<h5 id="dns_over_vpn">DNS over VPN</h5>
<div class="level5">

</div>
<!-- EDIT{&quot;target&quot;:&quot;plugin_include_start&quot;,&quot;name&quot;:&quot;docs:guide-user:services:vpn:wireguard:extras&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:25,&quot;range&quot;:&quot;0-&quot;} --><div class="plugin_include_content plugin_include__docs:guide-user:services:vpn:wireguard:extras">
<div class="level5">

<p>
<a href="/docs/guide-user/base-system/dhcp_configuration#providing_dns_for_non-local_networks" class="wikilink1" title="docs:guide-user:base-system:dhcp_configuration" data-wiki-id="docs:guide-user:base-system:dhcp_configuration">Serve DNS</a> for <abbr title="Virtual Private Network">VPN</abbr> clients on OpenWrt server when using point-to-point topology.
</p>

<p>
Route <abbr title="Domain Name System">DNS</abbr> over <abbr title="Virtual Private Network">VPN</abbr> to prevent <abbr title="Domain Name System">DNS</abbr> leaks on <abbr title="Virtual Private Network">VPN</abbr> client.
</p>

<p>
<a href="/docs/guide-user/base-system/dhcp_configuration#upstream_dns_provider" class="wikilink1" title="docs:guide-user:base-system:dhcp_configuration" data-wiki-id="docs:guide-user:base-system:dhcp_configuration">Replace peer DNS</a> with public or <abbr title="Virtual Private Network">VPN</abbr>-specific <abbr title="Domain Name System">DNS</abbr> provider on OpenWrt client.
</p>

<p>
Modify the <abbr title="Virtual Private Network">VPN</abbr> connection using NetworkManager on Linux desktop client.
</p>
<pre class="code bash">nmcli connection modify <span class="kw2">id</span> VPN_CON \
ipv4.dns-search ~. ipv4.dns-priority <span class="re5">-50</span> \
ipv6.dns-search ~. ipv6.dns-priority <span class="re5">-50</span></pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;plugin_include_end&quot;,&quot;name&quot;:&quot;docs:guide-user:services:vpn:wireguard:extras&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:26,&quot;range&quot;:&quot;0-&quot;} --></div>
<div class="level6">

</div>

<h5 id="kill_switch">Kill switch</h5>
<div class="level5">

</div>
<!-- EDIT{&quot;target&quot;:&quot;plugin_include_start&quot;,&quot;name&quot;:&quot;docs:guide-user:services:vpn:wireguard:extras&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:27,&quot;range&quot;:&quot;0-&quot;} --><div class="plugin_include_content plugin_include__docs:guide-user:services:vpn:wireguard:extras">
<div class="level5">

<p>
Prevent traffic leaks on OpenWrt client isolating <abbr title="Virtual Private Network">VPN</abbr> interface in a separate firewall zone.
</p>
<pre class="code bash">uci <span class="re5">-q</span> delete firewall.vpn
uci <span class="kw1">set</span> firewall.vpn=<span class="st0">&quot;zone&quot;</span>
uci <span class="kw1">set</span> firewall.vpn.name=<span class="st0">&quot;vpn&quot;</span>
uci <span class="kw1">set</span> firewall.vpn.input=<span class="st0">&quot;REJECT&quot;</span>
uci <span class="kw1">set</span> firewall.vpn.output=<span class="st0">&quot;ACCEPT&quot;</span>
uci <span class="kw1">set</span> firewall.vpn.forward=<span class="st0">&quot;REJECT&quot;</span>
uci <span class="kw1">set</span> firewall.vpn.masq=<span class="st0">&quot;1&quot;</span>
uci <span class="kw1">set</span> firewall.vpn.mtu_fix=<span class="st0">&quot;1&quot;</span>
uci add_list firewall.vpn.network=<span class="st0">&quot;vpn&quot;</span>
uci del_list firewall.wan.network=<span class="st0">&quot;vpn&quot;</span>
uci <span class="re5">-q</span> delete firewall.<span class="sy0">@</span>forwarding<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span>
uci <span class="kw1">set</span> firewall.lan_vpn=<span class="st0">&quot;forwarding&quot;</span>
uci <span class="kw1">set</span> firewall.lan_vpn.src=<span class="st0">&quot;lan&quot;</span>
uci <span class="kw1">set</span> firewall.lan_vpn.dest=<span class="st0">&quot;vpn&quot;</span>
uci commit firewall
service firewall restart</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;plugin_include_end&quot;,&quot;name&quot;:&quot;docs:guide-user:services:vpn:wireguard:extras&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:28,&quot;range&quot;:&quot;0-&quot;} --></div>
<div class="level6">

</div>

<h5 id="multi-client">Multi-client</h5>
<div class="level5">

<p>
Generate <a href="/docs/guide-user/services/vpn/openconnect/server#key_management" class="wikilink1" title="docs:guide-user:services:vpn:openconnect:server" data-wiki-id="docs:guide-user:services:vpn:openconnect:server">password hash</a> for a new <abbr title="Virtual Private Network">VPN</abbr> client.
Set up multi-client <abbr title="Virtual Private Network">VPN</abbr> server.
Use unique credentials for each client.
</p>
<pre class="code bash"><span class="co0"># Configure VPN service</span>
<span class="re2">VPN_USER</span>=<span class="st0">&quot;USERNAME1&quot;</span>
<span class="re2">VPN_PASS</span>=<span class="st0">&quot;PASSWORD1&quot;</span>
uci <span class="re5">-q</span> delete ocserv.client1
uci <span class="kw1">set</span> ocserv.client1=<span class="st0">&quot;ocservusers&quot;</span>
uci <span class="kw1">set</span> ocserv.client1.name=<span class="st0">&quot;<span class="es3">${VPN_USER}</span>&quot;</span>
uci <span class="kw1">set</span> ocserv.client1.password=<span class="st0">&quot;<span class="es3">${VPN_HASH}</span>&quot;</span>
uci commit ocserv
service ocserv restart</pre>

</div>

<h5 id="automated">Automated</h5>
<div class="level5">

<p>
Automated <abbr title="Virtual Private Network">VPN</abbr> server installation.
</p>
<pre class="code bash"><span class="re2">URL</span>=<span class="st0">&quot;https://openwrt.org/_export/code/docs/guide-user/services/vpn/openconnect/server&quot;</span>
<span class="kw2">cat</span> <span class="sy0">&lt;&lt;</span> EOF <span class="sy0">&gt;</span> openconnect-server.sh
$<span class="br0">&#40;</span><span class="kw2">wget</span> <span class="re5">-U</span> <span class="st0">&quot;&quot;</span> <span class="re5">-O</span> - <span class="st0">&quot;<span class="es3">${URL}</span>?codeblock=0&quot;</span><span class="br0">&#41;</span>
$<span class="br0">&#40;</span><span class="kw2">wget</span> <span class="re5">-U</span> <span class="st0">&quot;&quot;</span> <span class="re5">-O</span> - <span class="st0">&quot;<span class="es3">${URL}</span>?codeblock=1&quot;</span><span class="br0">&#41;</span>
$<span class="br0">&#40;</span><span class="kw2">wget</span> <span class="re5">-U</span> <span class="st0">&quot;&quot;</span> <span class="re5">-O</span> - <span class="st0">&quot;<span class="es3">${URL}</span>?codeblock=2&quot;</span><span class="br0">&#41;</span>
$<span class="br0">&#40;</span><span class="kw2">wget</span> <span class="re5">-U</span> <span class="st0">&quot;&quot;</span> <span class="re5">-O</span> - <span class="st0">&quot;<span class="es3">${URL}</span>?codeblock=3&quot;</span><span class="br0">&#41;</span>
EOF
<span class="kw2">sh</span> openconnect-server.sh</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;plugin_include_end&quot;,&quot;name&quot;:&quot;docs:guide-user:services:vpn:openconnect:extras&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:18,&quot;range&quot;:&quot;0-&quot;} --></div>
<div class="level3">

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Default gateway&quot;,&quot;hid&quot;:&quot;default_gateway&quot;,&quot;codeblockOffset&quot;:6,&quot;secid&quot;:16,&quot;range&quot;:&quot;2760-2893&quot;} -->
<h3 class="sectionedit29" id="split_gateway1">Split gateway</h3>
<div class="level3">

<p>
If <abbr title="Virtual Private Network">VPN</abbr> gateway is separate from your <abbr title="Local Area Network">LAN</abbr> gateway.
Implement plain routing between <abbr title="Local Area Network">LAN</abbr> and <abbr title="Virtual Private Network">VPN</abbr> networks assuming that:
</p>
<ul>
<li class="level1"><div class="li"> <code>192.168.1.0/24</code> - <abbr title="Local Area Network">LAN</abbr> network</div>
</li>
<li class="level1"><div class="li"> <code>192.168.1.2/24</code> - <abbr title="Virtual Private Network">VPN</abbr> gateway</div>
</li>
<li class="level1"><div class="li"> <code>192.168.9.0/24</code> - <abbr title="Virtual Private Network">VPN</abbr> network</div>
</li>
</ul>

<p>
Add port forwarding for <abbr title="Virtual Private Network">VPN</abbr> server on <abbr title="Local Area Network">LAN</abbr> gateway.
</p>
<pre class="code bash">uci <span class="re5">-q</span> delete firewall.pptp
uci <span class="kw1">set</span> firewall.pptp=<span class="st0">&quot;redirect&quot;</span>
uci <span class="kw1">set</span> firewall.pptp.name=<span class="st0">&quot;Redirect-PPTP&quot;</span>
uci <span class="kw1">set</span> firewall.pptp.src=<span class="st0">&quot;wan&quot;</span>
uci <span class="kw1">set</span> firewall.pptp.src_dport=<span class="st0">&quot;1723&quot;</span>
uci <span class="kw1">set</span> firewall.pptp.dest=<span class="st0">&quot;lan&quot;</span>
uci <span class="kw1">set</span> firewall.pptp.dest_ip=<span class="st0">&quot;192.168.1.2&quot;</span>
uci <span class="kw1">set</span> firewall.pptp.family=<span class="st0">&quot;ipv4&quot;</span>
uci <span class="kw1">set</span> firewall.pptp.proto=<span class="st0">&quot;tcp&quot;</span>
uci <span class="kw1">set</span> firewall.pptp.target=<span class="st0">&quot;DNAT&quot;</span>
uci commit firewall
service firewall restart</pre>

<p>
Add route to <abbr title="Virtual Private Network">VPN</abbr> network via <abbr title="Virtual Private Network">VPN</abbr> gateway on <abbr title="Local Area Network">LAN</abbr> gateway.
</p>
<pre class="code bash">uci <span class="re5">-q</span> delete network.vpn
uci <span class="kw1">set</span> network.vpn=<span class="st0">&quot;route&quot;</span>
uci <span class="kw1">set</span> network.vpn.interface=<span class="st0">&quot;lan&quot;</span>
uci <span class="kw1">set</span> network.vpn.target=<span class="st0">&quot;192.168.9.0/24&quot;</span>
uci <span class="kw1">set</span> network.vpn.gateway=<span class="st0">&quot;192.168.1.2&quot;</span>
uci commit network
service network restart</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Split gateway&quot;,&quot;hid&quot;:&quot;split_gateway1&quot;,&quot;codeblockOffset&quot;:16,&quot;secid&quot;:29,&quot;range&quot;:&quot;2894-3921&quot;} -->
<h3 class="sectionedit30" id="ipv6_gateway1">IPv6 gateway</h3>
<div class="level3">

<p>
Set up <a href="/docs/guide-user/network/ipv6/ipv6_henet" class="wikilink1" title="docs:guide-user:network:ipv6:ipv6_henet" data-wiki-id="docs:guide-user:network:ipv6:ipv6_henet">IPv6 tunnel broker</a> or use <a href="/docs/guide-user/firewall/fw3_configurations/fw3_nat#ipv6_nat" class="wikilink1" title="docs:guide-user:firewall:fw3_configurations:fw3_nat" data-wiki-id="docs:guide-user:firewall:fw3_configurations:fw3_nat">IPv6 NAT or NPT</a> if necessary.
Configure <abbr title="Internet Protocol version 6">IPv6</abbr> on <abbr title="Virtual Private Network">VPN</abbr> server.
</p>
<pre class="code bash"><span class="kw2">cat</span> <span class="sy0">&lt;&lt;</span> <span class="st0">&quot;EOF&quot;</span> <span class="sy0">&gt;</span> <span class="sy0">/</span>etc<span class="sy0">/</span>ppp<span class="sy0">/</span>ip-up
<span class="co0">#!/bin/sh</span>
<span class="kw2">ip</span> address add fd00:<span class="nu0">9</span>::<span class="nu0">1</span><span class="sy0">/</span><span class="nu0">64</span> dev <span class="co1">${IFNAME}</span>
EOF
<span class="kw2">chmod</span> +x <span class="sy0">/</span>etc<span class="sy0">/</span>ppp<span class="sy0">/</span>ip-up</pre>

<p>
Configure <abbr title="Internet Protocol version 6">IPv6</abbr> on <abbr title="Virtual Private Network">VPN</abbr> client, redirect <abbr title="Internet Protocol version 6">IPv6</abbr> gateway.
</p>
<pre class="code bash">uci add_list firewall.wan.network=<span class="st0">&quot;vpn6&quot;</span>
uci commit firewall
service firewall restart
uci <span class="re5">-q</span> delete network.vpn6
uci <span class="kw1">set</span> network.vpn6=<span class="st0">&quot;interface&quot;</span>
uci <span class="kw1">set</span> network.vpn6.proto=<span class="st0">&quot;static&quot;</span>
uci <span class="kw1">set</span> network.vpn6.device=<span class="st0">&quot;@vpn&quot;</span>
uci <span class="kw1">set</span> network.vpn6.ip6<span class="re2">addr</span>=<span class="st0">&quot;fd00:9::2/64&quot;</span>
uci <span class="re5">-q</span> delete network.vpn6_rt
uci <span class="kw1">set</span> network.vpn6<span class="re2">_rt</span>=<span class="st0">&quot;route6&quot;</span>
uci <span class="kw1">set</span> network.vpn6_rt.interface=<span class="st0">&quot;vpn6&quot;</span>
uci <span class="kw1">set</span> network.vpn6_rt.target=<span class="st0">&quot;::/0&quot;</span>
uci commit network
service network restart</pre>

<p>
Disable <a href="/docs/guide-user/network/ipv6/ipv6_extras#disabling_gua_prefix" class="wikilink1" title="docs:guide-user:network:ipv6:ipv6_extras" data-wiki-id="docs:guide-user:network:ipv6:ipv6_extras">ISP prefix delegation</a> to prevent <abbr title="Internet Protocol version 6">IPv6</abbr> leaks on <abbr title="Virtual Private Network">VPN</abbr> client.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;IPv6 gateway&quot;,&quot;hid&quot;:&quot;ipv6_gateway1&quot;,&quot;codeblockOffset&quot;:18,&quot;secid&quot;:30,&quot;range&quot;:&quot;3922-4933&quot;} -->
<h3 class="sectionedit31" id="dns_over_vpn1">DNS over VPN</h3>
<div class="level3">

</div>
<!-- EDIT{&quot;target&quot;:&quot;plugin_include_start&quot;,&quot;name&quot;:&quot;docs:guide-user:services:vpn:wireguard:extras&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:32,&quot;range&quot;:&quot;0-&quot;} --><div class="plugin_include_content plugin_include__docs:guide-user:services:vpn:wireguard:extras">
<div class="level3">

<p>
<a href="/docs/guide-user/base-system/dhcp_configuration#providing_dns_for_non-local_networks" class="wikilink1" title="docs:guide-user:base-system:dhcp_configuration" data-wiki-id="docs:guide-user:base-system:dhcp_configuration">Serve DNS</a> for <abbr title="Virtual Private Network">VPN</abbr> clients on OpenWrt server when using point-to-point topology.
</p>

<p>
Route <abbr title="Domain Name System">DNS</abbr> over <abbr title="Virtual Private Network">VPN</abbr> to prevent <abbr title="Domain Name System">DNS</abbr> leaks on <abbr title="Virtual Private Network">VPN</abbr> client.
</p>

<p>
<a href="/docs/guide-user/base-system/dhcp_configuration#upstream_dns_provider" class="wikilink1" title="docs:guide-user:base-system:dhcp_configuration" data-wiki-id="docs:guide-user:base-system:dhcp_configuration">Replace peer DNS</a> with public or <abbr title="Virtual Private Network">VPN</abbr>-specific <abbr title="Domain Name System">DNS</abbr> provider on OpenWrt client.
</p>

<p>
Modify the <abbr title="Virtual Private Network">VPN</abbr> connection using NetworkManager on Linux desktop client.
</p>
<pre class="code bash">nmcli connection modify <span class="kw2">id</span> VPN_CON \
ipv4.dns-search ~. ipv4.dns-priority <span class="re5">-50</span> \
ipv6.dns-search ~. ipv6.dns-priority <span class="re5">-50</span></pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;plugin_include_end&quot;,&quot;name&quot;:&quot;docs:guide-user:services:vpn:wireguard:extras&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:33,&quot;range&quot;:&quot;0-&quot;} --></div>
<div class="level3">

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;DNS over VPN&quot;,&quot;hid&quot;:&quot;dns_over_vpn1&quot;,&quot;codeblockOffset&quot;:20,&quot;secid&quot;:31,&quot;range&quot;:&quot;4934-5059&quot;} -->
<h3 class="sectionedit34" id="kill_switch1">Kill switch</h3>
<div class="level3">

</div>
<!-- EDIT{&quot;target&quot;:&quot;plugin_include_start&quot;,&quot;name&quot;:&quot;docs:guide-user:services:vpn:wireguard:extras&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:35,&quot;range&quot;:&quot;0-&quot;} --><div class="plugin_include_content plugin_include__docs:guide-user:services:vpn:wireguard:extras">
<div class="level3">

<p>
Prevent traffic leaks on OpenWrt client isolating <abbr title="Virtual Private Network">VPN</abbr> interface in a separate firewall zone.
</p>
<pre class="code bash">uci <span class="re5">-q</span> delete firewall.vpn
uci <span class="kw1">set</span> firewall.vpn=<span class="st0">&quot;zone&quot;</span>
uci <span class="kw1">set</span> firewall.vpn.name=<span class="st0">&quot;vpn&quot;</span>
uci <span class="kw1">set</span> firewall.vpn.input=<span class="st0">&quot;REJECT&quot;</span>
uci <span class="kw1">set</span> firewall.vpn.output=<span class="st0">&quot;ACCEPT&quot;</span>
uci <span class="kw1">set</span> firewall.vpn.forward=<span class="st0">&quot;REJECT&quot;</span>
uci <span class="kw1">set</span> firewall.vpn.masq=<span class="st0">&quot;1&quot;</span>
uci <span class="kw1">set</span> firewall.vpn.mtu_fix=<span class="st0">&quot;1&quot;</span>
uci add_list firewall.vpn.network=<span class="st0">&quot;vpn&quot;</span>
uci del_list firewall.wan.network=<span class="st0">&quot;vpn&quot;</span>
uci <span class="re5">-q</span> delete firewall.<span class="sy0">@</span>forwarding<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span>
uci <span class="kw1">set</span> firewall.lan_vpn=<span class="st0">&quot;forwarding&quot;</span>
uci <span class="kw1">set</span> firewall.lan_vpn.src=<span class="st0">&quot;lan&quot;</span>
uci <span class="kw1">set</span> firewall.lan_vpn.dest=<span class="st0">&quot;vpn&quot;</span>
uci commit firewall
service firewall restart</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;plugin_include_end&quot;,&quot;name&quot;:&quot;docs:guide-user:services:vpn:wireguard:extras&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:36,&quot;range&quot;:&quot;0-&quot;} --></div>
<div class="level3">

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Kill switch&quot;,&quot;hid&quot;:&quot;kill_switch1&quot;,&quot;codeblockOffset&quot;:21,&quot;secid&quot;:34,&quot;range&quot;:&quot;5060-5183&quot;} -->
<h3 class="sectionedit37" id="multi-client1">Multi-client</h3>
<div class="level3">

<p>
Set up multi-client <abbr title="Virtual Private Network">VPN</abbr> server.
Use unique credentials for each client.
</p>
<pre class="code bash"><span class="co0"># Configure VPN service</span>
<span class="re2">VPN_USER</span>=<span class="st0">&quot;USERNAME1&quot;</span>
<span class="re2">VPN_PASS</span>=<span class="st0">&quot;PASSWORD1&quot;</span>
uci <span class="re5">-q</span> delete pptpd.client1
uci <span class="kw1">set</span> pptpd.client1=<span class="st0">&quot;login&quot;</span>
uci <span class="kw1">set</span> pptpd.client1.username=<span class="st0">&quot;<span class="es3">${VPN_USER}</span>&quot;</span>
uci <span class="kw1">set</span> pptpd.client1.password=<span class="st0">&quot;<span class="es3">${VPN_PASS}</span>&quot;</span>
uci commit pptpd
service pptpd restart</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Multi-client&quot;,&quot;hid&quot;:&quot;multi-client1&quot;,&quot;codeblockOffset&quot;:22,&quot;secid&quot;:37,&quot;range&quot;:&quot;5184-5553&quot;} -->
<h3 class="sectionedit38" id="automated1">Automated</h3>
<div class="level3">

<p>
Automated <abbr title="Virtual Private Network">VPN</abbr> server installation.
</p>
<pre class="code bash"><span class="re2">URL</span>=<span class="st0">&quot;https://openwrt.org/_export/code/docs/guide-user/services/vpn/pptp/server&quot;</span>
<span class="kw2">cat</span> <span class="sy0">&lt;&lt;</span> EOF <span class="sy0">&gt;</span> pptp-server.sh
$<span class="br0">&#40;</span><span class="kw2">wget</span> <span class="re5">-U</span> <span class="st0">&quot;&quot;</span> <span class="re5">-O</span> - <span class="st0">&quot;<span class="es3">${URL}</span>?codeblock=0&quot;</span><span class="br0">&#41;</span>
$<span class="br0">&#40;</span><span class="kw2">wget</span> <span class="re5">-U</span> <span class="st0">&quot;&quot;</span> <span class="re5">-O</span> - <span class="st0">&quot;<span class="es3">${URL}</span>?codeblock=1&quot;</span><span class="br0">&#41;</span>
$<span class="br0">&#40;</span><span class="kw2">wget</span> <span class="re5">-U</span> <span class="st0">&quot;&quot;</span> <span class="re5">-O</span> - <span class="st0">&quot;<span class="es3">${URL}</span>?codeblock=2&quot;</span><span class="br0">&#41;</span>
EOF
<span class="kw2">sh</span> pptp-server.sh</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Automated&quot;,&quot;hid&quot;:&quot;automated1&quot;,&quot;codeblockOffset&quot;:23,&quot;secid&quot;:38,&quot;range&quot;:&quot;5554-&quot;} -->