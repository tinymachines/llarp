
<h1 class="sectionedit1" id="openvpn_client_using_luci">OpenVPN client using LuCI</h1>
<div class="level1">

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;OpenVPN client using LuCI&quot;,&quot;hid&quot;:&quot;openvpn_client_using_luci&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:1,&quot;range&quot;:&quot;1-40&quot;} -->
<h2 class="sectionedit2" id="introduction">Introduction</h2>
<div class="level2">
<ul>
<li class="level1"><div class="li"> This guide describes how install and operate the <a href="https://en.wikipedia.org/wiki/OpenVPN" class="interwiki iw_wp" title="https://en.wikipedia.org/wiki/OpenVPN">OpenVPN</a> client using LuCI web interface.</div>
</li>
<li class="level1"><div class="li"> You can use it to connect to your own OpenVPN server or a commercial OpenVPN provider.</div>
</li>
<li class="level1"><div class="li"> Follow <a href="/docs/guide-user/services/vpn/openvpn/server" class="wikilink1" title="docs:guide-user:services:vpn:openvpn:server" data-wiki-id="docs:guide-user:services:vpn:openvpn:server">OpenVPN basic</a> for server setup and <a href="/docs/guide-user/services/vpn/openvpn/extras" class="wikilink1" title="docs:guide-user:services:vpn:openvpn:extras" data-wiki-id="docs:guide-user:services:vpn:openvpn:extras">OpenVPN extras</a> for additional tuning.</div>
</li>
<li class="level1"><div class="li"> The performance of different SoCs can be found here <a href="/docs/guide-user/services/vpn/openvpn/performance" class="wikilink1" title="docs:guide-user:services:vpn:openvpn:performance" data-wiki-id="docs:guide-user:services:vpn:openvpn:performance">OpenVPN performance</a>.</div>
</li>
</ul>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Introduction&quot;,&quot;hid&quot;:&quot;introduction&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:2,&quot;range&quot;:&quot;41-576&quot;} -->
<h2 class="sectionedit3" id="goals">Goals</h2>
<div class="level2">

</div>
<!-- EDIT{&quot;target&quot;:&quot;plugin_include_start&quot;,&quot;name&quot;:&quot;docs:guide-user:services:vpn:wireguard:server&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:4,&quot;range&quot;:&quot;0-&quot;} --><div class="plugin_include_content plugin_include__docs:guide-user:services:vpn:wireguard:server">
<div class="level2">
<ul>
<li class="level1 node"><div class="li"> Encrypt your internet connection to enforce security and privacy.</div>
<ul>
<li class="level2"><div class="li"> Prevent traffic leaks and spoofing on the client side.</div>
</li>
</ul>
</li>
<li class="level1 node"><div class="li"> Bypass regional restrictions using commercial providers.</div>
<ul>
<li class="level2"><div class="li"> Escape client side content filters and internet censorship.</div>
</li>
</ul>
</li>
<li class="level1"><div class="li"> Access your <abbr title="Local Area Network">LAN</abbr> services remotely without port forwarding.</div>
</li>
</ul>

</div>
<!-- EDIT{&quot;target&quot;:&quot;plugin_include_end&quot;,&quot;name&quot;:&quot;docs:guide-user:services:vpn:wireguard:server&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:5,&quot;range&quot;:&quot;0-&quot;} --></div>
<div class="level2">

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Goals&quot;,&quot;hid&quot;:&quot;goals&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:3,&quot;range&quot;:&quot;577-690&quot;} -->
<h2 class="sectionedit6" id="web_interface_instructions">Web interface instructions</h2>
<div class="level2">

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Web interface instructions&quot;,&quot;hid&quot;:&quot;web_interface_instructions&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:6,&quot;range&quot;:&quot;691-729&quot;} -->
<h3 class="sectionedit7" id="install_needed_packages">1. Install needed packages</h3>
<div class="level3">

<p>
Install <a href="/packages/pkgdata/openvpn-openssl" class="wikilink1" title="packages:pkgdata:openvpn-openssl" data-wiki-id="packages:pkgdata:openvpn-openssl">openvpn-openssl</a> and <a href="/packages/pkgdata/luci-app-openvpn" class="wikilink1" title="packages:pkgdata:luci-app-openvpn" data-wiki-id="packages:pkgdata:luci-app-openvpn">luci-app-openvpn</a> to be able to manage OpenVPN using web interface.
</p>

<p>
A new page in the LuCI web interface should appear.
</p>

<p>
Navigate to <strong>LuCI → <abbr title="Virtual Private Network">VPN</abbr> → OpenVPN</strong> to open the OpenVPN config management page.
</p>

<p>
<a href="/_media/docs/guide-user/services/vpn/openvpn/openwrt_openvpn_client_1_.png" class="media" title="docs:guide-user:services:vpn:openvpn:openwrt_openvpn_client_1_.png"><img src="/_media/docs/guide-user/services/vpn/openvpn/openwrt_openvpn_client_1_.png?w=600&amp;tok=80c6a7" class="media" loading="lazy" alt="" width="600" /></a>
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;1. Install needed packages&quot;,&quot;hid&quot;:&quot;install_needed_packages&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:7,&quot;range&quot;:&quot;730-1125&quot;} -->
<h3 class="sectionedit8" id="a_write_the_configuration_manually_to_create_a_config_file">2.a Write the configuration manually to create a config file</h3>
<div class="level3">

<p>
Create a new config with the <strong>Template-based configuration</strong> line by choosing the template, writing a name and clicking <strong>Add</strong> button to create it.
</p>

<p>
Then it will appear in the table and you can edit this configuration file by clicking on <strong>Edit</strong> button to open the edit page for this configuration.
</p>

<p>
<a href="/_media/docs/guide-user/services/vpn/openvpn/openwrt_openvpn_client_2_create_openvpn_config.png" class="media" title="docs:guide-user:services:vpn:openvpn:openwrt_openvpn_client_2_create_openvpn_config.png"><img src="/_media/docs/guide-user/services/vpn/openvpn/openwrt_openvpn_client_2_create_openvpn_config.png?w=600&amp;tok=9906ea" class="media" loading="lazy" alt="" width="600" /></a>
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;2.a Write the configuration manually to create a config file&quot;,&quot;hid&quot;:&quot;a_write_the_configuration_manually_to_create_a_config_file&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:8,&quot;range&quot;:&quot;1126-1604&quot;} -->
<h3 class="sectionedit9" id="b_upload_a_openvpn_config_file">2.b Upload a OpenVPN config file</h3>
<div class="level3">
<!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_start&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:10,&quot;range&quot;:&quot;0-&quot;} --><div class="wrap_center wrap_round wrap_important plugin_wrap" style="width: 80%;">
<p>
This is available from OpenWrt 19.07 onwards.
</p>
</div><!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_end&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:11,&quot;range&quot;:&quot;0-&quot;} -->
<p>
All self-respecting commercial OpenVPN providers will offer self-sufficient OpenVPN config files you can load in your consumer router or network appliance to connect to their service.
</p>

<p>
You can use them in OpenWrt too.
</p>

<p>
Use the <strong>OVPN configuration file upload</strong> to give a name and upload one of such config files.
</p>

<p>
It will appear in the table of available OpenVPN configurations.
</p>

<p>
If your provider requires you to write your username and a password, click on the Edit button, and in the edit page, write your username and password in the second text box, as shown in this example
</p>

<p>
<a href="/_media/docs/guide-user/services/vpn/openvpn/openwrt_openvpn_client_2_upload_openvpn_config_add_user_pass.png" class="media" title="docs:guide-user:services:vpn:openvpn:openwrt_openvpn_client_2_upload_openvpn_config_add_user_pass.png"><img src="/_media/docs/guide-user/services/vpn/openvpn/openwrt_openvpn_client_2_upload_openvpn_config_add_user_pass.png?w=600&amp;tok=a942ec" class="media" loading="lazy" alt="" width="600" /></a>
</p>

<p>
Now edit the line beginning <strong>auth-user-pass</strong> in the first text box to included the full path to the username/password .auth file.
The full path is visible just above the second text box.
For above example:
</p>
<pre class="code">auth-user-pass /etc/openvpn/NLMiramUDP443E3.auth</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;2.b Upload a OpenVPN config file&quot;,&quot;hid&quot;:&quot;b_upload_a_openvpn_config_file&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:9,&quot;range&quot;:&quot;1605-2707&quot;} -->
<h3 class="sectionedit12" id="start_and_enable_the_client">3. Start and enable the client</h3>
<div class="level3">

<p>
Start the client by pressing on the <strong>Start</strong> button in the table of available configurations.
OpenVPN startup and shutdown are slow, it can take up to 10 seconds to complete.
</p>

<p>
If you want this <abbr title="Virtual Private Network">VPN</abbr> client connection to be started on boot and always active, click in the <strong>Enable</strong> checkbox of its line in the table.
</p>

<p>
<strong>Note:</strong> If clicking on <strong>Start</strong> button in the table does not start the <abbr title="Virtual Private Network">VPN</abbr> instance.
Tick the <strong>Enable</strong> checkbox, and press <strong>Save &amp; Apply</strong> button to start the <abbr title="Virtual Private Network">VPN</abbr> instance
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;3. Start and enable the client&quot;,&quot;hid&quot;:&quot;start_and_enable_the_client&quot;,&quot;codeblockOffset&quot;:1,&quot;secid&quot;:12,&quot;range&quot;:&quot;2708-3244&quot;} -->
<h3 class="sectionedit13" id="firewall">4. Firewall</h3>
<div class="level3">

<p>
At this point the <abbr title="Virtual Private Network">VPN</abbr> is set up and the router can use it, but devices in the <abbr title="Local Area Network">LAN</abbr> of your router won&#039;t be able to access the internet anymore.
</p>

<p>
We need to set the <abbr title="Virtual Private Network">VPN</abbr> network interface as public by assigning <abbr title="Virtual Private Network">VPN</abbr> interface to <abbr title="Wide Area Network">WAN</abbr> zone.
</p>

</div>

<h4 id="a_with_openwrt_up_to_1806_and_1907">4.1-a With Openwrt up to 18.06 and 19.07</h4>
<div class="level4">
<ol>
<li class="level1"><div class="li"> Click on <strong>Network</strong> in the top bar and then on <strong>Interfaces</strong> to open the interfaces configuration page.</div>
</li>
<li class="level1"><div class="li"> Click on button <strong>Add new Interface...</strong></div>
</li>
<li class="level1"><div class="li"> Fill the form with the following values: <strong>Name</strong> = <code>OpenVPN</code>, <strong>Protocol</strong> = <code>Unmanaged</code>, <strong>Interface</strong> = <code>tun0</code>. Then click on <strong>Create Interface</strong>.</div>
</li>
<li class="level1"><div class="li"> Edit the interface.</div>
</li>
<li class="level1"><div class="li"> In panel <strong>General Settings</strong>: unselect the checkbox <strong>Bring up on boot</strong>.</div>
</li>
<li class="level1"><div class="li"> In panel <strong>Firewall Settings</strong>: <strong>Assign firewall-zone</strong> to <code>wan</code>.</div>
</li>
<li class="level1"><div class="li"> Click on <strong>Save and Apply</strong> the new configuration.</div>
</li>
<li class="level1"><div class="li"> Reboot the router.</div>
</li>
</ol>

<p>
<a href="/_media/docs/guide-user/services/vpn/openvpn/openwrt_openvpn_client_4_firewall_alternate.png" class="media" title="docs:guide-user:services:vpn:openvpn:openwrt_openvpn_client_4_firewall_alternate.png"><img src="/_media/docs/guide-user/services/vpn/openvpn/openwrt_openvpn_client_4_firewall_alternate.png?w=600&amp;tok=f900ac" class="media" loading="lazy" alt="" width="600" /></a><br/>

</p>

<p>
<a href="/_media/docs/guide-user/services/vpn/openvpn/openwrt_openvpn_client_4_firewall_alternate_2.png" class="media" title="docs:guide-user:services:vpn:openvpn:openwrt_openvpn_client_4_firewall_alternate_2.png"><img src="/_media/docs/guide-user/services/vpn/openvpn/openwrt_openvpn_client_4_firewall_alternate_2.png?w=600&amp;tok=56a08a" class="media" loading="lazy" alt="" width="600" /></a><br/>

</p>

</div>

<h4 id="b_with_openwrt_1907_alternative_to_the_above_step_41">4.1-b With Openwrt 19.07 (alternative to the above step 4.1)</h4>
<div class="level4">

<p>
Click on <strong>Network</strong> in the top bar and then on <strong>Firewall</strong> to open the firewall configuration page.
</p>

<p>
Click on the <strong>Edit</strong> button of the <strong>wan</strong> (red) zone in the <strong>Zones</strong> list at the bottom of the page.
</p>

<p>
Click on the <strong>Advanced Settings</strong> tab and select the <strong>tunX</strong> interface (<strong>tun0</strong> in the screenshot, which is the most likely if you have a single OpenVPN client/server running)
</p>

<p>
<a href="/_media/docs/guide-user/services/vpn/openvpn/openwrt_openvpn_client_4_firewall.png" class="media" title="docs:guide-user:services:vpn:openvpn:openwrt_openvpn_client_4_firewall.png"><img src="/_media/docs/guide-user/services/vpn/openvpn/openwrt_openvpn_client_4_firewall.png?w=600&amp;tok=faebad" class="media" loading="lazy" alt="" width="600" /></a>
</p>

<p>
You can see the interface name if you click on <strong>Status</strong> on the top bar and then click on <strong>System Log</strong>.
</p>

<p>
A few lines from the system log where you can see the interface name of the OpenVPN client started with the configuration file <strong>NLMiramUDP443E3</strong>
</p>
<pre class="code"> Fri Aug 30 11:28:32 2019 daemon.notice openvpn(NLMiramUDP443E3)[7993]: TUN/TAP device tun0 opened
 Fri Aug 30 11:28:32 2019 daemon.notice openvpn(NLMiramUDP443E3)[7993]: TUN/TAP TX queue length set to 100
 Fri Aug 30 11:28:32 2019 daemon.notice openvpn(NLMiramUDP443E3)[7993]: /sbin/ifconfig tun0 10.24.74.134 netmask 255.255.255.0 mtu 1500 broadcast 10.24.74.255</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;4. Firewall&quot;,&quot;hid&quot;:&quot;firewall&quot;,&quot;codeblockOffset&quot;:1,&quot;secid&quot;:13,&quot;range&quot;:&quot;3245-5512&quot;} -->
<h3 class="sectionedit14" id="test_that_all_is_working">5. Test that all is working</h3>
<div class="level3">

</div>
<!-- EDIT{&quot;target&quot;:&quot;plugin_include_start&quot;,&quot;name&quot;:&quot;docs:guide-user:services:vpn:wireguard:server&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:15,&quot;range&quot;:&quot;0-&quot;} --><div class="plugin_include_content plugin_include__docs:guide-user:services:vpn:wireguard:server">
<div class="level3">

<p>
Establish the <abbr title="Virtual Private Network">VPN</abbr> connection.
Verify your routing with <a href="http://man.cx/traceroute%288%29" class="interwiki iw_man" title="http://man.cx/traceroute%288%29">traceroute</a> and <a href="http://man.cx/traceroute6%288%29" class="interwiki iw_man" title="http://man.cx/traceroute6%288%29">traceroute6</a>.
</p>
<pre class="code bash">traceroute openwrt.org
traceroute6 openwrt.org</pre>

<p>
Check your <abbr title="Internet Protocol">IP</abbr> and <abbr title="Domain Name System">DNS</abbr> provider.
</p>
<ul>
<li class="level1"><div class="li"> <a href="https://ipleak.net/" class="urlextern" title="https://ipleak.net/" rel="ugc nofollow">ipleak.net</a></div>
</li>
<li class="level1"><div class="li"> <a href="https://www.dnsleaktest.com/" class="urlextern" title="https://www.dnsleaktest.com/" rel="ugc nofollow">dnsleaktest.com</a></div>
</li>
</ul>

<p>
On router:
</p>
<ul>
<li class="level1"><div class="li"> Go to <strong>LuCI &gt; Status &gt; Wireguard</strong> and look for peer device connected with an <abbr title="Internet Protocol version 4">IPv4</abbr> or <abbr title="Internet Protocol version 6">IPv6</abbr> address and with a recent handshake time</div>
</li>
<li class="level1"><div class="li"> Go to <strong>LuCI &gt; Network &gt; Diagnostics</strong> and <strong>ipv4 ping</strong> client device <abbr title="Internet Protocol">IP</abbr> eg. 10.0.0.10</div>
</li>
</ul>

<p>
On client device depending on wireguard software:
</p>
<ul>
<li class="level1"><div class="li"> Check transfer traffic for tx &amp; rx</div>
</li>
<li class="level1"><div class="li"> Ping router internal lan <abbr title="Internet Protocol">IP</abbr></div>
</li>
<li class="level1"><div class="li"> Check public <abbr title="Internet Protocol">IP</abbr> address in a browser – <a href="https://whatsmyip.com" class="urlextern" title="https://whatsmyip.com" rel="ugc nofollow">https://whatsmyip.com</a> – should see public <abbr title="Internet Protocol">IP</abbr> address of <abbr title="Internet Service Provider">ISP</abbr> for the router</div>
</li>
</ul>

</div>
<!-- EDIT{&quot;target&quot;:&quot;plugin_include_end&quot;,&quot;name&quot;:&quot;docs:guide-user:services:vpn:wireguard:server&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:16,&quot;range&quot;:&quot;0-&quot;} --></div>
<div class="level3">

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;5. Test that all is working&quot;,&quot;hid&quot;:&quot;test_that_all_is_working&quot;,&quot;codeblockOffset&quot;:1,&quot;secid&quot;:14,&quot;range&quot;:&quot;5513-5648&quot;} -->
<h3 class="sectionedit17" id="enable_network_killswitch_optional_recommended">6. Enable Network Killswitch (Optional, Recommended)</h3>
<div class="level3">

<p>
The “Network Killswitch” functionality, forces all traffic to go through the <abbr title="Virtual Private Network">VPN</abbr>. It&#039;s a fancy name for what is actually just a firewall rule.<br/>

This is best for privacy and security as it will ensure that no traffic can reach the Internet bypassing the <abbr title="Virtual Private Network">VPN</abbr> you have set up.<br/>

This also means that if the <abbr title="Virtual Private Network">VPN</abbr> connection is terminated, you lose access to the Internet, since no traffic is allowed outside of your <abbr title="Virtual Private Network">VPN</abbr>.
</p>

<p>
If you are setting up a Killswitch, it&#039;s strongly recommended to set the OpenVPN client to start and connect automatically on boot with the “Enable” checkbox, so that if the router is rebooted you don&#039;t lose Internet access (as without a <abbr title="Virtual Private Network">VPN</abbr> connected you will not be able to access the Internet anymore).<br/>

</p>

<p>
First remove the <strong>tun</strong> interface from <strong>wan</strong> zone in case you have followed the previous step 4.<br/>

Go to <strong>Network</strong> -→ <strong>Firewall</strong>, click on the Edit button of the <strong>Lan</strong> zone.<br/>

</p>

<p>
Click on the Allow forward to destination zones: menu and deselect the <abbr title="Wide Area Network">WAN</abbr> zone, then click on Save.<br/>

</p>

<p>
<a href="/_media/docs/guide-user/services/vpn/openvpn/openwrt_openvpn_client_6_killswitch_4.png" class="media" title="docs:guide-user:services:vpn:openvpn:openwrt_openvpn_client_6_killswitch_4.png"><img src="/_media/docs/guide-user/services/vpn/openvpn/openwrt_openvpn_client_6_killswitch_4.png?w=600&amp;tok=1edcfc" class="media" loading="lazy" alt="" width="600" /></a><br/>

</p>

<p>
Then click on <strong>Add</strong> button under the <strong>Zones list</strong> to add a new zone.<br/>

Select <strong>Masquerading</strong>, <strong>MSS Clamping</strong> and select the <strong><abbr title="Local Area Network">LAN</abbr> interface</strong> in the <strong>Allow forward from source zones</strong> menu<br/>

</p>

<p>
<a href="/_media/docs/guide-user/services/vpn/openvpn/openwrt_openvpn_client_6_killswitch_1.png" class="media" title="docs:guide-user:services:vpn:openvpn:openwrt_openvpn_client_6_killswitch_1.png"><img src="/_media/docs/guide-user/services/vpn/openvpn/openwrt_openvpn_client_6_killswitch_1.png?w=600&amp;tok=4f4cdb" class="media" loading="lazy" alt="" width="600" /></a><br/>

</p>

</div>

<h4 id="a_with_openwrt_up_to_1806_and_19071">6.1-a With Openwrt up to 18.06 and 19.07</h4>
<div class="level4">

<p>
If you followed point <strong>4.1-a</strong>, you should select your OpenWrt interface(s) in the <strong>Covered Networks</strong> menu and then click on <strong>Save</strong>.<br/>

</p>

<p>
<a href="/_media/docs/guide-user/services/vpn/openvpn/openwrt_openvpn_client_6_killswitch_alternate_1.png" class="media" title="docs:guide-user:services:vpn:openvpn:openwrt_openvpn_client_6_killswitch_alternate_1.png"><img src="/_media/docs/guide-user/services/vpn/openvpn/openwrt_openvpn_client_6_killswitch_alternate_1.png?w=600&amp;tok=59c330" class="media" loading="lazy" alt="" width="600" /></a><br/>

</p>

<p>
Then on the bottom of the page, click on <strong>Save and Apply</strong> button as usual to confirm and save your changes.
</p>

</div>

<h4 id="b_with_openwrt_1907_and_later">6.1-b With Openwrt 19.07 and later</h4>
<div class="level4">

<p>
If you followed point <strong>4.1-b</strong>, you click on the <strong>Advanced Settings</strong> tab, open the Covered Interfaces menu, write <strong>tun+</strong> in the open text box in the last.<br/>

<a href="/_media/docs/guide-user/services/vpn/openvpn/openwrt_openvpn_client_6_killswitch_2.png" class="media" title="docs:guide-user:services:vpn:openvpn:openwrt_openvpn_client_6_killswitch_2.png"><img src="/_media/docs/guide-user/services/vpn/openvpn/openwrt_openvpn_client_6_killswitch_2.png?w=600&amp;tok=46346a" class="media" loading="lazy" alt="" width="600" /></a><br/>

Press Enter to add it.<br/>

<a href="/_media/docs/guide-user/services/vpn/openvpn/openwrt_openvpn_client_6_killswitch_3.png" class="media" title="docs:guide-user:services:vpn:openvpn:openwrt_openvpn_client_6_killswitch_3.png"><img src="/_media/docs/guide-user/services/vpn/openvpn/openwrt_openvpn_client_6_killswitch_3.png?w=600&amp;tok=690b9b" class="media" loading="lazy" alt="" width="600" /></a><br/>

</p>

<p>
This <strong>tun+</strong> is a regex that allows this rule to work with up to 10 tun interfaces (i.e. 10 VPNs) at the same time, if you have more, you need to adjust it.
Then on the bottom of the page, click on <strong>Save and Apply</strong> button as usual to confirm and save your changes.
</p>

</div>

<h4 id="disable_network_killswitch">6.2 Disable network Killswitch</h4>
<div class="level4">

<p>
Go to <strong>Network</strong> -→ <strong>Firewall</strong>, click on the Edit button of the Lan zone.
</p>

<p>
Click on the Allow forward to destination zones: menu and select the <abbr title="Wide Area Network">WAN</abbr> zone again, then click on Save.<br/>

<a href="/_media/docs/guide-user/services/vpn/openvpn/openwrt_openvpn_client_6_killswitch_5.png" class="media" title="docs:guide-user:services:vpn:openvpn:openwrt_openvpn_client_6_killswitch_5.png"><img src="/_media/docs/guide-user/services/vpn/openvpn/openwrt_openvpn_client_6_killswitch_5.png?w=600&amp;tok=f75291" class="media" loading="lazy" alt="" width="600" /></a>
</p>

<p>
Then on the bottom of the page, click on <strong>Save and Apply</strong> button as usual to confirm and save your changes.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;6. Enable Network Killswitch (Optional, Recommended)&quot;,&quot;hid&quot;:&quot;enable_network_killswitch_optional_recommended&quot;,&quot;codeblockOffset&quot;:2,&quot;secid&quot;:17,&quot;range&quot;:&quot;5649-8668&quot;} -->
<h2 class="sectionedit18" id="troubleshooting">Troubleshooting</h2>
<div class="level2">

<p>
If you discover <abbr title="Domain Name System">DNS</abbr> is not working, use LuCI and navigate to <strong>Network → Interfaces → <abbr title="Local Area Network">LAN</abbr></strong>, disable peer <abbr title="Domain Name System">DNS</abbr> and specify your preferred <abbr title="Domain Name System">DNS</abbr> servers in the <strong>Use Custom <abbr title="Domain Name System">DNS</abbr></strong> field, e.g. <code>8.8.8.8</code> and <code>8.8.4.4</code> for Google <abbr title="Domain Name System">DNS</abbr>.
</p>

<p>
Open a ssh remote terminal connection to the router.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;plugin_include_start&quot;,&quot;name&quot;:&quot;docs:guide-user:services:vpn:openvpn:server&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:19,&quot;range&quot;:&quot;0-&quot;} --><div class="plugin_include_content plugin_include__docs:guide-user:services:vpn:openvpn:server">
<div class="level2">

<p>
Collect and analyze the following information.
</p>
<pre class="code bash"><span class="co0"># Restart services</span>
service log restart; service openvpn restart; <span class="kw2">sleep</span> <span class="nu0">10</span>
&nbsp;
<span class="co0"># Log and status</span>
logread <span class="re5">-e</span> openvpn; <span class="kw2">netstat</span> <span class="re5">-l</span> <span class="re5">-n</span> <span class="re5">-p</span> <span class="sy0">|</span> <span class="kw2">grep</span> <span class="re5">-e</span> openvpn
&nbsp;
<span class="co0"># Runtime configuration</span>
pgrep <span class="re5">-f</span> <span class="re5">-a</span> openvpn
<span class="kw2">ip</span> address show; <span class="kw2">ip route</span> show table all
<span class="kw2">ip rule</span> show; <span class="kw2">ip</span> <span class="re5">-6</span> rule show; nft list ruleset
&nbsp;
<span class="co0"># Persistent configuration</span>
uci show network; uci show firewall; uci show openvpn
<span class="kw2">head</span> <span class="re5">-v</span> <span class="re5">-n</span> <span class="re5">-0</span> <span class="sy0">/</span>etc<span class="sy0">/</span>openvpn<span class="sy0">/*</span>.conf</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;plugin_include_end&quot;,&quot;name&quot;:&quot;docs:guide-user:services:vpn:openvpn:server&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:20,&quot;range&quot;:&quot;0-&quot;} --></div>
<div class="level2">

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Troubleshooting&quot;,&quot;hid&quot;:&quot;troubleshooting&quot;,&quot;codeblockOffset&quot;:2,&quot;secid&quot;:18,&quot;range&quot;:&quot;8669-9087&quot;} -->
<h2 class="sectionedit21" id="alternative_guide_for_openvpn_client_using_luci">Alternative guide for OpenVPN client using LuCI</h2>
<div class="level2">

<p>
The link below is to a tutorial which was written for the BT Home Hub 5A and Windows Users in mind, and using free account from <strong>ProtonVPN</strong> offering access to Netherlands, Japan and USA.  The guide is sufficiently generic to apply to most other OpenWrt routers with a working internet connection.  It has been tested with a variety of different routers.
</p>

<p>
The current tutorial is for OpenWrt 19.07-22.03 using the .ovpn file upload function. Includes information on <abbr title="Domain Name System">DNS</abbr> resolver, Kill switch, and some popular <abbr title="Virtual Private Network">VPN</abbr> providers.  It uses a <strong>different</strong> earlier OpenWrt firewall configuration than described in above wiki pages.
</p>

<p>
<span style='color:#ed1c24; '><strong>If you are struggling with getting openvpn client to work using the instructions contained at the top of this wiki page, you may wish to download and study the tutorial &#039;4-OpenVPN Client for HH5a.PDF&#039; from the Dropbox folder found in:<a href="https://www.dropbox.com/sh/c8cqmpc6cacs5n8/AAA2f8htk1uMitBckDW8Jq88a?dl=0" class="urlextern" title="https://www.dropbox.com/sh/c8cqmpc6cacs5n8/AAA2f8htk1uMitBckDW8Jq88a?dl=0" rel="ugc nofollow">Dropbox folder</a></strong></span>
</p>

<p>
<a href="/_detail/media/bt/openwrt_openvpn_client_hh5a.jpg?id=docs%3Aguide-user%3Aservices%3Avpn%3Aopenvpn%3Aclient-luci" class="media" title="media:bt:openwrt_openvpn_client_hh5a.jpg"><img src="/_media/media/bt/openwrt_openvpn_client_hh5a.jpg?w=400&amp;tok=97f281" class="media" loading="lazy" alt="" width="400" /></a>
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Alternative guide for OpenVPN client using LuCI&quot;,&quot;hid&quot;:&quot;alternative_guide_for_openvpn_client_using_luci&quot;,&quot;codeblockOffset&quot;:3,&quot;secid&quot;:21,&quot;range&quot;:&quot;9088-&quot;} -->