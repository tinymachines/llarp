
<h1 class="sectionedit1" id="remote_control_openwrt_device_via_instant_messengers_telegram_xmpp_and_email">Remote control OpenWrt device via instant messengers (Telegram, XMPP) and EMail</h1>
<div class="level1">

<p>
A device can send notifications and receive commands directly to you.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Remote control OpenWrt device via instant messengers (Telegram, XMPP) and EMail&quot;,&quot;hid&quot;:&quot;remote_control_openwrt_device_via_instant_messengers_telegram_xmpp_and_email&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:1,&quot;range&quot;:&quot;1-166&quot;} -->
<h2 class="sectionedit2" id="email">EMail</h2>
<div class="level2">

<p>
To send an email see <a href="/docs/guide-user/services/email/smtp.client" class="wikilink1" title="docs:guide-user:services:email:smtp.client" data-wiki-id="docs:guide-user:services:email:smtp.client">SMTP clients</a>.
Receiving email can be done with <code>postfix</code> or <a href="/docs/guide-user/services/email/emailrelay" class="wikilink1" title="docs:guide-user:services:email:emailrelay" data-wiki-id="docs:guide-user:services:email:emailrelay">E-MailRelay</a> and custom scripts.
But email server is problematic to set up on a router because of many limitations: it needs for a static <abbr title="Internet Protocol">IP</abbr>, <abbr title="Internet Service Provider">ISP</abbr> often blocks the <abbr title="Simple Mail Transfer Protocol">SMTP</abbr> port, spam and <abbr title="Distributed Denial of Service">DDoS</abbr> problems.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;EMail&quot;,&quot;hid&quot;:&quot;email&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:2,&quot;range&quot;:&quot;167-560&quot;} -->
<h2 class="sectionedit3" id="telegram">Telegram</h2>
<div class="level2">

<p>
This is the most used option. The Telegram has an <a href="https://core.telegram.org/bots" class="urlextern" title="https://core.telegram.org/bots" rel="ugc nofollow">advanced Bots API</a> with easy access via simple <abbr title="Hypertext Transfer Protocol">HTTP</abbr> <abbr title="Application Programming Interface">API</abbr> with a long pooling.
</p>

<p>
The <a href="https://github.com/alexwbaule/telegramopenwrt" class="urlextern" title="https://github.com/alexwbaule/telegramopenwrt" rel="ugc nofollow">alexwbaule/telegramopenwrt</a> is a TG bot based on the <code>curl</code> and supports many commands:
</p>
<ul>
<li class="level1"><div class="li"> cam_movie: Record 25 seconds of a camIP and send it.</div>
</li>
<li class="level1"><div class="li"> cam_mv: Move the camera around.</div>
</li>
<li class="level1"><div class="li"> cam_shot: Get a Pic from the camera.</div>
</li>
<li class="level1"><div class="li"> cam_vdo: Get a 25 seconds record from a camIP.</div>
</li>
<li class="level1"><div class="li"> chromego_add: Include to a user in chromego, a word to be used in permissions (block url/YouTube channel/etc).</div>
</li>
<li class="level1"><div class="li"> chromego_del: Remove a word from a user in chromego to be used in permissions (block url/YouTube channel/etc).</div>
</li>
<li class="level1"><div class="li"> chromego_list: List all permissions in chromego (block url/YouTube channel/etc).</div>
</li>
<li class="level1"><div class="li"> fw_add: Block a hostname using a deny rule in firewall, if append time to command will block from 23:00 to 8:00</div>
</li>
<li class="level1"><div class="li"> fw_delete: Remove a hostname from a deny firewall rule, if hostname is empty, will remove all rules created by this bot.</div>
</li>
<li class="level1"><div class="li"> fw_disable: Disable a firewall rule.</div>
</li>
<li class="level1"><div class="li"> fw_enable: Enable a firewall rule.</div>
</li>
<li class="level1"><div class="li"> fw_list: List all fw rules.</div>
</li>
<li class="level1"><div class="li"> fwr_disable: Disable a redirect firewall rule.</div>
</li>
<li class="level1"><div class="li"> fwr_enable: Enable a redirect firewall rule.</div>
</li>
<li class="level1"><div class="li"> fwr_list: List all redirect fw rules.</div>
</li>
<li class="level1"><div class="li"> fw_unblock: Remove a hostname from a deny firewall rule, if hostname is empty, will remove all rules created by this bot.</div>
</li>
<li class="level1"><div class="li"> get_ip: Get <abbr title="Wide Area Network">WAN</abbr> IPAddress.</div>
</li>
<li class="level1"><div class="li"> get_mac: Get the Organization that own the MacAddr.</div>
</li>
<li class="level1"><div class="li"> get_ping: Ping an address or host, return Up or Down.</div>
</li>
<li class="level1"><div class="li"> get_uptime: Return the uptime from this Device.</div>
</li>
<li class="level1"><div class="li"> hst_list: Get hosts in the dhcp Leases. If a hostname is present, search only for this hostname.</div>
</li>
<li class="level1"><div class="li"> ignoredmac_add: Add a new macaddress to the allowlist and avoid being notified about it.</div>
</li>
<li class="level1"><div class="li"> ignoredmac_list: Shows the list of ignored mac addresses that will not be notified by the bot.</div>
</li>
<li class="level1"><div class="li"> interface_down: Shutdown an interface by name.</div>
</li>
<li class="level1"><div class="li"> interface_restart: Restart an interface by name.</div>
</li>
<li class="level1"><div class="li"> interfaces_list: Get interfaces configuration.</div>
</li>
<li class="level1"><div class="li"> interface_up: Start up an interface by name.</div>
</li>
<li class="level1"><div class="li"> lights: Turn On or Off house Lights.</div>
</li>
<li class="level1"><div class="li"> msg_tv: Send Message to Samsung TV</div>
</li>
<li class="level1"><div class="li"> netstat: Prints netstat table in ESTABLISHED, CLOSED and TIME_WAIT State.</div>
</li>
<li class="level1"><div class="li"> opkg_install: Install a package from opkg.</div>
</li>
<li class="level1"><div class="li"> opkg_update: Update list of packages available.</div>
</li>
<li class="level1"><div class="li"> ping_udp: Create a <abbr title="User Datagram Protocol">UDP</abbr> packet to puncture a hole through a <abbr title="Network Address Translation">NAT</abbr> firewall of your <abbr title="Internet Service Provider">ISP</abbr></div>
</li>
<li class="level1"><div class="li"> proc_list: List all process in execution</div>
</li>
<li class="level1"><div class="li"> proc_restart: Restart a process in init.d</div>
</li>
<li class="level1"><div class="li"> proc_start: Start a process in init.d</div>
</li>
<li class="level1"><div class="li"> proc_stop: Stop a process in init.d</div>
</li>
<li class="level1"><div class="li"> proxy_disable: Disable <abbr title="Hypertext Transfer Protocol">HTTP</abbr> and <abbr title="Hypertext Transfer Protocol Secure">HTTPS</abbr> or <abbr title="Hypertext Transfer Protocol">HTTP</abbr> or <abbr title="Hypertext Transfer Protocol Secure">HTTPS</abbr> proxy.</div>
</li>
<li class="level1"><div class="li"> proxy_enable: Enable <abbr title="Hypertext Transfer Protocol">HTTP</abbr> and <abbr title="Hypertext Transfer Protocol Secure">HTTPS</abbr> or <abbr title="Hypertext Transfer Protocol">HTTP</abbr> or <abbr title="Hypertext Transfer Protocol Secure">HTTPS</abbr> proxy.</div>
</li>
<li class="level1"><div class="li"> proxy_list: List proxy rules that is enabled.</div>
</li>
<li class="level1"><div class="li"> reboot: Reboot the router.</div>
</li>
<li class="level1"><div class="li"> start: This menu help!</div>
</li>
<li class="level1"><div class="li"> swports_list: Switch ports list with states.</div>
</li>
<li class="level1"><div class="li"> wifi_disable: Disable a wireless device radio.</div>
</li>
<li class="level1"><div class="li"> wifi_enable: Enable a wireless device radio.</div>
</li>
<li class="level1"><div class="li"> wifi_list: List all wireless devices.</div>
</li>
<li class="level1"><div class="li"> wifi_restart: Restart a wireless device radio.</div>
</li>
<li class="level1"><div class="li"> wll_list: Get a Wi-Fi clients list that is connected to this device</div>
</li>
</ul>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Telegram&quot;,&quot;hid&quot;:&quot;telegram&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:3,&quot;range&quot;:&quot;561-3774&quot;} -->
<h2 class="sectionedit4" id="xmpp">XMPP</h2>
<div class="level2">

<p>
The XMPP (Jabber) is badly supported but used. You can install the <a href="/docs/guide-user/services/xmpp.server" class="wikilink1" title="docs:guide-user:services:xmpp.server" data-wiki-id="docs:guide-user:services:xmpp.server">Prosody XMPP server</a> and use it as client too with a little Lua scripting.
The <a href="https://sendxmpp.hostname.sk/" class="urlextern" title="https://sendxmpp.hostname.sk/" rel="ugc nofollow">sendxmpp</a> is a perl-script to send xmpp, similar to what sendmail does for email. To send and receive messages over <abbr title="Hypertext Transfer Protocol">HTTP</abbr> <abbr title="Application Programming Interface">API</abbr> with <code>wget</code> or <code>curl</code> you may install REST <abbr title="Application Programming Interface">API</abbr> plugin on the XMPP server (<a href="https://modules.prosody.im/mod_http_rest" class="urlextern" title="https://modules.prosody.im/mod_http_rest" rel="ugc nofollow">mod_http_rest</a> for Prosody). The <a href="https://xmpp.org/extensions/xep-0124.html" class="urlextern" title="https://xmpp.org/extensions/xep-0124.html" rel="ugc nofollow">XEP-0124 BOSH</a> probably can be used.
</p>
<ul>
<li class="level1"><div class="li"> <a href="https://github.com/stanson-ch/xmppcd" class="urlextern" title="https://github.com/stanson-ch/xmppcd" rel="ugc nofollow">xmppcd</a> Small XMPP client daemon</div>
</li>
<li class="level1"><div class="li"> <a href="https://www.reddit.com/r/openwrt/comments/11auq9n/send_a_xmpp_message_from_router/" class="urlextern" title="https://www.reddit.com/r/openwrt/comments/11auq9n/send_a_xmpp_message_from_router/" rel="ugc nofollow">Reddit: Send a xmpp message from router</a></div>
</li>
</ul>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;XMPP&quot;,&quot;hid&quot;:&quot;xmpp&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:4,&quot;range&quot;:&quot;3775-4584&quot;} -->
<h2 class="sectionedit5" id="unifiedpush">UnifiedPush</h2>
<div class="level2">

<p>
<a href="https://unifiedpush.org/" class="urlextern" title="https://unifiedpush.org/" rel="ugc nofollow">UnifiedPush</a> is an open specification and tools that lets the user choose how push notifications are delivered. Different apps supports it:
</p>
<ul>
<li class="level1"><div class="li"> <a href="https://docs.ntfy.sh/" class="urlextern" title="https://docs.ntfy.sh/" rel="ugc nofollow">ntfy.sh</a> (pronounced “notify”) is an <abbr title="Hypertext Transfer Protocol">HTTP</abbr>-based publish-subscriber notification service. It allows you to send notifications to your phone or desktop via scripts from any computer, and/or using a REST <abbr title="Application Programming Interface">API</abbr>. It has apps for Android and iOS.</div>
</li>
<li class="level1"><div class="li"> The same but I want to use Google for some reason: <a href="https://unifiedpush.org/users/distributors/fcm/" class="urlextern" title="https://unifiedpush.org/users/distributors/fcm/" rel="ugc nofollow">gCompat-UP Distrib (Android)</a></div>
</li>
<li class="level1"><div class="li"> I have a Nextcloud server: <a href="https://unifiedpush.org/users/distributors/nextpush/" class="urlextern" title="https://unifiedpush.org/users/distributors/nextpush/" rel="ugc nofollow">NextPush (Android)</a></div>
</li>
<li class="level1"><div class="li"> I use Conversations XMPP client: <a href="https://unifiedpush.org/users/distributors/conversations/" class="urlextern" title="https://unifiedpush.org/users/distributors/conversations/" rel="ugc nofollow">Conversations (Android)</a></div>
</li>
</ul>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;UnifiedPush&quot;,&quot;hid&quot;:&quot;unifiedpush&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:5,&quot;range&quot;:&quot;4585-5413&quot;} -->
<h3 class="sectionedit6" id="send_push_notification_via_ntfysh">Send push notification via ntfy.sh</h3>
<div class="level3">

<p>
Example of a script to send a notification via the <a href="https://docs.ntfy.sh/" class="urlextern" title="https://docs.ntfy.sh/" rel="ugc nofollow">ntfy.sh</a> into the <a href="https://ntfy.sh/example" class="urlextern" title="https://ntfy.sh/example" rel="ugc nofollow">example</a> queue (you should create your own private queue):
</p>
<pre class="code bash"><span class="re2">NTFY_QUEUE</span>=<span class="st0">&quot;example&quot;</span>
<span class="re2">NEW_CLIENT_IP</span>=<span class="st0">&quot;192.168.1.42&quot;</span>
<span class="re2">MSG</span>=<span class="st0">&quot;Someone joined network
&nbsp;
A new client with IP <span class="es2">$NEW_CLIENT_IP</span> joined.
Please check if it's not an intruder.&quot;</span>
&nbsp;
<span class="kw2">wget</span> <span class="re5">-q</span> <span class="re5">-O</span> - <span class="st0">&quot;ntfy.sh/<span class="es2">$NTFY_QUEUE</span>&quot;</span> \
  <span class="re5">--header</span> <span class="st0">&quot;Priority: urgent&quot;</span> \
  <span class="re5">--header</span> <span class="st0">&quot;Tags: ghost&quot;</span> \
  <span class="re5">--header</span> <span class="st0">&quot;Click: http://192.168.1.1/&quot;</span> \
  <span class="re5">--header</span> <span class="st0">&quot;Actions: http, Open Luci, https://192.168.1.1/cgi-bin/ntfy-action.cgi?block=<span class="es2">$NEW_CLIENT_IP</span>, clear=true&quot;</span> \
  <span class="re5">--header</span> <span class="st0">&quot;Email: root@OpenWrt&quot;</span> \
  <span class="re5">--post-data</span>=<span class="st0">&quot;<span class="es2">$MSG</span>&quot;</span></pre>

<p>
<strong>NOTE:</strong> the <code>--header</code> option was added to the <code>uclient-fetch</code> on Jul 2024 so if you wish to use extended properties you&#039;ll need to install the <code>wget-ssl</code> package.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Send push notification via ntfy.sh&quot;,&quot;hid&quot;:&quot;send_push_notification_via_ntfysh&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:6,&quot;range&quot;:&quot;5414-6308&quot;} -->
<h3 class="sectionedit7" id="see_also">See also</h3>
<div class="level3">

<p>
<a href="https://github.com/bitfireAT/webdav-push/" class="urlextern" title="https://github.com/bitfireAT/webdav-push/" rel="ugc nofollow">WebDAV Push</a>
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;See also&quot;,&quot;hid&quot;:&quot;see_also&quot;,&quot;codeblockOffset&quot;:1,&quot;secid&quot;:7,&quot;range&quot;:&quot;6309-&quot;} -->