
<h1 class="sectionedit1" id="dnscrypt-proxy">dnscrypt-proxy</h1>
<div class="level1">

<p>
dnscrypt-proxy is an application that acts as a local <abbr title="Domain Name System">DNS</abbr> stub resolver using <a href="https://en.wikipedia.org/wiki/DNSCrypt" class="interwiki iw_wp" title="https://en.wikipedia.org/wiki/DNSCrypt">DNSCrypt</a>.
It encrypts your <abbr title="Domain Name System">DNS</abbr> traffic improving security and privacy.
dnscrypt-proxy is the client-side version of <a href="https://github.com/Cofyc/dnscrypt-wrapper" class="urlextern" title="https://github.com/Cofyc/dnscrypt-wrapper" rel="ugc nofollow">dnscrypt-wrapper</a>.
Follow <a href="/docs/guide-user/services/dns/dnscrypt_dnsmasq_dnscrypt-proxy" class="wikilink1" title="docs:guide-user:services:dns:dnscrypt_dnsmasq_dnscrypt-proxy" data-wiki-id="docs:guide-user:services:dns:dnscrypt_dnsmasq_dnscrypt-proxy">DNSCrypt with Dnsmasq and dnscrypt-proxy</a> to properly setup DNSCrypt via dnscrypt-proxy on your router.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;dnscrypt-proxy&quot;,&quot;hid&quot;:&quot;dnscrypt-proxy&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:1,&quot;range&quot;:&quot;1-470&quot;} -->
<h2 class="sectionedit2" id="installation">Installation</h2>
<div class="level2">
<pre class="code bash">opkg update
opkg <span class="kw2">install</span> dnscrypt-proxy</pre>

<p>
LuCI integration:
</p>
<pre class="code bash">opkg update
opkg <span class="kw2">install</span> luci-app-dnscrypt-proxy</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Installation&quot;,&quot;hid&quot;:&quot;installation&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:2,&quot;range&quot;:&quot;471-645&quot;} -->
<h2 class="sectionedit3" id="configuration">Configuration</h2>
<div class="level2">

<p>
File: <code>/etc/config/dnscrypt-proxy</code>
</p>
<div class="table sectionedit4"><table class="inline">
	<thead>
	<tr class="row0">
		<th class="col0"> Name </th><th class="col1"> Type </th><th class="col2"> Required </th><th class="col3"> Default </th><th class="col4"> Description </th>
	</tr>
	</thead>
	<tr class="row1">
		<td class="col0"> <code>address</code> </td><td class="col1"> string </td><td class="col2"> yes </td><td class="col3"> <code>127.0.0.1</code> </td><td class="col4"> The <abbr title="Internet Protocol">IP</abbr> address of the proxy server. </td>
	</tr>
	<tr class="row2">
		<td class="col0"> <code>port</code> </td><td class="col1"> string </td><td class="col2"> yes </td><td class="col3"> <code>5353</code> </td><td class="col4"> Listening port for <abbr title="Domain Name System">DNS</abbr> queries. </td>
	</tr>
	<tr class="row3">
		<td class="col0"> <code>providername</code> </td><td class="col1"> string </td><td class="col2"> no </td><td class="col3"> <em>none</em> </td><td class="col4"> Provider name for a custom resolver not present in the CSV file. </td>
	</tr>
	<tr class="row4">
		<td class="col0"> <code>providerkey</code> </td><td class="col1"> string </td><td class="col2"> no </td><td class="col3"> <em>none</em> </td><td class="col4"> Provider public key for a custom resolver not present in the CSV file. </td>
	</tr>
	<tr class="row5">
		<td class="col0"> <code>resolveraddress</code> </td><td class="col1"> string </td><td class="col2"> no </td><td class="col3"> <em>none</em> </td><td class="col4"> Resolver address for a custom resolver not present in the CSV file. </td>
	</tr>
	<tr class="row6">
		<td class="col0"> <code>resolver</code> </td><td class="col1"> string </td><td class="col2"> no </td><td class="col3"> <em>none</em> </td><td class="col4"> <abbr title="Domain Name System">DNS</abbr> service for resolving queries. You can&#039;t add more than one resolver. </td>
	</tr>
	<tr class="row7">
		<td class="col0"> <code>resolvers_list</code> </td><td class="col1"> string </td><td class="col2"> no </td><td class="col3"> <code>/usr/share/dnscrypt-proxy/dnscrypt-resolvers.csv</code> </td><td class="col4"> Location of CSV file containing list of resolvers. When you use a custom DNSCrypt server and you later get problems when executing DNSCrypt, have a look in the resolver list (<code>/usr/share/dnscrypt-proxy/dnscrypt-resolvers.csv</code>) and make sure the resolver you chose is listed there. If not you may need to manually add it or just update the resolver list with the <a href="https://github.com/dyne/dnscrypt-proxy/blob/master/dnscrypt-resolvers.csv" class="urlextern" title="https://github.com/dyne/dnscrypt-proxy/blob/master/dnscrypt-resolvers.csv" rel="ugc nofollow">official one</a>. Be sure to verify the integrity of the file before overwriting the local list! </td>
	</tr>
	<tr class="row8">
		<td class="col0"> <code>ephemeral_keys</code> </td><td class="col1"> boolean </td><td class="col2"> no </td><td class="col3"> <code>0</code> </td><td class="col4"> Improve privacy by using an ephemeral public key for each query. Note that you cannot yet use it with current (Chaos Calmer) version of OpenWrt as the dnscrypt-proxy package is outdated and uses a version of DNSCrypt, which does not support ephemeral keys. Ephemeral keys option requires extra CPU cycles (especially on non-x86 platforms) and can cause huge system load. Disable it in case of performance problems. Also this option is useless with most DNSCrypt servers (all the servers using short TTLs for the certificates, which is done by default in the Docker image). </td>
	</tr>
	<tr class="row9">
		<td class="col0"> <code>client_key</code> </td><td class="col1"> string </td><td class="col2"> no </td><td class="col3"> <em>none</em> </td><td class="col4"> Use a client public key for identification. By default, the client uses a randomized key pair in order to make tracking more difficult. This option does the opposite and uses a static key pair, so that <abbr title="Domain Name System">DNS</abbr> providers can offer premium services to queries signed with a known set of public keys. A client cannot decrypt the received responses without also knowing the secret key. The value of this property is the path to a file containing the secret key. The corresponding public key is computed automatically </td>
	</tr>
	<tr class="row10">
		<td class="col0"> <code>local_cache</code> </td><td class="col1"> boolean </td><td class="col2"> no </td><td class="col3"> <code>0</code> </td><td class="col4"> Cache <abbr title="Domain Name System">DNS</abbr> responses. Should be kept to false (<code>0</code>) if <a href="/docs/guide-user/base-system/dhcp.dnsmasq" class="wikilink1" title="docs:guide-user:base-system:dhcp.dnsmasq" data-wiki-id="docs:guide-user:base-system:dhcp.dnsmasq">Dnsmasq</a> is in use, as it already does <abbr title="Domain Name System">DNS</abbr> caching. </td>
	</tr>
	<tr class="row11">
		<td class="col0"> <code>block_ipv6</code> </td><td class="col1"> boolean </td><td class="col2"> no </td><td class="col3"> <code>0</code> </td><td class="col4"> Immediately reply to <abbr title="Internet Protocol version 6">IPv6</abbr> requests with an empty value. Useful if your network doesn&#039;t support <abbr title="Internet Protocol version 6">IPv6</abbr> as it avoids useless requests to upstream resolvers and having to wait for a response. </td>
	</tr>
	<tr class="row12">
		<td class="col0"> <code>blacklist</code> </td><td class="col1"> string </td><td class="col2"> no </td><td class="col3"> <em>none</em> </td><td class="col4"> Block <abbr title="Internet Protocol">IP</abbr> addresses or names matching a list of patterns. </td>
	</tr>
	<tr class="row13">
		<td class="col0"> <code>syslog</code> </td><td class="col1"> boolean </td><td class="col2"> no </td><td class="col3"> <code>1</code> </td><td class="col4"> Send logs to the syslog daemon. </td>
	</tr>
	<tr class="row14">
		<td class="col0"> <code>syslog_prefix</code> </td><td class="col1"> string </td><td class="col2"> no </td><td class="col3"> <code>dnscrypt-proxy</code> </td><td class="col4"> Log entries can optionally be prefixed with a string. </td>
	</tr>
	<tr class="row15">
		<td class="col0"> <code>log_level</code> </td><td class="col1"> int </td><td class="col2"> no </td><td class="col3"> <code>6</code> </td><td class="col4"> Don&#039;t log events with priority above this log level. Valid values are between <code>0</code> (critical) to <code>7</code> (debug-level messages). </td>
	</tr>
	<tr class="row16">
		<td class="col0"> <code>query_log_file</code> </td><td class="col1"> string </td><td class="col2"> no </td><td class="col3"> <em>none</em> </td><td class="col4"> File where to log <abbr title="Domain Name System">DNS</abbr> queries. The file name can be prefixed with <code>ltsv:</code> in order to store logs using the LTSV format (e.g. <code>ltsv:/tmp/dns-queries.log</code>).</td>
	</tr>
</table></div>
<!-- EDIT{&quot;target&quot;:&quot;table&quot;,&quot;name&quot;:&quot;&quot;,&quot;hid&quot;:&quot;table&quot;,&quot;secid&quot;:4,&quot;range&quot;:&quot;709-4279&quot;} -->
</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Configuration&quot;,&quot;hid&quot;:&quot;configuration&quot;,&quot;codeblockOffset&quot;:2,&quot;secid&quot;:3,&quot;range&quot;:&quot;646-4280&quot;} -->
<h3 class="sectionedit5" id="examples">Examples</h3>
<div class="level3">

</div>

<h4 id="using_a_resolver_from_the_csv_file">Using a resolver from the CSV file</h4>
<div class="level4">

</div>

<h5 id="ipv4">IPv4</h5>
<div class="level5">
<pre class="code bash">config dnscrypt-proxy <span class="st_h">'dnscryptfrv4'</span>
       option address <span class="st_h">'127.0.0.1'</span>
       option port <span class="st_h">'5353'</span>
       option resolver <span class="st_h">'dnscrypt.org-fr'</span></pre>

</div>

<h5 id="ipv6">IPv6</h5>
<div class="level5">
<pre class="code bash">config dnscrypt-proxy <span class="st_h">'dnscryptnlv6'</span>
       option address <span class="st_h">'[::1]'</span>
       option port <span class="st_h">'5354'</span>
       option resolver <span class="st_h">'dnscrypt.nl-ns0-ipv6'</span></pre>

</div>

<h4 id="using_a_custom_resolver">Using a custom resolver</h4>
<div class="level4">

</div>

<h5 id="ipv41">IPv4</h5>
<div class="level5">
<pre class="code bash">config dnscrypt-proxy <span class="st_h">'dnscryptcav4'</span>
       option address <span class="st_h">'127.0.0.1'</span>
       option port <span class="st_h">'5355'</span>
       option providername <span class="st_h">'2.dnscrypt-cert.dnscrypt.ca-1'</span>
       option providerkey <span class="st_h">'1A53:A3C9:5078:9CBD:D10B:1933:A468:9B6C:846A:40F1:B73D:1752:AECA:C982:9ECB:7CE2'</span>
       option resolveraddress <span class="st_h">'192.99.183.132:443'</span></pre>

</div>

<h5 id="ipv61">IPv6</h5>
<div class="level5">
<pre class="code bash">config dnscrypt-proxy <span class="st_h">'dnscryptdkv6'</span>
       option address <span class="st_h">'[::1]'</span>
       option port <span class="st_h">'5356'</span>
       option providername <span class="st_h">'2.dnscrypt-cert.resolver2.dnscrypt.eu'</span>
       option providerkey <span class="st_h">'3748:5585:E3B9:D088:FD25:AD36:B037:01F5:520C:D648:9E9A:DD52:1457:4955:9F0A:9955'</span>
       option resolveraddress <span class="st_h">'[2001:1448:243::dc2]:443'</span></pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Examples&quot;,&quot;hid&quot;:&quot;examples&quot;,&quot;codeblockOffset&quot;:2,&quot;secid&quot;:5,&quot;range&quot;:&quot;4281-&quot;} -->