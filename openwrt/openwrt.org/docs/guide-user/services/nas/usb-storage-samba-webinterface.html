
<h1 class="sectionedit1" id="share_usb_hard-drive_with_samba_using_luci">Share USB hard-drive with Samba using LuCI</h1>
<div class="level1">

<p>
USB ports are found on most routers, especially those with USB 3.0 ports can provide fast file sharing performance. A popular usage scenario is connecting a USB storage device like a flash or hard drive to share the content on your <abbr title="Local Area Network">LAN</abbr>. This recipe will guide you through how this can easily be set-up using the Luci web-interface.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Share USB hard-drive with Samba using LuCI&quot;,&quot;hid&quot;:&quot;share_usb_hard-drive_with_samba_using_luci&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:1,&quot;range&quot;:&quot;1-390&quot;} -->
<h2 class="sectionedit2" id="install_dependencies">Install dependencies</h2>
<div class="level2">

<p>
You will find detailed walkthrough on <a href="/docs/guide-user/services/nas/cifs.server" class="wikilink1" title="docs:guide-user:services:nas:cifs.server" data-wiki-id="docs:guide-user:services:nas:cifs.server">Samba</a> which includes info on USB drivers, filesystems, and settings. At a minimum, you will need to install the packages:
</p>
<ul>
<li class="level1"><div class="li"> block-mount</div>
</li>
<li class="level1"><div class="li"> kmod-usb3</div>
</li>
<li class="level1"><div class="li"> kmod-usb-storage-uas</div>
</li>
<li class="level1"><div class="li"> luci-app-samba4</div>
</li>
</ul>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Install dependencies&quot;,&quot;hid&quot;:&quot;install_dependencies&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:2,&quot;range&quot;:&quot;391-706&quot;} -->
<h2 class="sectionedit3" id="mount_your_usb_drive">Mount your USB drive</h2>
<div class="level2">

<p>
Whether you have USB flash, SSD, or HDD. Simply plug it in the USB port, and it should show be automatically detected by OpenWrt (if you <abbr title="Secure Shell">SSH</abbr> into the router you will typically find a new entry /dev/sda for the device, and /dev/sda1 for it&#039;s first partition). Now go to the <strong>Mount Points</strong> tab under System in Luci. You will find your USB storage device listed already as show below. Provided you have the filesystem installed all you need is to tick <strong>Enable</strong> and then <strong>Save &amp; Apply</strong>.
<img src="/lib/images/smileys/exclaim.svg" class="icon smiley" alt=":!:" /> Mount Points is only visible if dependencies are already installed:<br/>
<br/>
<a href="/_detail/media/doc/recipes/usb-storage-samba-webinterface-mountpoint.png?id=docs%3Aguide-user%3Aservices%3Anas%3Ausb-storage-samba-webinterface" class="media" title="media:doc:recipes:usb-storage-samba-webinterface-mountpoint.png"><img src="/_media/media/doc/recipes/usb-storage-samba-webinterface-mountpoint.png" class="media" loading="lazy" title="The partition(s) on your USB device is already listed in Luci." alt="The partition(s) on your USB device is already listed in Luci." /></a><br/>
<br/>
<br/>

In my case I used the btrfs filesystem due to its advanced features. In this case you will need to change the file system. Choose <strong>Edit</strong>, and you will be able to revise like this:
<br/>
<br/>
<a href="/_detail/media/doc/recipes/usb-storage-samba-webinterface-btrfsmount.png?id=docs%3Aguide-user%3Aservices%3Anas%3Ausb-storage-samba-webinterface" class="media" title="media:doc:recipes:usb-storage-samba-webinterface-btrfsmount.png"><img src="/_media/media/doc/recipes/usb-storage-samba-webinterface-btrfsmount.png" class="media" loading="lazy" title="Choose among installed file systems to match the formatting of your drive" alt="Choose among installed file systems to match the formatting of your drive" /></a><br/>
<br/>

</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Mount your USB drive&quot;,&quot;hid&quot;:&quot;mount_your_usb_drive&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:3,&quot;range&quot;:&quot;707-1782&quot;} -->
<h2 class="sectionedit4" id="share_the_drive_on_your_local_network">Share the drive on your local network</h2>
<div class="level2">

<p>
We will only show how to do simply sharing here. Samba supports advanced access policies, but this recipe is meant for the most common use case. Please consult <a href="/docs/guide-user/services/nas/samba" class="wikilink1" title="docs:guide-user:services:nas:samba" data-wiki-id="docs:guide-user:services:nas:samba">Samba advanced</a> for more policy settings.
</p>

<p>
Open Luci, under <strong>Services</strong> choose the <strong>Network Shares</strong> tab. Here you will need to fill in the name of your shared folder as it will appear on you network. In our example we called it <em>Share</em>. You will also need to fill in the mount point from above, we used the default <em>/home</em>. You will also need to tick <strong>Allow guests</strong> (otherwise setting up user access control is necessary). Tick Read-Only if you only want to have read access for clients, we allowed write access here:
<br/>
<br/>
<a href="/_detail/media/doc/recipes/usb-storage-samba-webinterface-guest.png?id=docs%3Aguide-user%3Aservices%3Anas%3Ausb-storage-samba-webinterface" class="media" title="media:doc:recipes:usb-storage-samba-webinterface-guest.png"><img src="/_media/media/doc/recipes/usb-storage-samba-webinterface-guest.png" class="media" loading="lazy" title="Simple Samba set-up with read/write access for all clients on local network." alt="Simple Samba set-up with read/write access for all clients on local network." /></a>
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Share the drive on your local network&quot;,&quot;hid&quot;:&quot;share_the_drive_on_your_local_network&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:4,&quot;range&quot;:&quot;1783-&quot;} -->