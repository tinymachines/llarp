
<h1 class="sectionedit1" id="sftp_server">SFTP server</h1>
<div class="level1">

</div>
<!-- EDIT{&quot;target&quot;:&quot;plugin_include_start&quot;,&quot;name&quot;:&quot;meta:infobox:howto_links&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:2,&quot;range&quot;:&quot;0-&quot;} --><div class="plugin_include_content plugin_include__meta:infobox:howto_links">
<div class="level1">
<!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_start&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:4,&quot;range&quot;:&quot;0-&quot;} --><div class="wrap_info plugin_wrap">
<p>
This article relies on the following:
</p>
<ul>
<li class="level1"><div class="li"> Accessing <a href="/docs/guide-quick-start/walkthrough_login" class="wikilink1" title="docs:guide-quick-start:walkthrough_login" data-wiki-id="docs:guide-quick-start:walkthrough_login">web interface</a> / <a href="/docs/guide-quick-start/sshadministration" class="wikilink1" title="docs:guide-quick-start:sshadministration" data-wiki-id="docs:guide-quick-start:sshadministration">command-line interface</a></div>
</li>
<li class="level1"><div class="li"> Managing <a href="/docs/guide-user/base-system/uci" class="wikilink1" title="docs:guide-user:base-system:uci" data-wiki-id="docs:guide-user:base-system:uci">configs</a> / <a href="/docs/guide-user/additional-software/managing_packages" class="wikilink1" title="docs:guide-user:additional-software:managing_packages" data-wiki-id="docs:guide-user:additional-software:managing_packages">packages</a> / <a href="/docs/guide-user/base-system/managing_services" class="wikilink1" title="docs:guide-user:base-system:managing_services" data-wiki-id="docs:guide-user:base-system:managing_services">services</a> / <a href="/docs/guide-user/base-system/log.essentials" class="wikilink1" title="docs:guide-user:base-system:log.essentials" data-wiki-id="docs:guide-user:base-system:log.essentials">logs</a></div>
</li>
</ul>
</div><!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_end&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:5,&quot;range&quot;:&quot;0-&quot;} -->
</div>
<!-- EDIT{&quot;target&quot;:&quot;plugin_include_end&quot;,&quot;name&quot;:&quot;meta:infobox:howto_links&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:3,&quot;range&quot;:&quot;0-&quot;} --></div>
<div class="level1">

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;SFTP server&quot;,&quot;hid&quot;:&quot;sftp_server&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:1,&quot;range&quot;:&quot;1-108&quot;} -->
<h2 class="sectionedit6" id="introduction">Introduction</h2>
<div class="level2">
<ul>
<li class="level1"><div class="li"> This how-to describes the method for setting up <a href="https://en.wikipedia.org/wiki/SSH_File_Transfer_Protocol" class="interwiki iw_wp" title="https://en.wikipedia.org/wiki/SSH_File_Transfer_Protocol">SFTP</a> server on OpenWrt.</div>
</li>
<li class="level1"><div class="li"> It relies on <a href="/docs/guide-user/base-system/dropbear" class="wikilink1" title="docs:guide-user:base-system:dropbear" data-wiki-id="docs:guide-user:base-system:dropbear">Dropbear</a> and <a href="/packages/pkgdata/openssh-sftp-server" class="wikilink1" title="packages:pkgdata:openssh-sftp-server" data-wiki-id="packages:pkgdata:openssh-sftp-server">openssh-sftp-server</a> for secure authentication and file transfer.</div>
</li>
<li class="level1"><div class="li"> You can use any suitable <a href="/docs/guide-user/services/nas/sftp.server#popular_clients" class="wikilink1" title="docs:guide-user:services:nas:sftp.server" data-wiki-id="docs:guide-user:services:nas:sftp.server">SFTP client</a> running natively on your <abbr title="Operating System">OS</abbr>.</div>
</li>
</ul>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Introduction&quot;,&quot;hid&quot;:&quot;introduction&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:6,&quot;range&quot;:&quot;109-532&quot;} -->
<h2 class="sectionedit7" id="goals">Goals</h2>
<div class="level2">
<ul>
<li class="level1"><div class="li"> Transfer files to/from the router.</div>
</li>
<li class="level1"><div class="li"> Secure file transfer operations.</div>
</li>
<li class="level1"><div class="li"> Support <abbr title="Operating System">OS</abbr> specific clients.</div>
</li>
</ul>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Goals&quot;,&quot;hid&quot;:&quot;goals&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:7,&quot;range&quot;:&quot;533-660&quot;} -->
<h2 class="sectionedit8" id="instructions">Instructions</h2>
<div class="level2">

<p>
The <abbr title="Secure Shell">SSH</abbr> File Transfer (<abbr title="SSH File Transfer Protocol">SFTP</abbr>) is a file transfer protocol that works over <abbr title="Secure Shell">SSH</abbr>. It&#039;s like SCP but has more features.
For a basic usage the low level SCP may be enough but if you need, for example, to mount drive then use the <abbr title="SSH File Transfer Protocol">SFTP</abbr>.
</p>

<p>
The vanilla OpenWrt out of the box has a small <a href="/docs/guide-user/base-system/dropbear" class="wikilink1" title="docs:guide-user:base-system:dropbear" data-wiki-id="docs:guide-user:base-system:dropbear">Dropbear</a> <abbr title="Secure Shell">SSH</abbr> server.
But it doesn&#039;t support the <abbr title="SSH File Transfer Protocol">SFTP</abbr> and you need to install <code>openssh-sftp-server</code> package.
The package comes from another OpenSSH server which is bigger but has more features and default on desktop systems like Ubuntu.
Many <a href="/docs/guide-user/installation/openwrt-as-stock-firmware" class="wikilink1" title="docs:guide-user:installation:openwrt-as-stock-firmware" data-wiki-id="docs:guide-user:installation:openwrt-as-stock-firmware">routers with OpenWrt as a stock firmware</a> use it out of the box and the <code>openssh-sftp-server</code> is installed too.
So for this routers you really don&#039;t need anything to do and just start using it.
</p>

<p>
But if not then install the required package:
</p>
<pre class="code bash">opkg update
opkg <span class="kw2">install</span> openssh-sftp-server</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Instructions&quot;,&quot;hid&quot;:&quot;instructions&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:8,&quot;range&quot;:&quot;661-1614&quot;} -->
<h2 class="sectionedit9" id="testing">Testing</h2>
<div class="level2">

<p>
Enter the following <abbr title="Uniform Resource Locator">URL</abbr> in your <abbr title="SSH File Transfer Protocol">SFTP</abbr> client.
</p>
<pre class="code bash">sftp:<span class="sy0">//</span>root<span class="sy0">@</span>openwrt.lan<span class="sy0">/</span></pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Testing&quot;,&quot;hid&quot;:&quot;testing&quot;,&quot;codeblockOffset&quot;:1,&quot;secid&quot;:9,&quot;range&quot;:&quot;1615-1726&quot;} -->
<h3 class="sectionedit10" id="clients">Clients</h3>
<div class="level3">
<ul>
<li class="level1"><div class="li"> Windows: <a href="/docs/guide-quick-start/sshadministration#winscp" class="wikilink1" title="docs:guide-quick-start:sshadministration" data-wiki-id="docs:guide-quick-start:sshadministration">WinSCP</a> - an advanced <abbr title="Graphical User Interface">GUI</abbr> client. <code>Proprietary</code></div>
</li>
<li class="level1"><div class="li"> Windows: <a href="https://www.farmanager.com/" class="urlextern" title="https://www.farmanager.com/" rel="ugc nofollow">FAR Manager</a> - an advanced Norton Commander like file manager. Supports a plain SCP too. <code>Proprietary</code></div>
</li>
<li class="level1"><div class="li"> Linux, macOS, FreeBSD: <a href="https://github.com/elfmz/far2l" class="urlextern" title="https://github.com/elfmz/far2l" rel="ugc nofollow">far2l</a> - an open source version of the FAR. <code><abbr title="GNU General Public License">GPL</abbr>-2</code></div>
</li>
<li class="level1"><div class="li"> Linux, macOS, FreeBSD: <a href="https://midnight-commander.org/" class="urlextern" title="https://midnight-commander.org/" rel="ugc nofollow">Midnight Commander</a> - a Norton Commander like file manager. Supports a plain SCP too. <code><abbr title="GNU General Public License">GPL</abbr>-3</code></div>
</li>
<li class="level1"><div class="li"> Linux: <a href="https://en.wikipedia.org/wiki/GNOME_Files" class="interwiki iw_wp" title="https://en.wikipedia.org/wiki/GNOME_Files">GNOME Files</a> or <a href="https://apps.kde.org/ru/konqueror/" class="urlextern" title="https://apps.kde.org/ru/konqueror/" rel="ugc nofollow">KDE Konqueror</a>. <code><abbr title="GNU General Public License">GPL</abbr>-2</code></div>
</li>
<li class="level1"><div class="li"> Linux: <a href="https://wiki.gnome.org/Apps/DejaDup/Details" class="urlextern" title="https://wiki.gnome.org/Apps/DejaDup/Details" rel="ugc nofollow">GNOME Déjà Dup</a> - a backup and sync tool. <code><abbr title="GNU General Public License">GPL</abbr>-3</code></div>
</li>
<li class="level1"><div class="li"> Windows, macOS, Linux, FreeBSD: <a href="https://rclone.org/" class="urlextern" title="https://rclone.org/" rel="ugc nofollow">rclone</a> - a command-line program to manage files on cloud storage. <code>MIT</code></div>
</li>
<li class="level1"><div class="li"> Linux: <a href="/docs/guide-user/services/ssh/sshfs.client" class="wikilink1" title="docs:guide-user:services:ssh:sshfs.client" data-wiki-id="docs:guide-user:services:ssh:sshfs.client">SSHFS client</a></div>
</li>
<li class="level1"><div class="li"> macOS: <a href="https://cyberduck.io/" class="urlextern" title="https://cyberduck.io/" rel="ugc nofollow">Cyberduck</a> and <a href="https://mountainduck.io/" class="urlextern" title="https://mountainduck.io/" rel="ugc nofollow">MountainDuck</a>. <code><abbr title="GNU General Public License">GPL</abbr>-3</code>.</div>
</li>
<li class="level1"><div class="li"> Android: <a href="https://play.google.com/store/apps/details?id=com.lonelycatgames.Xplore" class="urlextern" title="https://play.google.com/store/apps/details?id=com.lonelycatgames.Xplore" rel="ugc nofollow">X-plore File Manager</a></div>
</li>
<li class="level1"><div class="li"> Android TV, RapberryPI: <a href="https://kodi.tv" class="urlextern" title="https://kodi.tv" rel="ugc nofollow">KODI</a> - a media player for TV. You can put a USB drive to a router and watch your photos, video and audio without any additional software.</div>
</li>
<li class="level1"><div class="li"> <a href="https://www.sftp.net/clients" class="urlextern" title="https://www.sftp.net/clients" rel="ugc nofollow">SFTP Client</a> list</div>
</li>
</ul>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Clients&quot;,&quot;hid&quot;:&quot;clients&quot;,&quot;codeblockOffset&quot;:2,&quot;secid&quot;:10,&quot;range&quot;:&quot;1727-3161&quot;} -->
<h2 class="sectionedit11" id="troubleshooting">Troubleshooting</h2>
<div class="level2">

<p>
Collect and analyze the following information.
</p>
<pre class="code bash"><span class="co0"># Restart services</span>
service log restart; service dropbear restart
&nbsp;
<span class="co0"># Log and status</span>
logread <span class="re5">-e</span> dropbear; <span class="kw2">netstat</span> <span class="re5">-l</span> <span class="re5">-n</span> <span class="re5">-p</span> <span class="sy0">|</span> <span class="kw2">grep</span> <span class="re5">-e</span> dropbear
&nbsp;
<span class="co0"># Runtime configuration</span>
pgrep <span class="re5">-f</span> <span class="re5">-a</span> dropbear
&nbsp;
<span class="co0"># Persistent configuration</span>
uci show dropbear
<span class="kw2">ls</span> <span class="re5">-l</span> <span class="sy0">/</span>etc<span class="sy0">/</span>dropbear; <span class="kw2">cat</span> <span class="sy0">/</span>etc<span class="sy0">/</span>dropbear<span class="sy0">/</span>authorized_keys
<span class="kw2">ls</span> <span class="re5">-l</span> $<span class="br0">&#40;</span>opkg files openssh-sftp-server <span class="sy0">|</span> <span class="kw2">grep</span> <span class="re5">-e</span> ^<span class="sy0">/</span><span class="br0">&#41;</span></pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Troubleshooting&quot;,&quot;hid&quot;:&quot;troubleshooting&quot;,&quot;codeblockOffset&quot;:2,&quot;secid&quot;:11,&quot;range&quot;:&quot;3162-3598&quot;} -->
<h2 class="sectionedit12" id="extras">Extras</h2>
<div class="level2">

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Extras&quot;,&quot;hid&quot;:&quot;extras&quot;,&quot;codeblockOffset&quot;:3,&quot;secid&quot;:12,&quot;range&quot;:&quot;3599-3618&quot;} -->
<h3 class="sectionedit13" id="service_discovery">Service discovery</h3>
<div class="level3">

<p>
You may want to provide service discovery for clients supporting Bonjour/Zeroconf.
</p>
<pre class="code bash">opkg update
opkg <span class="kw2">install</span> announce</pre>

<p>
See also <a href="/docs/guide-developer/mdns" class="wikilink1" title="docs:guide-developer:mdns" data-wiki-id="docs:guide-developer:mdns">umdns Multicast DNS Daemon</a>
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Service discovery&quot;,&quot;hid&quot;:&quot;service_discovery&quot;,&quot;codeblockOffset&quot;:3,&quot;secid&quot;:13,&quot;range&quot;:&quot;3619-&quot;} -->