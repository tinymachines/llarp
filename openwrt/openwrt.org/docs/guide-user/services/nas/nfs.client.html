
<h1 class="sectionedit1" id="nfs_client">NFS client</h1>
<div class="level1">

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;NFS client&quot;,&quot;hid&quot;:&quot;nfs_client&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:1,&quot;range&quot;:&quot;1-26&quot;} -->
<h2 class="sectionedit2" id="core_packages">Core Packages</h2>
<div class="level2">

<p>
<strong>nfs-utils</strong> Updated mount.nfs command - allows mounting nfs4 volumes
</p>

<p>
<strong>kmod-fs-nfs</strong> Kernel module for NFS support
</p>

<p>
<strong>kmod-fs-nfs-common</strong> Common NFS filesystem modules
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Core Packages&quot;,&quot;hid&quot;:&quot;core_packages&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:2,&quot;range&quot;:&quot;27-225&quot;} -->
<h2 class="sectionedit3" id="filesystem_support">Filesystem Support</h2>
<div class="level2">

<p>
For NFSv4 server → install <strong>kmod-fs-nfs-v4</strong>
For NFSv3 server → install <strong>kmod-fs-nfs-v3</strong>
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Filesystem Support&quot;,&quot;hid&quot;:&quot;filesystem_support&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:3,&quot;range&quot;:&quot;226-353&quot;} -->
<h2 class="sectionedit4" id="opkg_setup">Opkg Setup</h2>
<div class="level2">
<pre class="code bash">opkg update
opkg <span class="kw2">install</span> nfs-utils kmod-fs-nfs kmod-fs-nfs-v4 kmod-fs-nfs-v3</pre>

<p>
<strong>WARNING:</strong> The librpc is missing in some versions. You can safely use <code>-force-depends</code> if it happens to you
Note that to use <code>mount -t cifs</code>, NFS mount support in busybox has to be enabled.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Opkg Setup&quot;,&quot;hid&quot;:&quot;opkg_setup&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:4,&quot;range&quot;:&quot;354-671&quot;} -->
<h3 class="sectionedit5" id="configuration">Configuration</h3>
<div class="level3">
<pre class="code bash"><span class="kw2">mkdir</span> <span class="sy0">/</span>mnt<span class="sy0">/</span>remote2
mount.nfs <span class="sy0">//</span>192.168.2.254<span class="sy0">/</span>router_main <span class="sy0">/</span>mnt<span class="sy0">/</span>remote2 <span class="br0">&#91;</span>-rvVwfnh <span class="br0">&#93;</span> <span class="br0">&#91;</span>-t version<span class="br0">&#93;</span> <span class="br0">&#91;</span>-o options<span class="br0">&#93;</span></pre>
<pre class="code bash"><span class="kw2">mount</span> <span class="re5">-t</span> nfs 192.168.1.101:<span class="sy0">/</span>share <span class="sy0">/</span>mnt<span class="sy0">/</span>point <span class="re5">-o</span> nolock</pre>
<pre class="code bash"><span class="co0"># To connect using NFSv4</span>
<span class="kw2">mount</span> <span class="re5">-t</span> nfs4 192.168.1.101:<span class="sy0">/</span>share <span class="sy0">/</span>mnt<span class="sy0">/</span>point <span class="re5">-o</span> nolock</pre>
<pre class="code bash"><span class="co0"># For Fedora 17+ servers, which are nfs4 out of the box...</span>
<span class="kw2">mount</span> <span class="re5">-t</span> nfs 192.168.255.124:<span class="sy0">/</span>home<span class="sy0">/</span>karlp<span class="sy0">/</span>src src <span class="re5">-o</span> <span class="re2">nfsvers</span>=<span class="nu0">3</span> <span class="re5">-o</span> nolock</pre>

<p>
The <code>nolock</code> will disable NFS file locking. If you really need file locking, you must install the <strong><code>portmap</code></strong> package and start the <code>portmap daemon</code> before trying to mount an exported filesystem without the <code>nolock</code> option.
</p>

<p>
In some revisions mounting is not possible because default disabled in kernel: BUSYBOX_CONFIG_FEATURE_MOUNT_NFS [=n]
</p>

<p>
Read <a href="http://linux.die.net/man/8/mount.nfs" class="urlextern" title="http://linux.die.net/man/8/mount.nfs" rel="ugc nofollow">manpage of mount.nfs</a>
</p>

<p>
Put it in <code><a href="/docs/guide-user/base-system/notuci.config#etcfstab" class="wikilink1" title="docs:guide-user:base-system:notuci.config" data-wiki-id="docs:guide-user:base-system:notuci.config">/etc/fstab</a></code>.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Configuration&quot;,&quot;hid&quot;:&quot;configuration&quot;,&quot;codeblockOffset&quot;:1,&quot;secid&quot;:5,&quot;range&quot;:&quot;672-1654&quot;} -->
<h2 class="sectionedit6" id="troubleshooting">Troubleshooting</h2>
<div class="level2">

<p>
Append -v to your mount command to see detailed debugging info... i.e.;
</p>
<pre class="code bash"><span class="kw2">mount</span> <span class="re5">-t</span> nfs 192.168.1.101:<span class="sy0">/</span>share <span class="sy0">/</span>mnt<span class="sy0">/</span>point <span class="re5">-o</span> nolock  <span class="re5">-v</span></pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Troubleshooting&quot;,&quot;hid&quot;:&quot;troubleshooting&quot;,&quot;codeblockOffset&quot;:5,&quot;secid&quot;:6,&quot;range&quot;:&quot;1655-1835&quot;} -->
<h3 class="sectionedit7" id="throughput_issues">Throughput Issues</h3>
<div class="level3">

<p>
Since <a href="/docs/guide-user/firewall/netfilter-iptables/netfilter" class="wikilink2" title="docs:guide-user:firewall:netfilter-iptables:netfilter" rel="nofollow" data-wiki-id="docs:guide-user:firewall:netfilter-iptables:netfilter">netfilter</a> will track every connection, if you use MASQUERADING for example, you could disable con-tracking for data connections:
</p>
<pre class="code bash"><span class="re1">$IPT</span> <span class="re5">-t</span> raw <span class="re5">-A</span> PREROUTING <span class="re5">-i</span> <span class="re1">$IF_LAN</span> <span class="re5">-s</span> <span class="re1">$NET_LAN</span> <span class="re5">-p</span> tcp <span class="re5">--sport</span> <span class="nu0">32777</span>:<span class="nu0">32780</span> <span class="re5">-j</span> CT <span class="re5">--notrack</span> <span class="co0">#---------- don't track nfs</span>
<span class="re1">$IPT</span> <span class="re5">-t</span> raw <span class="re5">-A</span> PREROUTING <span class="re5">-i</span> <span class="re1">$IF_LAN</span> <span class="re5">-s</span> <span class="re1">$NET_LAN</span> <span class="re5">-p</span> udp <span class="re5">--sport</span> <span class="nu0">32777</span>:<span class="nu0">32780</span> <span class="re5">-j</span> CT <span class="re5">--notrack</span> <span class="co0">#---------- don't track nfs</span>
<span class="re1">$IPT</span> <span class="re5">-t</span> raw <span class="re5">-A</span> OUTPUT <span class="re5">-o</span> <span class="re1">$IF_LAN</span> <span class="re5">-d</span> <span class="re1">$NET_LAN</span> <span class="re5">-p</span> tcp <span class="re5">--dport</span> <span class="nu0">32777</span>:<span class="nu0">32780</span> <span class="re5">-j</span> CT <span class="re5">--notrack</span> <span class="co0">#---------- don't track nfs</span>
<span class="re1">$IPT</span> <span class="re5">-t</span> raw <span class="re5">-A</span> OUTPUT <span class="re5">-o</span> <span class="re1">$IF_LAN</span> <span class="re5">-d</span> <span class="re1">$NET_LAN</span> <span class="re5">-p</span> udp <span class="re5">--dport</span> <span class="nu0">32777</span>:<span class="nu0">32780</span> <span class="re5">-j</span> CT <span class="re5">--notrack</span> <span class="co0">#---------- don't track nfs</span></pre>

<p>
Note this is not the same as for the server, the source and destination ports differ. The INPUT is for when you read from the remote filesystem and the OUTPUT for when you write to it.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Throughput Issues&quot;,&quot;hid&quot;:&quot;throughput_issues&quot;,&quot;codeblockOffset&quot;:6,&quot;secid&quot;:7,&quot;range&quot;:&quot;1836-&quot;} -->