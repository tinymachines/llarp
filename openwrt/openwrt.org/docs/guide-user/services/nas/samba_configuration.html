
<h1 class="sectionedit1" id="samba_3_old_version">Samba 3 (old version)</h1>
<div class="level1">

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Samba 3 (old version)&quot;,&quot;hid&quot;:&quot;samba_3_old_version&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:1,&quot;range&quot;:&quot;1-37&quot;} -->
<h2 class="sectionedit2" id="samba_versions">Samba versions</h2>
<div class="level2">

<p>
OpenWrt supports both Samba3 and Samba4, however much of the guide below is based on the deprecated Samba3.
</p>

<p>
See the new doc page for <a href="/docs/guide-user/services/nas/cifs.server" class="wikilink1" title="docs:guide-user:services:nas:cifs.server" data-wiki-id="docs:guide-user:services:nas:cifs.server">Samba4</a>.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Samba versions&quot;,&quot;hid&quot;:&quot;samba_versions&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:2,&quot;range&quot;:&quot;38-252&quot;} -->
<h2 class="sectionedit3" id="samba_server_-_before_you_start">Samba server - Before you start</h2>
<div class="level2">

<p>
It&#039;s important before beginning samba setup that you get your disks sorted.
</p>

<p>
Installing filesystem support, mounting, basic os level permissions are all something Samba sits on top of.
</p>

<p>
Beginning the setup of the Samba server before mounting and verifying a working disk setup will make things much harder in the long run.
</p>

<p>
( <img src="/lib/images/smileys/fixme.svg" class="icon smiley" alt="FIXME" />: Add links to various usb / filesystem setup guides )
</p>

<p>
see: <a href="/docs/guide-user/storage/writable_ntfs" class="wikilink1" title="docs:guide-user:storage:writable_ntfs" data-wiki-id="docs:guide-user:storage:writable_ntfs"> NTFS Tips </a><br/>

</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Samba server - Before you start&quot;,&quot;hid&quot;:&quot;samba_server_-_before_you_start&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:3,&quot;range&quot;:&quot;253-745&quot;} -->
<h2 class="sectionedit4" id="mounting_storage">1. Mounting storage</h2>
<div class="level2">

<p>
see: <a href="/docs/guide-user/storage/usb-drives" class="wikilink1" title="docs:guide-user:storage:usb-drives" data-wiki-id="docs:guide-user:storage:usb-drives"> Setting up storage devices </a><br/>

When done setting up your mount point, verify (e.g. with <code>ls /mnt</code> in the command line) that at least one mount point exists, before continuing.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;1. Mounting storage&quot;,&quot;hid&quot;:&quot;mounting_storage&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:4,&quot;range&quot;:&quot;746-1000&quot;} -->
<h2 class="sectionedit5" id="installing_samba">2. Installing samba</h2>
<div class="level2">

<p>
To find out, if samba is already installed on your device, try to query the samba version:
</p>
<pre class="code">smbd -V</pre>

<p>
or query opkg:
</p>
<pre class="code">opkg list-installed | grep samba</pre>

<p>
if this fails, you have to install samba. To do so, first identify the samba version available for your installation:
</p>
<pre class="code">opkg update
opkg list | grep samba</pre>

<p>
In our example the available version is “samba36”:
</p>
<pre class="code">luci-app-samba - git-17.219.28675-9ee26ac-1 - Network Shares - Samba SMB/CIFS module
...
samba36-client - 3.6.25-6 - Samba 3.6 SMB/CIFS client
samba36-server - 3.6.25-6 - The Samba software suite is a collection of programs that implements the SMB protocol for UNIX systems, allowing </pre>

<p>
Mandatory: Now install the samba server package:
</p>
<pre class="code">opkg install samba36-server</pre>

<p>
Optional: if you need a command line samba client for debugging problems, also install:
</p>
<pre class="code">opkg install samba36-client</pre>

<p>
Optional: If you want a simple LuCi <abbr title="Graphical User Interface">GUI</abbr> config for samba, also install:
</p>
<pre class="code">opkg install luci-app-samba</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;2. Installing samba&quot;,&quot;hid&quot;:&quot;installing_samba&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:5,&quot;range&quot;:&quot;1001-2072&quot;} -->
<h2 class="sectionedit6" id="configuring_the_samba_serviceconfig_samba_section_ofetcconfigsamba">3. Configuring the samba service: &quot;config samba&quot; section of /etc/config/samba</h2>
<div class="level2">

<p>
Usually you will not have to change defaults provided in this section. In some cases, you may want to adapt the “interface” parameter, in case the samba service should listen on different interfaces.<br/>

</p>

<p>
This config section determines values and options relevant to the overall operation of samba. The following table lists all available options, their default value and respectively a short characterization. See <a href="http://www.samba.org/samba/docs/man/manpages-3/smb.conf.5.html#idp58030944" class="urlextern" title="http://www.samba.org/samba/docs/man/manpages-3/smb.conf.5.html#idp58030944" rel="ugc nofollow">smb.conf man page</a> for further details.
These are the default settings for the common options:
</p>
<pre class="code">config &#039;samba&#039;
	option &#039;name&#039; &#039;OpenWrt&#039;
	option &#039;workgroup&#039; &#039;OpenWrt&#039;
	option &#039;description&#039; &#039;Samba on OpenWrt&#039;
	option &#039;charset&#039; &#039;UTF-8&#039;
	option &#039;homes&#039; &#039;0&#039;
	option &#039;interface&#039; &#039;loopback lan&#039;</pre>
<div class="table sectionedit7"><table class="inline">
	<thead>
	<tr class="row0">
		<th class="col0 leftalign">Name           </th><th class="col1 leftalign">Type   </th><th class="col2">Required</th><th class="col3 leftalign">Default                     </th><th class="col4">Option</th><th class="col5 leftalign">Description                       </th>
	</tr>
	</thead>
	<tr class="row1">
		<td class="col0 leftalign"><em>name</em>       </td><td class="col1">string </td><td class="col2 leftalign">no      </td><td class="col3 leftalign">hostname or OpenWrt            </td><td class="col4 leftalign">      </td><td class="col5 leftalign">Name of the Server                </td>
	</tr>
	<tr class="row2">
		<td class="col0 leftalign"><em>workgroup</em>  </td><td class="col1">string </td><td class="col2 leftalign">no      </td><td class="col3 leftalign">hostname or OpenWrt            </td><td class="col4 leftalign">      </td><td class="col5 leftalign">Name of the Workgroup             </td>
	</tr>
	<tr class="row3">
		<td class="col0"><em>description</em></td><td class="col1">string </td><td class="col2 leftalign">no      </td><td class="col3 leftalign">Samba on hostname or OpenWrt   </td><td class="col4 leftalign">      </td><td class="col5 leftalign">Description of the Server         </td>
	</tr>
	<tr class="row4">
		<td class="col0 leftalign"><em>charset</em>    </td><td class="col1">string </td><td class="col2 leftalign">no      </td><td class="col3 leftalign">UTF-8                       </td><td class="col4 leftalign">      </td><td class="col5 leftalign">Display charset &amp; unix charset    </td>
	</tr>
	<tr class="row5">
		<td class="col0 leftalign"><em>homes</em>      </td><td class="col1">boolean</td><td class="col2 leftalign">no      </td><td class="col3 leftalign">0                           </td><td class="col4 leftalign">0, 1  </td><td class="col5 leftalign">Share the user directory          </td>
	</tr>
	<tr class="row6">
		<td class="col0 leftalign"><em>interface</em>  </td><td class="col1">string </td><td class="col2 leftalign">no      </td><td class="col3 leftalign">loopback lan                </td><td class="col4 leftalign">      </td><td class="col5">Interfaces samba should listen on.</td>
	</tr>
</table></div>
<!-- EDIT{&quot;target&quot;:&quot;table&quot;,&quot;name&quot;:&quot;&quot;,&quot;hid&quot;:&quot;table&quot;,&quot;secid&quot;:7,&quot;range&quot;:&quot;2958-3708&quot;} -->
</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;3. Configuring the samba service: \&quot;config samba\&quot; section of \/etc\/config\/samba&quot;,&quot;hid&quot;:&quot;configuring_the_samba_serviceconfig_samba_section_ofetcconfigsamba&quot;,&quot;codeblockOffset&quot;:7,&quot;secid&quot;:6,&quot;range&quot;:&quot;2073-3709&quot;} -->
<h2 class="sectionedit8" id="configuring_a_samba_shareconfig_sambashare_section_ofetcconfigsamba">4. Configuring a samba share: &quot;config sambashare&quot; section of /etc/config/samba</h2>
<div class="level2">

<p>
SAMBA will be reachable via NetBIOS by default.
In this section you need to configure the disk folders you intend to make accessible to users in your <abbr title="Local Area Network">LAN</abbr>.
Ensure that you have already have attached a USB harddisk to the USB-Port and <em>correctly</em> mounted a partition. You can choose to share the partition as a whole, or just individual directories on it. For each entry you need to create an individual config <em>sambashare</em> section.
</p>

<p>
In the following example, the SMB sharename <strong>Sharename</strong> is mapped to a connected drive that is mapped to <strong>/mnt/sda3</strong>.
</p>
<pre class="code">config &#039;sambashare&#039;
	option &#039;name&#039; &#039;Sharename&#039;
	option &#039;path&#039; &#039;/mnt/sda3&#039;
	option &#039;create_mask&#039; &#039;0700&#039;
	option &#039;dir_mask&#039; &#039;0700&#039;
	option read_only &#039;no&#039;
	...</pre>
<ul>
<li class="level1"><div class="li"> Run <code>ls /mnt</code> in the command line, if you need to debug/identify your available mount points.</div>
</li>
<li class="level1"><div class="li"> you may need to adapt “create mask” and “dir mask” in case vFAT/FAT32 or exFAT is used as file system on the external drive. It is recommended to try EXT4 first in case of problems.</div>
</li>
<li class="level1"><div class="li"> Set read_only to yes, if you want to disable write access</div>
</li>
</ul>
<div class="table sectionedit9"><table class="inline">
	<thead>
	<tr class="row0">
		<th class="col0 leftalign">Name           </th><th class="col1 leftalign">Type     </th><th class="col2">Required</th><th class="col3 leftalign">Default                              </th><th class="col4">Option </th><th class="col5 leftalign">Description                                                                                                                                                                                                                                                                                            </th>
	</tr>
	</thead>
	<tr class="row1">
		<td class="col0 leftalign"><em>name</em>       </td><td class="col1 leftalign">string   </td><td class="col2 leftalign">yes     </td><td class="col3 leftalign"><em>(none)</em>                           </td><td class="col4 leftalign">       </td><td class="col5 leftalign">Name of the SMB file share. Will be shown in the filebrowser of the client.                                                                                                                                                                                                                                                   </td>
	</tr>
	<tr class="row2">
		<td class="col0 leftalign"><em>path</em>       </td><td class="col1">file path</td><td class="col2 leftalign">yes     </td><td class="col3 leftalign"><em>(none)</em>                           </td><td class="col4 leftalign">       </td><td class="col5 leftalign">The complete path of the directory. <a href="https://www.samba.org/samba/docs/man/manpages-3/smb.conf.5.html#PATH" class="urlextern" title="https://www.samba.org/samba/docs/man/manpages-3/smb.conf.5.html#PATH" rel="ugc nofollow">path</a>                                                                                                                                                                                        </td>
	</tr>
	<tr class="row3">
		<td class="col0 leftalign"><em>users</em>      </td><td class="col1 leftalign">string   </td><td class="col2 leftalign">no      </td><td class="col3">guest account or from global template</td><td class="col4 leftalign">       </td><td class="col5">the samba-users allowed access to this entry; use <em>smbpasswd</em> to create a user-pwd combination! Several users can be specified, separated by a coma (ex : option <em>users</em> <em>root,nobody</em> ). Translated to <a href="http://www.samba.org/samba/docs/man/manpages-3/smb.conf.5.html#VALIDUSERS" class="urlextern" title="http://www.samba.org/samba/docs/man/manpages-3/smb.conf.5.html#VALIDUSERS" rel="ugc nofollow">valid users</a></td>
	</tr>
	<tr class="row4">
		<td class="col0 leftalign"><em>read_only</em>  </td><td class="col1 leftalign">string   </td><td class="col2 leftalign">no      </td><td class="col3 leftalign">yes or from global template          </td><td class="col4">no, yes</td><td class="col5 leftalign">no allows for read/write, else only read access is granted; (for rw, you also need to mount fs rw!). <a href="http://www.samba.org/samba/docs/man/manpages-3/smb.conf.5.html#READONLY" class="urlextern" title="http://www.samba.org/samba/docs/man/manpages-3/smb.conf.5.html#READONLY" rel="ugc nofollow">read only</a>                                                                                                             </td>
	</tr>
	<tr class="row5">
		<td class="col0 leftalign"><em>guest_ok</em>   </td><td class="col1 leftalign">string   </td><td class="col2 leftalign">no      </td><td class="col3 leftalign">no or from global template           </td><td class="col4">no, yes</td><td class="col5 leftalign">Specifies if you need to login via samba-username and password to access this share. <a href="http://www.samba.org/samba/docs/man/manpages-3/smb.conf.5.html#GUESTOK" class="urlextern" title="http://www.samba.org/samba/docs/man/manpages-3/smb.conf.5.html#GUESTOK" rel="ugc nofollow">guest ok</a>.                                                                                                                              </td>
	</tr>
	<tr class="row6">
		<td class="col0"><em>create_mask</em></td><td class="col1 leftalign">integer  </td><td class="col2 leftalign">no      </td><td class="col3 leftalign">0744 or from global template         </td><td class="col4 leftalign">       </td><td class="col5 leftalign">chmod mask for files created (needs write access). <a href="http://www.samba.org/samba/docs/man/manpages-3/smb.conf.5.html#CREATEMASK" class="urlextern" title="http://www.samba.org/samba/docs/man/manpages-3/smb.conf.5.html#CREATEMASK" rel="ugc nofollow">create mask</a>                                                                                                                                                           </td>
	</tr>
	<tr class="row7">
		<td class="col0 leftalign"><em>dir_mask</em>   </td><td class="col1 leftalign">integer  </td><td class="col2 leftalign">no      </td><td class="col3 leftalign">0755 or from global template         </td><td class="col4 leftalign">       </td><td class="col5 leftalign">chmod mask for directories created (need write access). <a href="http://www.samba.org/samba/docs/man/manpages-3/smb.conf.5.html#DIRECTORYMASK" class="urlextern" title="http://www.samba.org/samba/docs/man/manpages-3/smb.conf.5.html#DIRECTORYMASK" rel="ugc nofollow">directory mask</a>.                                                                                                                                               </td>
	</tr>
</table></div>
<!-- EDIT{&quot;target&quot;:&quot;table&quot;,&quot;name&quot;:&quot;&quot;,&quot;hid&quot;:&quot;table1&quot;,&quot;secid&quot;:9,&quot;range&quot;:&quot;4880-7936&quot;} -->
<p>
Each samba share can be configured at either share level access or user level access.
</p>
<ul>
<li class="level1"><div class="li"> At share level access all users on the network can access the share, and all files are shared with all users. </div>
</li>
<li class="level1"><div class="li"> At user level access a username and password are needed to access the share. </div>
</li>
</ul>

<p>
By default Samba is configured for user level access (this is also the recommended way).
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;4. Configuring a samba share: \&quot;config sambashare\&quot; section of \/etc\/config\/samba&quot;,&quot;hid&quot;:&quot;configuring_a_samba_shareconfig_sambashare_section_ofetcconfigsamba&quot;,&quot;codeblockOffset&quot;:8,&quot;secid&quot;:8,&quot;range&quot;:&quot;3710-8311&quot;} -->
<h3 class="sectionedit10" id="samba_share_config_when_using_share_level_access">Samba share config when using &quot;share level&quot; access</h3>
<div class="level3">

<p>
To set share level access
</p>
<ul>
<li class="level1"><div class="li"> change <em>security = user</em> to <em>security = share</em> in <em>/etc/samba/smb.conf.template</em></div>
</li>
<li class="level1"><div class="li"> Decide for your self, if you want to set <code>option &#039;read_only&#039; &#039;yes</code>&#039; to <code>&#039;no</code>&#039;, to enable unrestricted anonymous access including write permission.</div>
</li>
<li class="level1"><div class="li"> set <em>guest_ok</em> to <em>yes</em> on the share</div>
</li>
</ul>
<pre class="code">config &#039;sambashare&#039;
        ...
	option &#039;read_only&#039; &#039;yes&#039;
	option &#039;guest_ok&#039; &#039;yes&#039;</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Samba share config when using \&quot;share level\&quot; access&quot;,&quot;hid&quot;:&quot;samba_share_config_when_using_share_level_access&quot;,&quot;codeblockOffset&quot;:9,&quot;secid&quot;:10,&quot;range&quot;:&quot;8312-8789&quot;} -->
<h3 class="sectionedit11" id="samba_share_config_when_using_user_level_access">Samba share config when using &quot;user level&quot; access</h3>
<div class="level3">

<p>
Make sure that <em>guest ok</em> is set to <em>no</em> and allow your created user to access the fileshare with the option <em>users</em> by adding the usernames.<br/>

If you want to add more than one user, use a comma separated list.<br/>

In the following example we will allow <strong>newuser</strong> to access the share.
</p>
<pre class="code">config &#039;sambashare&#039;
        ...
	option guest_ok &#039;no&#039;
	option users &#039;newuser&#039;</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Samba share config when using \&quot;user level\&quot; access&quot;,&quot;hid&quot;:&quot;samba_share_config_when_using_user_level_access&quot;,&quot;codeblockOffset&quot;:10,&quot;secid&quot;:11,&quot;range&quot;:&quot;8790-9234&quot;} -->
<h2 class="sectionedit12" id="adding_samba_user_s">5. Adding samba user(s)</h2>
<div class="level2">

<p>
To access a samba share with user level access there must be users added to the system by editing <code>/etc/passwd</code>.<br/>

</p>

<p>
Add a line for each required user. Choose a unique user id (the first number in the line) of 1000 or higher that does not exist yet. Set the group identification number (the second number) to &#039;65534&#039; (the same number as the user nobody). Copy the rest.<br/>

<br/>

e.g. to create a user:
</p>
<ul>
<li class="level1"><div class="li"> user in this example will be called &#039;newuser&#039;“ (this is the loginname you need to enter, when Windows pops up the authentication dialogue)</div>
</li>
<li class="level1"><div class="li"> with the unique system ID &#039;1000&#039;</div>
</li>
<li class="level1"><div class="li"> with the group id &#039;65534&#039; (which is the group identifier for &#039;nobody&#039;= no special default group)</div>
</li>
<li class="level1"><div class="li"> &#039;/var&#039; just means the user will not need a special home folder on the system</div>
</li>
<li class="level1"><div class="li"> &#039;/bin/false&#039; means the user will not have a default shell program associated</div>
</li>
</ul>
<pre class="code">root:0:0:root:/root:/bin/ash
nobody:*:65534:65534:nobody:/var:/bin/false
daemon:*:65534:65534:daemon:/var:/bin/false
newuser:*:1000:65534:newuser:/var:/bin/false</pre>
<ul>
<li class="level1"><div class="li"> keep in mind that the user(s) and group(s) utilized by Samba need to have the proper permissions for their shares, i.e. they need write access in order to write via smb.</div>
</li>
<li class="level1"><div class="li"> For seamless access from Windows Clients use the same username as for your login on your Client. If you use an Microsoft Account to login just use a random username without an @ in the name, “newuser” will work!</div>
</li>
<li class="level1"><div class="li"> regardless the filename (which is like this for historic Linux reasons), the actual user passwords are stored separately and will be added in the next step</div>
</li>
</ul>

<p>
For seamless access when using Microsoft Online accounts in Windows 8/10, edit <em>/etc/samba/smb.conf.template</em> and add <em>username map = /etc/samba/username.map</em>:
</p>
<pre class="code">[global]
[...]
	username map = /etc/samba/username.map</pre>

<p>
Then create <em>/etc/samba/username.map</em> which links the Linux User loginname to your Microsoft Account loginname:
</p>
<pre class="code">newuser = user@outlook.com</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;5. Adding samba user(s)&quot;,&quot;hid&quot;:&quot;adding_samba_user_s&quot;,&quot;codeblockOffset&quot;:11,&quot;secid&quot;:12,&quot;range&quot;:&quot;9235-11232&quot;} -->
<h2 class="sectionedit13" id="adding_a_password_for_each_samba_user">6. Adding a password for each samba user</h2>
<div class="level2">

<p>
samba does not rely on passwords stored in /etc/shadows.
By adding the following, you will only enable users for SMB file share access. With these passwords, your users will not get <abbr title="Secure Shell">SSH</abbr> or LuCi access to your OpenWrt system (unless you give them another additional password in the file /etc/shadows)
</p>
<pre class="code">smbpasswd -a newuser</pre>
<ul>
<li class="level1"><div class="li"> The passwords get stored in hashed form in the file: <strong>/etc/samba/smbpasswd</strong>.</div>
</li>
<li class="level1"><div class="li"> For seamless access from Windows Clients, preferrably use the same password as also used for your login on your Client. (This also applies to Microsoft Online Accounts)</div>
</li>
</ul>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;6. Adding a password for each samba user&quot;,&quot;hid&quot;:&quot;adding_a_password_for_each_samba_user&quot;,&quot;codeblockOffset&quot;:14,&quot;secid&quot;:13,&quot;range&quot;:&quot;11233-11880&quot;} -->
<h2 class="sectionedit14" id="restarting_samba">7. Restarting samba</h2>
<div class="level2">

<p>
Reload samba by issueing the following command 
</p>
<pre class="code">service samba restart</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;7. Restarting samba&quot;,&quot;hid&quot;:&quot;restarting_samba&quot;,&quot;codeblockOffset&quot;:15,&quot;secid&quot;:14,&quot;range&quot;:&quot;11881-11998&quot;} -->
<h2 class="sectionedit15" id="optional_configetcsambasmbconftemplate">Optional config: /etc/samba/smb.conf.template</h2>
<div class="level2">

<p>
In addition to the UCI file (<em>/etc/config/samba</em>), modifications can be made to the <em>/etc/samba/smb.conf.template</em> file.<br/>

In usual default operation, this configuration can be left untouched.
</p>

<p>
e.g. to allow users with null password (can authenticate without providing a password), edit <em>/etc/samba/smb.conf.template</em> and add <em>null passwords = yes</em>:
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Optional config: \/etc\/samba\/smb.conf.template&quot;,&quot;hid&quot;:&quot;optional_configetcsambasmbconftemplate&quot;,&quot;codeblockOffset&quot;:16,&quot;secid&quot;:15,&quot;range&quot;:&quot;11999-12415&quot;} -->
<h2 class="sectionedit16" id="troubleshooting">Troubleshooting</h2>
<div class="level2">
<ul>
<li class="level1"><div class="li"> Windows clients: When using exFAT or vFAT(FAT32) as file system on OpenWrt side for samba, you may experience the Windows error message 0x8007003b on Windows clients &gt;= Win8. This error seems especially to occur when trying to copy large files (&gt; 3.5 <abbr title="Gigabyte">GB</abbr>) to the OpenWrt SMB share, even though e.g. exFAT is said to support files &gt; 4GB. The samba services on OpenWrt side may crash afterwards, requiring a OpenWrt device reboot. The last file copied before the crash usually will not have been copied correctly. A reliable workaround to avoid this error at all, is to use EXT4 on the external drive connected of the OpenWrt device.</div>
</li>
<li class="level1 node"><div class="li"> If write access is not possible</div>
<ul>
<li class="level2"><div class="li"> check that the mountpoint (e.g. <code>ls -l /mnt/sha3</code> has “rwx” bits set. <code>chmod</code> can be used to change that if in doubt. </div>
</li>
<li class="level2"><div class="li"> check that the samba share is configured with <strong>option read_only &#039;no&#039;</strong></div>
</li>
<li class="level2"><div class="li"> it seems like if the samba share name equals the mountpoint name that that triggers a readonly mode. E.g. avoid naming your samba share “sha3” if your mountpoint is named ”/mnt/sha3“</div>
</li>
</ul>
</li>
<li class="level1 node"><div class="li"> If there is not enough space on the destination.</div>
<ul>
<li class="level2"><div class="li"> Since <em>root file system</em> has limited storage (say 2MiB) and you are mount a storage at /mnt/sda1 (16 <abbr title="Gigabyte">GB</abbr> with 8GB free) and you mention <strong>path under Shared Directories of Network Shares/Samba</strong> in SMB configuration as /mnt then you will have 2MiB space only, but if you use /mnt/sda1 you have (16 <abbr title="Gigabyte">GB</abbr> with 8GB free) now enough space on the destination.</div>
</li>
</ul>
</li>
<li class="level1 node"><div class="li"> If you have problems to access your shared directory via <strong>Samba Win10 Client</strong> and you get the error code <strong>0x80004005</strong>; you should be take a look into this solution <a href="https://answers.microsoft.com/en-us/windows/forum/all/viewing-network-error-0x80004005/2d017e34-a59e-4efd-93c8-db36a8ab1fa8" class="urlextern" title="https://answers.microsoft.com/en-us/windows/forum/all/viewing-network-error-0x80004005/2d017e34-a59e-4efd-93c8-db36a8ab1fa8" rel="ugc nofollow">Microsoft-Forum: Viewing Network Error 0x80004005</a></div>
<ul>
<li class="level2"><div class="li">  <em>SMB 1.0/CIFS Client</em> should be enabled ...</div>
</li>
<li class="level2"><div class="li"> <code>Press Windows key + R
Type: optionalfeatures.exe
Hit Enter

Scroll down to SMB 1.0/CIFS File Sharing Support
Tick the SMB 1.0/CIFS Client
Untick SMB 1.0/CIFS Automatic Removal and
Untick SMB 1.0/CIFS Server

Click OK and restart if prompted.</code></div>
</li>
</ul>
</li>
</ul>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Troubleshooting&quot;,&quot;hid&quot;:&quot;troubleshooting&quot;,&quot;codeblockOffset&quot;:16,&quot;secid&quot;:16,&quot;range&quot;:&quot;12416-&quot;} -->