
<h1 class="sectionedit1" id="usb_bluetooth_support">USB Bluetooth support</h1>
<div class="level1">

</div>
<!-- EDIT{&quot;target&quot;:&quot;plugin_include_start&quot;,&quot;name&quot;:&quot;meta:infobox:cleanup&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:2,&quot;range&quot;:&quot;0-&quot;} --><div class="plugin_include_content plugin_include__meta:infobox:cleanup" id="plugin_include__meta__infobox__cleanup">
<div class="level1">
<!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_start&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:4,&quot;range&quot;:&quot;0-&quot;} --><div class="wrap_center wrap_cleanup plugin_wrap" style="width: 70%;">
<p>
<strong>Cleanup Required!</strong><br/>

This page or section needs cleanup. You can edit this page to fix wiki markup, redundant content or outdated information. 
</p>
</div><!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_end&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:5,&quot;range&quot;:&quot;0-&quot;} -->
</div>
<!-- EDIT{&quot;target&quot;:&quot;plugin_include_end&quot;,&quot;name&quot;:&quot;meta:infobox:cleanup&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:3,&quot;range&quot;:&quot;0-&quot;} --></div>
<div class="level1">

<p>
<img src="/lib/images/smileys/exclaim.svg" class="icon smiley" alt=":!:" /> There are differences between bluez5,bluez4 and current (2015) bluez5. (daemon names, config files ...)
</p>

</div>

<h5 id="other_bluetooth_guides">Other Bluetooth guides</h5>
<div class="level5">
<ul>
<li class="level1"><div class="li"> <a href="/docs/guide-user/hardware/bluetooth/bluetooth.6lowpan" class="wikilink1" title="docs:guide-user:hardware:bluetooth:bluetooth.6lowpan" data-wiki-id="docs:guide-user:hardware:bluetooth:bluetooth.6lowpan">Bluetooth LE 6LoWPAN</a></div>
</li>
<li class="level1"><div class="li"> <a href="/docs/guide-user/hardware/bluetooth/bluetooth.audio" class="wikilink1" title="docs:guide-user:hardware:bluetooth:bluetooth.audio" data-wiki-id="docs:guide-user:hardware:bluetooth:bluetooth.audio">Bluetooth Audio</a></div>
</li>
<li class="level1"><div class="li"> <a href="/docs/guide-user/hardware/bluetooth/bluetooth.tether" class="wikilink1" title="docs:guide-user:hardware:bluetooth:bluetooth.tether" data-wiki-id="docs:guide-user:hardware:bluetooth:bluetooth.tether">Smartphone Bluetooth Tethering</a></div>
</li>
<li class="level1"><div class="li"> <a href="/docs/guide-user/hardware/bluetooth/bluetooth.speakers" class="wikilink1" title="docs:guide-user:hardware:bluetooth:bluetooth.speakers" data-wiki-id="docs:guide-user:hardware:bluetooth:bluetooth.speakers">Bluetooth Speakers</a></div>
</li>
</ul>

<p>
Some images offered on the OpenWrt download page, come with the basic <a href="https://en.wikipedia.org/wiki/Universal Serial Bus" class="interwiki iw_wp" title="https://en.wikipedia.org/wiki/Universal Serial Bus">USB</a> support already included, if yours does not, this page will explain how to install USB support. The <a href="/docs/guide-user/additional-software/opkg" class="wikilink1" title="docs:guide-user:additional-software:opkg" data-wiki-id="docs:guide-user:additional-software:opkg">OPKG</a> packages needed to obtain a very basic USB support under OpenWrt are the following (please read about the different <a href="https://en.wikipedia.org/wiki/Host controller interface" class="interwiki iw_wp" title="https://en.wikipedia.org/wiki/Host controller interface">host controller interfaces</a> on Wikipedia):
</p>
<div class="table sectionedit6"><table class="inline">
	<thead>
	<tr class="row0">
		<th class="col0 leftalign"> Name                 </th><th class="col1"> Size (KB) </th><th class="col2"> Required </th><th class="col3"> Desciption </th>
	</tr>
	</thead>
	<tr class="row1">
		<td class="col0 leftalign"> kmod-usb-core        </td><td class="col1 rightalign">   67012 </td><td class="col2 centeralign">  yes       </td><td class="col3 leftalign"> Kernel support for USB.  </td>
	</tr>
	<tr class="row2">
		<td class="col0 leftalign"> kmod-usb-uhci        </td><td class="col1 rightalign">   14897 </td><td class="col2 centeralign">  specific  </td><td class="col3 leftalign"> Kernel support for USB <strong>U</strong>HCI controllers. Alternative to ohci.   </td>
	</tr>
	<tr class="row3">
		<td class="col0 leftalign"> kmod-usb-ohci        </td><td class="col1 rightalign">   10949 </td><td class="col2 centeralign">  specific  </td><td class="col3 leftalign"> Kernel support for USB <strong>O</strong>HCI controllers. Alternative to uhci.   </td>
	</tr>
	<tr class="row4">
		<td class="col0 leftalign"> kmod-usb2            </td><td class="col1 rightalign">   21879 </td><td class="col2 centeralign">  specific  </td><td class="col3 leftalign"> Kernel support for USB2 (<strong>E</strong>HCI) controllers.                     </td>
	</tr>
	<tr class="row5">
		<td class="col0 leftalign"> kmod-ledtrig-usbdev  </td><td class="col1 rightalign">    3502 </td><td class="col2 centeralign">     no     </td><td class="col3 leftalign"> Kernel module to drive LEDs based on USB device presence/activity.  </td>
	</tr>
	<tr class="row6">
		<td class="col0 leftalign"> usbutils             </td><td class="col1 rightalign">  191664 </td><td class="col2 centeralign">     no     </td><td class="col3 leftalign"> USB devices listing utilities: <code><a href="http://linux.die.net/man/8/lsusb" class="urlextern" title="http://linux.die.net/man/8/lsusb" rel="ugc nofollow">lsusb</a></code>, <code>...</code>  </td>
	</tr>
	<tr class="row7">
		<td class="col0 leftalign"> kmod-bluetooth       </td><td class="col1 rightalign">  126843 </td><td class="col2 centeralign">    yes     </td><td class="col3 leftalign"> Kernel support for Bluetooth devices.   </td>
	</tr>
	<tr class="row8">
		<td class="col0 leftalign"> bluez-daemon         </td><td class="col1 rightalign">    487K </td><td class="col2 centeralign">    yes     </td><td class="col3 leftalign"> Bluetooth daemon.    </td>
	</tr>
	<tr class="row9">
		<td class="col0 leftalign"> bluez-libs           </td><td class="col1 rightalign">   31943 </td><td class="col2 centeralign">    yes     </td><td class="col3 leftalign"> Bluetooth library.    </td>
	</tr>
	<tr class="row10">
		<td class="col0 leftalign"> bluez-utils          </td><td class="col1 rightalign">  208236 </td><td class="col2 centeralign">    yes     </td><td class="col3 leftalign"> Bluetooth utilities.  </td>
	</tr>
	<tr class="row11">
		<td class="col0 leftalign"> dbus                 </td><td class="col1 rightalign">  296173 </td><td class="col2 centeralign">    yes     </td><td class="col3 leftalign"> Simple interprocess messaging system (daemon), dependency of bluez-utils   </td>
	</tr>
</table></div>
<!-- EDIT{&quot;target&quot;:&quot;table&quot;,&quot;name&quot;:&quot;&quot;,&quot;hid&quot;:&quot;table&quot;,&quot;secid&quot;:6,&quot;range&quot;:&quot;1008-2183&quot;} -->
<p>
By installing the correct kernel packages, your GNU/Linux system is able to address the bus. Now, depending on what you want to connect over the bus, you still need to install the drivers for that specific device. Please see <a href="/docs/guide-user/hardware/usb.overview" class="wikilink1" title="docs:guide-user:hardware:usb.overview" data-wiki-id="docs:guide-user:hardware:usb.overview">usb.overview</a>
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;USB Bluetooth support&quot;,&quot;hid&quot;:&quot;usb_bluetooth_support&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:1,&quot;range&quot;:&quot;1-2452&quot;} -->
<h2 class="sectionedit7" id="installation">Installation</h2>
<div class="level2">

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Installation&quot;,&quot;hid&quot;:&quot;installation&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:7,&quot;range&quot;:&quot;2453-2478&quot;} -->
<h2 class="sectionedit8" id="manually_installing_all_needed_packages">Manually installing all needed packages</h2>
<div class="level2">

<p>
If you wish to manually install all needed packages needed for bluetooth support just issue this command:
</p>

<p>
<strong>Space needed: ~1.3 <abbr title="Megabyte">MB</abbr></strong>
</p>
<pre class="code">opkg update
opkg install kmod-bluetooth bluez-libs bluez-utils kmod-usb-core kmod-usb-uhci kmod-usb2 usbutils</pre>

<p>
In OpenWRT &gt;=18.06:
</p>
<pre class="code">opkg update
opkg install kmod-bluetooth bluez-libs bluez-utils kmod-usb-core kmod-usb-uhci kmod-usb2 usbutils bluez-daemon</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Manually installing all needed packages&quot;,&quot;hid&quot;:&quot;manually_installing_all_needed_packages&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:8,&quot;range&quot;:&quot;2479-2948&quot;} -->
<h2 class="sectionedit9" id="enabling_automatic_bluetooth_device_support">Enabling automatic Bluetooth device support</h2>
<div class="level2">

<p>
<strong>bluez-tools</strong> automatically installs <strong>dbus</strong> as dependency package but it is not enabled by default in order to have benefits of <strong>dbus</strong> you need to enable both <strong>dbus</strong> and <strong>bluez-utils</strong> or <strong>bluetoothd</strong> services to start on boot:
</p>
<pre class="code">/etc/init.d/dbus enable
/etc/init.d/dbus start</pre>
<pre class="code">/etc/init.d/bluez-utils enable
/etc/init.d/bluez-utils start</pre>

<p>
In 18.06 the <strong>bluez-daemon</strong> installs the <strong>bluetoothd</strong> init script instead of <strong>bluez-utils</strong>:
</p>
<pre class="code">/etc/init.d/bluetoothd enable
/etc/init.d/bluetoothd start</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Enabling automatic Bluetooth device support&quot;,&quot;hid&quot;:&quot;enabling_automatic_bluetooth_device_support&quot;,&quot;codeblockOffset&quot;:2,&quot;secid&quot;:9,&quot;range&quot;:&quot;2949-3557&quot;} -->
<h2 class="sectionedit10" id="manually_testing_bluetooth_devices">Manually testing Bluetooth devices</h2>
<div class="level2">

<p>
There are few basic commands to test if you bluetooth device is properly detected and working ok.
</p>

<p>
<strong>hciconfig</strong>
</p>

<p>
Print name and basic information about all the Bluetooth devices installed in the system: 
</p>
<pre class="code"># hciconfig 
hci0:	Type: USB
	BD Address: 00:1A:82:00:12:11 ACL MTU: 339:6 SCO MTU: 180:1
	DOWN 
	RX bytes:454 acl:0 sco:0 events:16 errors:0
	TX bytes:70 acl:0 sco:0 commands:16 errors:0</pre>

<p>
hciconfig is part of the bluez-utils package.
</p>

<p>
To activate a device, use:
</p>
<pre class="code"># hciconfig hci0 up</pre>

<p>
<strong>hcitool</strong>
</p>

<p>
To scan for remote devices:
</p>
<pre class="code"># hcitool scan</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Manually testing Bluetooth devices&quot;,&quot;hid&quot;:&quot;manually_testing_bluetooth_devices&quot;,&quot;codeblockOffset&quot;:5,&quot;secid&quot;:10,&quot;range&quot;:&quot;3558-4193&quot;} -->
<h2 class="sectionedit11" id="manually_insert_a_pin">Manually insert a pin</h2>
<div class="level2">

<p>
hcid.conf man page is missing this info:
</p>
<pre class="code">/var/lib/bluetooth/nn:nn:nn:nn:nn:nn/pincodes

    Default location for pins for pairing devices. The file is line separated, with the following columns separated by whitespace:

    nn:nn:nn:nn:nn:nn Remote device address.

    n 1-8 digit pin code. User may have to consult hardware documentation in cases of hard coded pins. Try 0000</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Manually insert a pin&quot;,&quot;hid&quot;:&quot;manually_insert_a_pin&quot;,&quot;codeblockOffset&quot;:8,&quot;secid&quot;:11,&quot;range&quot;:&quot;4194-4621&quot;} -->
<h2 class="sectionedit12" id="troubleshooting_and_issues">Troubleshooting and issues</h2>
<div class="level2">

<p>
If bluetooth device doesn&#039;t inicialize correctly and doesn&#039;t show up while running <strong>hcitool dev</strong> command try reinitializing bluetooth stack: 
</p>
<pre class="code">hciconfig hci0 reset
hciconfig hci0 up
/etc/init.d/bluez-utils restart</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Troubleshooting and issues&quot;,&quot;hid&quot;:&quot;troubleshooting_and_issues&quot;,&quot;codeblockOffset&quot;:9,&quot;secid&quot;:12,&quot;range&quot;:&quot;4622-&quot;} -->