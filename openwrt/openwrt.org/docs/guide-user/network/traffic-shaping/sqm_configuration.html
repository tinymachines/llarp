
<h1 class="sectionedit1" id="sqm_configurationetcconfigsqm">SQM configuration /etc/config/sqm</h1>
<div class="level1">

<p>
The <em>sqm-scripts</em> package in OpenWrt controls Bufferbloat - the undesirable latency that comes from the router buffering too much data. 
Smart Queue Management (SQM) is our name for an intelligent combination of better packet scheduling (flow queueing) techniques along with with active queue length management (AQM).
</p>

<p>
The <a href="/docs/guide-user/network/traffic-shaping/sqm" class="wikilink1" title="docs:guide-user:network:traffic-shaping:sqm" data-wiki-id="docs:guide-user:network:traffic-shaping:sqm">Smart Queue Management (SQM)</a> page explains how to setup SQM to mitigate bufferbloat latency.
</p>

<p>
This page discusses options found in the SQM configuration file in <code>/etc/config/sqm</code>.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;SQM configuration \/etc\/config\/sqm&quot;,&quot;hid&quot;:&quot;sqm_configurationetcconfigsqm&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:1,&quot;range&quot;:&quot;1-604&quot;} -->
<h3 class="sectionedit2" id="sections">Sections</h3>
<div class="level3">

<p>
The <code>queue</code> section declares buffer parameters for an interface.
</p>
<div class="table sectionedit3"><table class="inline">
	<thead>
	<tr class="row0">
		<th class="col0 leftalign"> Name     </th><th class="col1 leftalign"> Type    </th><th class="col2"> Required </th><th class="col3 leftalign"> Default   </th><th class="col4"> Description </th>
	</tr>
	</thead>
	<tr class="row1">
		<td class="col0 leftalign"> <code>enabled</code>   </td><td class="col1 centeralign">  boolean  </td><td class="col2 leftalign">    </td><td class="col3 centeralign">  <em>no</em>  </td><td class="col4 leftalign"> enable or disable the queue section  </td>
	</tr>
	<tr class="row2">
		<td class="col0"> <code>interface</code> </td><td class="col1 centeralign">  string  </td><td class="col2 centeralign">  yes  </td><td class="col3 centeralign">  <em>eth0</em>  </td><td class="col4"> interface name </td>
	</tr>
	<tr class="row3">
		<td class="col0 leftalign"> <code>upload</code>    </td><td class="col1 centeralign">  integer  </td><td class="col2 leftalign">    </td><td class="col3 centeralign">  <em>2032</em>  </td><td class="col4"> Upload speed (kbit/s) (egress) set to 0 to selectively disable egress shaping </td>
	</tr>
	<tr class="row4">
		<td class="col0 leftalign"> <code>download</code>  </td><td class="col1 centeralign">  integer  </td><td class="col2 leftalign">    </td><td class="col3 centeralign">  <em>14698</em>  </td><td class="col4"> Download speed (kbit/s) (ingress) set to 0 to selectively disable ingress shaping </td>
	</tr>
	<tr class="row5">
		<td class="col0"> <code>linklayer</code> </td><td class="col1 centeralign">  string  </td><td class="col2 leftalign">    </td><td class="col3 centeralign">  <em>none</em>  </td><td class="col4"> “none”, “ethernet”, or “atm”. Link-layer adaptation. See <a href="/docs/guide-user/network/traffic-shaping/sqm#sqmlink_layer_adaptation_tab" class="wikilink1" title="docs:guide-user:network:traffic-shaping:sqm" data-wiki-id="docs:guide-user:network:traffic-shaping:sqm">sqmlink_layer_adaptation_tab</a> </td>
	</tr>
	<tr class="row6">
		<td class="col0 leftalign"> <code>overhead</code>  </td><td class="col1 centeralign">  integer  </td><td class="col2 leftalign">    </td><td class="col3 centeralign">  <em>0</em>  </td><td class="col4"> Per Packet Overhead, bytes </td>
	</tr>
	<tr class="row7">
		<td class="col0 leftalign"> <code>tcMTU</code>     </td><td class="col1 centeralign">  integer  </td><td class="col2 leftalign">    </td><td class="col3 centeralign">  <em>2047</em>  </td><td class="col4"> Maximal Size for size and rate calculations, bytes; needs to be &gt;= interface <abbr title="Maximum Transmission Unit">MTU</abbr> + overhead </td>
	</tr>
	<tr class="row8">
		<td class="col0 leftalign"> <code>tcTSIZE</code>   </td><td class="col1 centeralign">  integer  </td><td class="col2 leftalign">    </td><td class="col3 centeralign">  <em>512</em>  </td><td class="col4"> Number of entries in size/rate tables, TSIZE; for ATM choose TSIZE = (tcMTU + 1) / 16 </td>
	</tr>
	<tr class="row9">
		<td class="col0 leftalign"> <code>tcMPU</code>     </td><td class="col1 centeralign">  integer  </td><td class="col2 leftalign">    </td><td class="col3 centeralign">  <em>0</em>  </td><td class="col4"> Minimal packet size, MPU (byte); needs to be &gt; 0 for ethernet size tables </td>
	</tr>
	<tr class="row10">
		<td class="col0 leftalign"> <code>ilimit</code>    </td><td class="col1 centeralign">  integer  </td><td class="col2 leftalign">    </td><td class="col3 centeralign">  <em>(none)</em>  </td><td class="col4"> Hard limit on ingress queues; leave empty for default </td>
	</tr>
	<tr class="row11">
		<td class="col0 leftalign"> <code>elimit</code>    </td><td class="col1 centeralign">  integer  </td><td class="col2 leftalign">    </td><td class="col3 centeralign">  <em>(none)</em>  </td><td class="col4"> Hard limit on egress queues; leave empty for default </td>
	</tr>
	<tr class="row12">
		<td class="col0 leftalign"> <code>itarget</code>   </td><td class="col1 centeralign">  string  </td><td class="col2 leftalign">    </td><td class="col3 centeralign">  <em>(none)</em>  </td><td class="col4"> Latency target for ingress, e.g 5ms [units: s, ms, or  us]; leave empty for automatic selection, put in the word default for the qdisc&#039;s default. </td>
	</tr>
	<tr class="row13">
		<td class="col0 leftalign"> <code>etarget</code>   </td><td class="col1 centeralign">  string  </td><td class="col2 leftalign">    </td><td class="col3 centeralign">  <em>(none)</em>  </td><td class="col4"> Latency target for egress, e.g. 5ms [units: s, ms, or  us]; leave empty for automatic selection, put in the word default for the qdisc&#039;s default. </td>
	</tr>
	<tr class="row14">
		<td class="col0"> <code>ingress_ecn</code> </td><td class="col1 centeralign">  string   </td><td class="col2 leftalign">   </td><td class="col3 centeralign">  <em>ECN</em>  </td><td class="col4"> “ECN” or “NOECN”. Explicit congestion notification (ECN) status on inbound packets (ingress) </td>
	</tr>
	<tr class="row15">
		<td class="col0 leftalign"> <code>egress_ecn</code>  </td><td class="col1 centeralign">  string  </td><td class="col2 leftalign">   </td><td class="col3 centeralign">  <em>ECN</em>  </td><td class="col4"> “ECN” or “NOECN”. Explicit congestion notification (ECN) status on outbound packets (egress) </td>
	</tr>
	<tr class="row16">
		<td class="col0 leftalign"> <code>target</code>      </td><td class="col1 centeralign">  string  </td><td class="col2 leftalign">    </td><td class="col3 centeralign">  <em>5ms</em>  </td><td class="col4"> Latency target for ingress, e.g 5ms [units: s, ms, or  us]; leave empty for automatic selection, put in the word default for the qdisc&#039;s default. </td>
	</tr>
	<tr class="row17">
		<td class="col0"> <code>squash_dscp</code> </td><td class="col1 centeralign">  integer  </td><td class="col2 leftalign">    </td><td class="col3 centeralign">  <em>1</em>  </td><td class="col4"> Squash DSCP on inbound packets (ingress). 1 = squash, 0 = do not squash </td>
	</tr>
	<tr class="row18">
		<td class="col0"> <code>squash_ingress</code> </td><td class="col1 centeralign">  integer  </td><td class="col2 leftalign">    </td><td class="col3 centeralign">  <em>1</em>  </td><td class="col4"> Ignore DSCP on ingress. 1 = ignore, 0 = allow </td>
	</tr>
	<tr class="row19">
		<td class="col0 leftalign"> <code>qdisc</code>       </td><td class="col1 centeralign">  string  </td><td class="col2 leftalign">    </td><td class="col3 centeralign">  <em>fq_codel</em>  </td><td class="col4"> fq_codel efq_codel nfq_codel sfq codel ns2_codel pie sfq cake <em>(availability varies, check /var/run/sqm/available_qdiscs)</em> </td>
	</tr>
	<tr class="row20">
		<td class="col0 leftalign"> <code>script</code>      </td><td class="col1 centeralign">  string  </td><td class="col2 leftalign">    </td><td class="col3 centeralign">  <em>simple.qos</em>  </td><td class="col4"> Queue setup script (see table below) </td>
	</tr>
	<tr class="row21">
		<td class="col0"> <code>iqdisc_opts</code> </td><td class="col1 centeralign">  string   </td><td class="col2 leftalign">    </td><td class="col3 centeralign">  <em>(none)</em>  </td><td class="col4"> Advanced option string to pass to the ingress queueing disciplines; no error checking, use very carefully. </td>
	</tr>
	<tr class="row22">
		<td class="col0"> <code>eqdisc_opts</code> </td><td class="col1 centeralign">  string   </td><td class="col2 leftalign">    </td><td class="col3 centeralign">  <em>(none)</em>  </td><td class="col4"> Advanced option string to pass to the egress queueing disciplines; no error checking, use very carefully. </td>
	</tr>
	<tr class="row23">
		<td class="col0"> <code>qdisc_advanced</code> </td><td class="col1 centeralign">  boolean  </td><td class="col2 leftalign">    </td><td class="col3 centeralign">  <em>false</em>  </td><td class="col4 leftalign"> [only used by the luci-app-sqm package]  </td>
	</tr>
	<tr class="row24">
		<td class="col0"> <code>qdisc_really_really_advanced</code> </td><td class="col1 centeralign">  boolean  </td><td class="col2 leftalign">    </td><td class="col3 centeralign">  <em>false</em>  </td><td class="col4"> [only used by the luci-app-sqm package] </td>
	</tr>
</table></div>
<!-- EDIT{&quot;target&quot;:&quot;table&quot;,&quot;name&quot;:&quot;&quot;,&quot;hid&quot;:&quot;table&quot;,&quot;secid&quot;:3,&quot;range&quot;:&quot;692-3926&quot;} -->
</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Sections&quot;,&quot;hid&quot;:&quot;sections&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:2,&quot;range&quot;:&quot;605-3927&quot;} -->
<h3 class="sectionedit4" id="queue_setup_scripts">Queue Setup Scripts</h3>
<div class="level3">
<div class="table sectionedit5"><table class="inline">
	<thead>
	<tr class="row0">
		<th class="col0 leftalign"> Name  </th><th class="col1"> Default </th><th class="col2"> Description </th>
	</tr>
	</thead>
	<tr class="row1">
		<td class="col0"> <code>simple.qos</code> </td><td class="col1"> yes </td><td class="col2"> BW-limited three-tier prioritisation scheme with fq_codel on each queue. </td>
	</tr>
	<tr class="row2">
		<td class="col0"> <code>simplest.qos</code> </td><td class="col1"> no </td><td class="col2"> Simplest possible configuration: HTB rate limiter with your qdisc attached. </td>
	</tr>
	<tr class="row3">
		<td class="col0"> <code>layer_cake.qos</code> </td><td class="col1"> no </td><td class="col2"> This uses the cake qdisc as a replacement for htb as shaper and fq_codel as leaf qdisc. This exercises cake&#039;s diffserv profile(s) as different “layers” of priority. This script requires that cake is selected as qdisc. See: <a href="http://www.bufferbloat.net/projects/codel/wiki/Cake" class="urlextern" title="http://www.bufferbloat.net/projects/codel/wiki/Cake" rel="ugc nofollow">http://www.bufferbloat.net/projects/codel/wiki/Cake</a> for more information </td>
	</tr>
	<tr class="row4">
		<td class="col0"> <code>piece_of_cake.qos</code> </td><td class="col1"> no </td><td class="col2"> This just uses the cake qdisc as a replacement for htb as shaper and fq_codel as leaf qdisc. It just does not come any simpler than this, in other words it truly is a “piece of cake”. This script requires that cake is selected as qdisc. See: <a href="http://www.bufferbloat.net/projects/codel/wiki/Cake" class="urlextern" title="http://www.bufferbloat.net/projects/codel/wiki/Cake" rel="ugc nofollow">http://www.bufferbloat.net/projects/codel/wiki/Cake</a> for more information </td>
	</tr>
	<tr class="row5">
		<td class="col0"> <code>simplest_tbf.qos</code> </td><td class="col1"> no </td><td class="col2"> Simplest possible configuration (TBF): TBF rate limiter with your qdisc attached. TBF may give better performance than HTB on some architectures. </td>
	</tr>
</table></div>
<!-- EDIT{&quot;target&quot;:&quot;table&quot;,&quot;name&quot;:&quot;&quot;,&quot;hid&quot;:&quot;table1&quot;,&quot;secid&quot;:5,&quot;range&quot;:&quot;3958-5047&quot;} -->
</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Queue Setup Scripts&quot;,&quot;hid&quot;:&quot;queue_setup_scripts&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:4,&quot;range&quot;:&quot;3928-&quot;} -->