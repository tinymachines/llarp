
<h1 class="sectionedit1" id="network_components">Network Components</h1>
<div class="level1">

<p>
This section is intended as a primer for how to setup a home or small office network.
The following explanation is intended as a basic intro into the components and their respective roles. As always in networking (as it was intended from the beginning) there multiple ways of setting up the topology, depending on the goals you are trying to achieve. 
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Network Components&quot;,&quot;hid&quot;:&quot;network_components&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:1,&quot;range&quot;:&quot;1-386&quot;} -->
<h2 class="sectionedit2" id="ideal_topologystar">Ideal Topology: Star</h2>
<div class="level2">

<p>
The following picture describes the ideal layout of a network using the <a href="https://en.wikipedia.org/wiki/Star_network" class="interwiki iw_wp" title="https://en.wikipedia.org/wiki/Star_network">Star topology</a> as this gives every client maximum performance (highest bandwidth, lowest latency) when reaching every other component and the internet.
</p>

<p>

<a href="https://forum.openwrt.org/uploads/default/original/3X/b/d/bd40bd8526af33f0a2ff7ab6aa9089f867f60ec5.jpeg" class="urlextern" title="https://forum.openwrt.org/uploads/default/original/3X/b/d/bd40bd8526af33f0a2ff7ab6aa9089f867f60ec5.jpeg" rel="ugc nofollow">https://forum.openwrt.org/uploads/default/original/3X/b/d/bd40bd8526af33f0a2ff7ab6aa9089f867f60ec5.jpeg</a>

</p>

<p>
The components present are:
</p>
<ul>
<li class="level1 node"><div class="li"> The network entry is done trough a component which provides the functions:</div>
<ul>
<li class="level2 node"><div class="li"> <a href="https://en.wikipedia.org/wiki/Router_(computing)" class="interwiki iw_wp" title="https://en.wikipedia.org/wiki/Router_(computing)">Router</a> - Sends requests between the internal network and external network (internet)</div>
<ul>
<li class="level3 node"><div class="li"> This will have a connection to the <a href="https://en.wikipedia.org/wiki/Internet_service_provider" class="interwiki iw_wp" title="https://en.wikipedia.org/wiki/Internet_service_provider">ISP</a> which can be done over:</div>
<ul>
<li class="level4"><div class="li"> Ethernet either directly (e.g. <a href="https://en.wikipedia.org/wiki/Point-to-Point_Protocol_over_Ethernet" class="interwiki iw_wp" title="https://en.wikipedia.org/wiki/Point-to-Point_Protocol_over_Ethernet">PPPoE</a>)</div>
</li>
<li class="level4"><div class="li"> Trough a <a href="https://en.wikipedia.org/wiki/Cable_modem" class="interwiki iw_wp" title="https://en.wikipedia.org/wiki/Cable_modem">modem</a></div>
</li>
<li class="level4"><div class="li"> <a href="https://en.wikipedia.org/wiki/Fiber-optic_cable" class="interwiki iw_wp" title="https://en.wikipedia.org/wiki/Fiber-optic_cable">Fiber optic cable</a> plugged into the <a href="https://en.wikipedia.org/wiki/Small_Form-factor_Pluggable" class="interwiki iw_wp" title="https://en.wikipedia.org/wiki/Small_Form-factor_Pluggable">SFP transceiver</a> for that type of cable, which then gets inserted into the SFP port on the device</div>
</li>
<li class="level4"><div class="li"> Other external component</div>
</li>
</ul>
</li>
<li class="level3"><div class="li"> It can be also be configured to provide access from multiple <abbr title="Internet Service Provider">ISP</abbr> for increased internet bandwidth and/or fail-over in case one <abbr title="Internet Service Provider">ISP</abbr> fails</div>
</li>
</ul>
</li>
<li class="level2"><div class="li"> <a href="https://en.wikipedia.org/wiki/Firewall_(computing)" class="interwiki iw_wp" title="https://en.wikipedia.org/wiki/Firewall_(computing)">Firewall</a> - Prevents unauthorized access to the internal network</div>
</li>
<li class="level2"><div class="li"> <a href="https://en.wikipedia.org/wiki/Dynamic_Host_Configuration_Protocol" class="interwiki iw_wp" title="https://en.wikipedia.org/wiki/Dynamic_Host_Configuration_Protocol">DHCP</a> - Provides a unique <abbr title="Internet Protocol">IP</abbr> addresses to each individual client on the internal network</div>
</li>
</ul>
</li>
<li class="level1"><div class="li"> The <a href="https://en.wikipedia.org/wiki/Network_switch" class="interwiki iw_wp" title="https://en.wikipedia.org/wiki/Network_switch">switch</a> where all the clients are directly connected to trough physical connections using either Ethernet or SFP (e.g. fiber optic or copper). The switch will also be connected to the Router mentioned above using physical connection (Ethernet or SFP). It can be <em>unmanaged</em> (plug and play) where all clients have access to all other clients, or with various levels of configuration options. OpenWRT can be installed on some of these to bring its feature set closer to an <em>enterprise managed switch</em></div>
</li>
<li class="level1"><div class="li"> The <a href="https://en.wikipedia.org/wiki/Wireless_access_point" class="interwiki iw_wp" title="https://en.wikipedia.org/wiki/Wireless_access_point">Wireless Access Points</a> which can be located in various locations to provide WiFi coverage over the entire desired area. The APs will be connected using physical connections to the switch so as to maximize available wireless bandwidth for the clients.</div>
</li>
</ul>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Ideal Topology: Star&quot;,&quot;hid&quot;:&quot;ideal_topologystar&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:2,&quot;range&quot;:&quot;387-2800&quot;} -->
<h2 class="sectionedit3" id="common_topologytree_network">Common Topology: Tree Network</h2>
<div class="level2">

<p>
Due to the difficulties implementing the Star topology, mainly cause by the need to run physical connections between every present and future client to a central location, the most common topology in practice is the <a href="https://en.wikipedia.org/wiki/Tree_network" class="interwiki iw_wp" title="https://en.wikipedia.org/wiki/Tree_network">Tree Network</a>.
</p>
<ul>
<li class="level1"><div class="li"> This has the advantage of running only one (or small number) of physical connections to the central switch</div>
</li>
<li class="level1"><div class="li"> But has the disadvantage of having this connection as a potential bottleneck for bandwidth, as well as increasing the latency because every switch will necessarily have to receive and forward the network packages</div>
</li>
</ul>

<p>
Below are two examples of this topology where the function of the Router, Firewall, <abbr title="Dynamic Host Configuration Protocol">DHCP</abbr>, Switch and Access point are been provided by a single device, plus one or more additional downstream switches.
</p>
<ul>
<li class="level1"><div class="li"> If additional switches <em>must</em> be deployed, ideally there should only be one.</div>
</li>
<li class="level1"><div class="li"> If two downstream switches <em>must</em> be deployed, then both of these should ideally be connected to the main switch, <strong>NOT</strong> <a href="https://en.wikipedia.org/wiki/Daisy_chain_(electrical_engineering)" class="interwiki iw_wp" title="https://en.wikipedia.org/wiki/Daisy_chain_(electrical_engineering)">daisy chained</a></div>
</li>
</ul>
<ul>
<li class="level1 node"><div class="li"> Single downstream switch</div>
<ul>
<li class="level2"><div class="li"> <a href="https://forum.openwrt.org/uploads/default/original/3X/f/2/f2aaf08e9ec0143894d0729317ed9281d491604e.jpeg" class="urlextern" title="https://forum.openwrt.org/uploads/default/original/3X/f/2/f2aaf08e9ec0143894d0729317ed9281d491604e.jpeg" rel="ugc nofollow">https://forum.openwrt.org/uploads/default/original/3X/f/2/f2aaf08e9ec0143894d0729317ed9281d491604e.jpeg</a></div>
</li>
<li class="level2"><div class="li"> In this example there is only one downstream switch connected trough an higher bandwidth SFP back to the main router to reduce the effect of the bottleneck between the downstream switch and the router&#039;s internal switch</div>
</li>
<li class="level2"><div class="li"> The server is also connected trough an high speed SFP (e.g. Direct Attach Copper Cable SFP+) back to the internal switch of the router</div>
</li>
</ul>
</li>
<li class="level1 node"><div class="li"> Multiple downstream switches</div>
<ul>
<li class="level2"><div class="li"> <a href="https://forum.openwrt.org/uploads/default/original/3X/b/a/ba2a4fe5555cbb3fad8463d4a71882733e6a578b.jpeg" class="urlextern" title="https://forum.openwrt.org/uploads/default/original/3X/b/a/ba2a4fe5555cbb3fad8463d4a71882733e6a578b.jpeg" rel="ugc nofollow">https://forum.openwrt.org/uploads/default/original/3X/b/a/ba2a4fe5555cbb3fad8463d4a71882733e6a578b.jpeg</a></div>
</li>
<li class="level2"><div class="li"> In this example there are two switches downstream from the internal router&#039;s switch. Possible reasons for such a setup would be having one high speed switch (2.5GbE) and one low speed (1GbE or 100MbE) switch providing PoE for TVs and security cameras</div>
</li>
<li class="level2"><div class="li"> Keep in mind that if any packages from clients in the downstream switches to clients of another downstream switch will have to traverse three switches to reach their target.</div>
</li>
</ul>
</li>
</ul>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Common Topology: Tree Network&quot;,&quot;hid&quot;:&quot;common_topologytree_network&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:3,&quot;range&quot;:&quot;2801-4981&quot;} -->
<h2 class="sectionedit4" id="use_of_physical_connections">Use of physical connections</h2>
<div class="level2">

<p>
<strong>Most importantly</strong>: All clients (and of course switches) that can be connected using physical connections (Ethernet, SFP+) should be connected. The reason is because when using roads as an analogy:
</p>
<ul>
<li class="level1 node"><div class="li"> Physical connections are like a private <a href="https://en.wikipedia.org/wiki/Controlled-access_highway" class="interwiki iw_wp" title="https://en.wikipedia.org/wiki/Controlled-access_highway">Controlled-access_highway</a>, where the communication is <a href="https://en.wikipedia.org/wiki/Duplex_(telecommunications)#Full_duplex" class="interwiki iw_wp" title="https://en.wikipedia.org/wiki/Duplex_(telecommunications)#Full_duplex">Full_duplex</a> (in the vast majority of cases). </div>
<ul>
<li class="level3"><div class="li"> This means that a 1GbE connection can do 1GbE download and 1GbE upload <strong>at the same time</strong> (for a total bidirectional speed of 2GbE) but will <strong>not</strong> do 2GbE in any single direction. This speed will be constant up to the <a href="https://en.wikipedia.org/wiki/Category_6_cable#Maximum_length" class="interwiki iw_wp" title="https://en.wikipedia.org/wiki/Category_6_cable#Maximum_length">maximum allowed length</a> of the connection</div>
</li>
</ul>
</li>
<li class="level2 node"><div class="li"> WiFi connections are like <a href="https://en.wikipedia.org/wiki/Arterial_road" class="interwiki iw_wp" title="https://en.wikipedia.org/wiki/Arterial_road">roads with multiple lanes</a> shared between all devices <strong>and</strong> with the neighbors, and subject to <a href="https://en.wikipedia.org/wiki/Electromagnetic_interference" class="interwiki iw_wp" title="https://en.wikipedia.org/wiki/Electromagnetic_interference">radio interference</a> and speed dropping with distance and obstacles.</div>
<ul>
<li class="level3"><div class="li"> Using the same analogy, a WiFi channel in the <a href="https://en.wikipedia.org/wiki/List_of_WLAN_channels" class="interwiki iw_wp" title="https://en.wikipedia.org/wiki/List_of_WLAN_channels">2.4 GHz</a>, <a href="https://en.wikipedia.org/wiki/List_of_WLAN_channels#5_GHz_%28802.11a%2Fh%2Fn%2Fac%2Fax%29" class="interwiki iw_wp" title="https://en.wikipedia.org/wiki/List_of_WLAN_channels#5_GHz_%28802.11a%2Fh%2Fn%2Fac%2Fax%29">5GHz</a> or <a href="https://en.wikipedia.org/wiki/List_of_WLAN_channels#6_GHz_%28802.11ax_and_802.11be%29" class="interwiki iw_wp" title="https://en.wikipedia.org/wiki/List_of_WLAN_channels#6_GHz_%28802.11ax_and_802.11be%29">6GHz</a> can only ever have a certain physical width (Channel widths are 20,40, 80, 160, 320 <abbr title="Megahertz">MHz</abbr>). This channel width is the maximum number of lanes that can used for both upload and download. </div>
</li>
<li class="level3 node"><div class="li"> Assuming that the physical speed of the WiFi connection (WiFi 6) is 1201 Mbps (80 <abbr title="Megahertz">MHz</abbr> channel, 1024-QAM, 2Ã—2 MIMO) close to the access point, this 1201 Mbps is the maximum shared between multiple devices and neighbors. <a href="https://www.wiisfi.com/#PHY" class="urlextern" title="https://www.wiisfi.com/#PHY" rel="ugc nofollow">https://www.wiisfi.com/#PHY</a></div>
<ul>
<li class="level4"><div class="li"> As an example: 520 Mbps DL + 416 UL + 265 a neighbor the actual throughput (taking into account interference, losses and overhead) for the download will probably be about 365 Mbps for the device downloading, and upload of 290 Mbps for another device uploading at the same time, and approximately 185 Mbps used by the neighbor (total for upload and download)</div>
</li>
<li class="level4"><div class="li"> In an ideal scenario where only one device is downloading using this channel and no other devices nearby the speed might actually be 840Mbps (again taking into account interference, losses and overhead).</div>
</li>
</ul>
</li>
</ul>
</li>
</ul>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Use of physical connections&quot;,&quot;hid&quot;:&quot;use_of_physical_connections&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:4,&quot;range&quot;:&quot;4982-7227&quot;} -->
<h2 class="sectionedit5" id="choosing_components">Choosing components</h2>
<div class="level2">

<p>
The following section describes possibilities when choosing components, not as an exhaustive list. Ever since it&#039;s inception at <a href="https://en.wikipedia.org/wiki/ARPANET" class="interwiki iw_wp" title="https://en.wikipedia.org/wiki/ARPANET">ARPANET</a> the networking layer is designed to work with a wide range of equipment and provide redundancy in case one path fails.
When installing a new network, or upgrading an existing network as described in the previous section the following items need to be considered:
</p>
<ul>
<li class="level1 node"><div class="li"> Router resources (CPU, RAM, storage); This describes the most common situation when the router, firewall and <abbr title="Dynamic Host Configuration Protocol">DHCP</abbr> are on the same device and will be simply called router. Each of these functions can potentially be done by separate physical or virtual (VM) devices</div>
<ul>
<li class="level2"><div class="li"> Enough (CPU, RAM) for it&#039;s primary task: to route (<a href="https://en.wikipedia.org/wiki/Network_address_translation" class="interwiki iw_wp" title="https://en.wikipedia.org/wiki/Network_address_translation">NAT</a>) the requests.</div>
</li>
<li class="level2"><div class="li"> Having hardware flow offloading (and if implemented by OpenWRT for that device) decreases the necessary processing power, as the packages are forwarded without analysis but that makes it incompatible with SQM</div>
</li>
<li class="level2"><div class="li"> Increased (CPU, RAM) if running <a href="https://en.wikipedia.org/wiki/Active_queue_management#Active_queue_management_algorithms" class="interwiki iw_wp" title="https://en.wikipedia.org/wiki/Active_queue_management#Active_queue_management_algorithms">SQM</a> which inspects every package to decide the order in which they will be sent or dropped if the network is overloaded</div>
</li>
<li class="level2"><div class="li"> Increased (CPU, RAM, storage) if running additional tasks (e.g. network related packages or containers like AdBlock, PiHole, Grafana)</div>
</li>
</ul>
</li>
<li class="level1 node"><div class="li"> Switch link type (Ethernet, SFP+) speed (100MbE, 1GbE, 2.5GbE, 5GbE, 10GbE, etc.)</div>
<ul>
<li class="level2"><div class="li"> 100MbE should only be considered when attempting to deploy low bandwidth usage devices (TVs, security cameras, IoT devices), optionally with PoE</div>
</li>
<li class="level2"><div class="li"> 1GbE should be considered the minimum for all other devices as it is cheap enough and widely available.</div>
</li>
<li class="level2"><div class="li"> 2.5GbE is becoming more common in regular deployments </div>
</li>
<li class="level2"><div class="li"> 5GbE and 10GbE are yet to be commonly adopted, requiring a use case to justify a need for the added cost</div>
</li>
<li class="level2"><div class="li"> To get an understanding of what kind of device is needed please read this: <a href="https://forum.openwrt.org/t/minimum-hardware-specs-to-run-open-wrt-on-pppoe-on-a-gigabit-connection/184365/9" class="urlextern" title="https://forum.openwrt.org/t/minimum-hardware-specs-to-run-open-wrt-on-pppoe-on-a-gigabit-connection/184365/9" rel="ugc nofollow">https://forum.openwrt.org/t/minimum-hardware-specs-to-run-open-wrt-on-pppoe-on-a-gigabit-connection/184365/9</a></div>
</li>
</ul>
</li>
<li class="level1 node"><div class="li"> Physical connection link speeds (over Ethernet or SFP+).</div>
<ul>
<li class="level2"><div class="li"> Using the rule of thumb: cables are cheap but hard to replace while networking equipment is expensive but easy to replace then the highest speed cables should be deployed with the selected networking equipment.</div>
</li>
<li class="level2"><div class="li"> The lengths provided are as a reference only, and account for using patch cables at each end. The reasoning is that the main cable is hard to replace or terminate, whereas the ends are the most easily replace if they are no longer working due to repeated insertions or movement.</div>
</li>
<li class="level2"><div class="li"> <a href="https://en.wikipedia.org/wiki/Category_5_cable" class="interwiki iw_wp" title="https://en.wikipedia.org/wiki/Category_5_cable">Cat 5e</a> should be considered as the bare minimum. It can run up to speeds of 2.5GbE at a distance of 100m or 1GbE at 100m</div>
</li>
<li class="level2"><div class="li"> <a href="https://en.wikipedia.org/wiki/Category_6_cable" class="interwiki iw_wp" title="https://en.wikipedia.org/wiki/Category_6_cable">Cat 6 or 6A</a> should really be used when deploying new cable. CAT 6A can run up to speeds of 10GbE at a distance of 100m and CAT 6 can run 5GbE at 100m</div>
</li>
<li class="level2"><div class="li"> <a href="https://en.wikipedia.org/wiki/ISO/IEC_11801#CAT7" class="interwiki iw_wp" title="https://en.wikipedia.org/wiki/ISO/IEC_11801#CAT7">Cat 7</a> exists, but has different connectors which are not compatible with existing network cards</div>
</li>
<li class="level2"><div class="li"> For speeds of 10GbE and higher connections using SFP+ are commonly used currently, usually with <a href="https://en.wikipedia.org/wiki/Twinaxial_cabling#Networking_%28Direct-Attach_Copper%29" class="interwiki iw_wp" title="https://en.wikipedia.org/wiki/Twinaxial_cabling#Networking_%28Direct-Attach_Copper%29">DAC</a> for distances under 10m or <a href="https://en.wikipedia.org/wiki/Fiber-optic_cable" class="interwiki iw_wp" title="https://en.wikipedia.org/wiki/Fiber-optic_cable">fiber optic</a> for longer distances </div>
</li>
</ul>
</li>
<li class="level1"><div class="li"> <a href="https://en.wikipedia.org/wiki/Power_over_Ethernet" class="interwiki iw_wp" title="https://en.wikipedia.org/wiki/Power_over_Ethernet">Power over Ethernet</a></div>
</li>
<li class="level1 node"><div class="li"> Access Point physical placement</div>
<ul>
<li class="level2"><div class="li"> The biggest impact on coverage of a WiFi network is the distance to the Access Point (one of the components of an all in one router is the Access Point). </div>
</li>
<li class="level2 node"><div class="li"> To improve the coverage:</div>
<ul>
<li class="level3"><div class="li"> Change the placement of the existing Access Point</div>
</li>
<li class="level3"><div class="li"> Add the coverage you need with a new Access Point using a wired connection to the main router (switch). Each additional <abbr title="Access Point">AP</abbr> should be on a different channel to reduce interference as much as possible.</div>
</li>
</ul>
</li>
<li class="level2"><div class="li"> Do not use WiFi extenders. These cut the bandwidth by more than half as every packet received in either direction needs to be resent over the same channel. Double the traffic on a channel resulting in half as much bandwidth</div>
</li>
<li class="level2"><div class="li"> Do not use Mesh Network. While this works, it&#039;s using a separate frequency to bounce the packages from one Access Point to another adding latency and WiFi overhead.</div>
</li>
<li class="level2"><div class="li"> Upgrading <abbr title="Internet Service Provider">ISP</abbr> speed alone will <strong>not</strong> have any impact on coverage. </div>
</li>
<li class="level2"><div class="li"> Upgrading the all in one Router <em>might</em> improve coverage, most likely not. If there is an improved coverage that would be due to improved radio of the router&#039;s internal <abbr title="Access Point">AP</abbr> (e.g. higher MIMO, better antennas) </div>
</li>
</ul>
</li>
<li class="level1"><div class="li"> WiFi speed: Refer to <a href="https://www.wiisfi.com/" class="urlextern" title="https://www.wiisfi.com/" rel="ugc nofollow">https://www.wiisfi.com/</a> for further information</div>
</li>
</ul>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Choosing components&quot;,&quot;hid&quot;:&quot;choosing_components&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:5,&quot;range&quot;:&quot;7228-&quot;} -->