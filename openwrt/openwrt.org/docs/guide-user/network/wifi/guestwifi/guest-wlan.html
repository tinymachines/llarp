
<h1 class="sectionedit1" id="guest_wi-fi_basics">Guest Wi-Fi basics</h1>
<div class="level1">

</div>
<!-- EDIT{&quot;target&quot;:&quot;plugin_include_start&quot;,&quot;name&quot;:&quot;meta:infobox:howto_links&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:2,&quot;range&quot;:&quot;0-&quot;} --><div class="plugin_include_content plugin_include__meta:infobox:howto_links">
<div class="level1">
<!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_start&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:4,&quot;range&quot;:&quot;0-&quot;} --><div class="wrap_info plugin_wrap">
<p>
This article relies on the following:
</p>
<ul>
<li class="level1"><div class="li"> Accessing <a href="/docs/guide-quick-start/walkthrough_login" class="wikilink1" title="docs:guide-quick-start:walkthrough_login" data-wiki-id="docs:guide-quick-start:walkthrough_login">web interface</a> / <a href="/docs/guide-quick-start/sshadministration" class="wikilink1" title="docs:guide-quick-start:sshadministration" data-wiki-id="docs:guide-quick-start:sshadministration">command-line interface</a></div>
</li>
<li class="level1"><div class="li"> Managing <a href="/docs/guide-user/base-system/uci" class="wikilink1" title="docs:guide-user:base-system:uci" data-wiki-id="docs:guide-user:base-system:uci">configs</a> / <a href="/docs/guide-user/additional-software/managing_packages" class="wikilink1" title="docs:guide-user:additional-software:managing_packages" data-wiki-id="docs:guide-user:additional-software:managing_packages">packages</a> / <a href="/docs/guide-user/base-system/managing_services" class="wikilink1" title="docs:guide-user:base-system:managing_services" data-wiki-id="docs:guide-user:base-system:managing_services">services</a> / <a href="/docs/guide-user/base-system/log.essentials" class="wikilink1" title="docs:guide-user:base-system:log.essentials" data-wiki-id="docs:guide-user:base-system:log.essentials">logs</a></div>
</li>
</ul>
</div><!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_end&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:5,&quot;range&quot;:&quot;0-&quot;} -->
</div>
<!-- EDIT{&quot;target&quot;:&quot;plugin_include_end&quot;,&quot;name&quot;:&quot;meta:infobox:howto_links&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:3,&quot;range&quot;:&quot;0-&quot;} --></div>
<div class="level1">

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Guest Wi-Fi basics&quot;,&quot;hid&quot;:&quot;guest_wi-fi_basics&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:1,&quot;range&quot;:&quot;1-115&quot;} -->
<h2 class="sectionedit6" id="introduction">Introduction</h2>
<div class="level2">
<ul>
<li class="level1"><div class="li"> Guest Wi-Fi provides an isolated wireless network which is independent from your main <abbr title="Wireless Local Area Network">WLAN</abbr>.</div>
</li>
<li class="level1"><div class="li"> Guest clients have internet connectivity and restricted <abbr title="Local Area Network">LAN</abbr> connectivity.</div>
</li>
<li class="level1"><div class="li"> Follow <a href="/docs/guide-user/network/wifi/guestwifi/extras" class="wikilink1" title="docs:guide-user:network:wifi:guestwifi:extras" data-wiki-id="docs:guide-user:network:wifi:guestwifi:extras">Guest Wi-Fi extras</a> for additional tuning.</div>
</li>
</ul>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Introduction&quot;,&quot;hid&quot;:&quot;introduction&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:6,&quot;range&quot;:&quot;116-418&quot;} -->
<h2 class="sectionedit7" id="goals">Goals</h2>
<div class="level2">
<ul>
<li class="level1"><div class="li"> Create an open wireless network independent from the main <abbr title="Wireless Local Area Network">WLAN</abbr>.</div>
</li>
<li class="level1"><div class="li"> Provide internet connectivity to guest clients and restrict <abbr title="Local Area Network">LAN</abbr> connectivity.</div>
</li>
</ul>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Goals&quot;,&quot;hid&quot;:&quot;goals&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:7,&quot;range&quot;:&quot;419-587&quot;} -->
<h2 class="sectionedit8" id="command-line_instructions">Command-line instructions</h2>
<div class="level2">

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Command-line instructions&quot;,&quot;hid&quot;:&quot;command-line_instructions&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:8,&quot;range&quot;:&quot;588-625&quot;} -->
<h3 class="sectionedit9" id="network">1. Network</h3>
<div class="level3">

<p>
Set up a guest network interface.
</p>
<pre class="code bash"><span class="co0"># Configure network</span>
uci <span class="re5">-q</span> delete network.guest_dev
uci <span class="kw1">set</span> network.guest_dev=<span class="st0">&quot;device&quot;</span>
uci <span class="kw1">set</span> network.guest_dev.type=<span class="st0">&quot;bridge&quot;</span>
uci <span class="kw1">set</span> network.guest_dev.name=<span class="st0">&quot;br-guest&quot;</span>
uci <span class="re5">-q</span> delete network.guest
uci <span class="kw1">set</span> network.guest=<span class="st0">&quot;interface&quot;</span>
uci <span class="kw1">set</span> network.guest.proto=<span class="st0">&quot;static&quot;</span>
uci <span class="kw1">set</span> network.guest.device=<span class="st0">&quot;br-guest&quot;</span>
uci <span class="kw1">set</span> network.guest.ipaddr=<span class="st0">&quot;192.168.3.1/24&quot;</span>
uci commit network
service network restart</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;1. Network&quot;,&quot;hid&quot;:&quot;network&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:9,&quot;range&quot;:&quot;626-1099&quot;} -->
<h3 class="sectionedit10" id="wireless">2. Wireless</h3>
<div class="level3">

<p>
Set up a wireless interface bound to the guest network interface.
</p>
<pre class="code bash"><span class="co0"># Configure wireless</span>
<span class="re2">WIFI_DEV</span>=<span class="st0">&quot;<span class="es4">$(uci get wireless.@wifi-iface[0].device)</span>&quot;</span>
uci <span class="re5">-q</span> delete wireless.guest
uci <span class="kw1">set</span> wireless.guest=<span class="st0">&quot;wifi-iface&quot;</span>
uci <span class="kw1">set</span> wireless.guest.device=<span class="st0">&quot;<span class="es3">${WIFI_DEV}</span>&quot;</span>
uci <span class="kw1">set</span> wireless.guest.mode=<span class="st0">&quot;ap&quot;</span>
uci <span class="kw1">set</span> wireless.guest.network=<span class="st0">&quot;guest&quot;</span>
uci <span class="kw1">set</span> wireless.guest.ssid=<span class="st0">&quot;guest&quot;</span>
uci <span class="kw1">set</span> wireless.guest.encryption=<span class="st0">&quot;none&quot;</span>
uci commit wireless
wifi reload</pre>

<p>
<a href="/docs/guide-user/network/wifi/guestwifi/extras#providing_encryption" class="wikilink1" title="docs:guide-user:network:wifi:guestwifi:extras" data-wiki-id="docs:guide-user:network:wifi:guestwifi:extras">Secure</a> the guest network and <a href="/docs/guide-user/network/wifi/guestwifi/extras#isolating_clients" class="wikilink1" title="docs:guide-user:network:wifi:guestwifi:extras" data-wiki-id="docs:guide-user:network:wifi:guestwifi:extras">isolate</a> its clients if necessary.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;2. Wireless&quot;,&quot;hid&quot;:&quot;wireless&quot;,&quot;codeblockOffset&quot;:1,&quot;secid&quot;:10,&quot;range&quot;:&quot;1100-1776&quot;} -->
<h3 class="sectionedit11" id="dhcp">3. DHCP</h3>
<div class="level3">

<p>
Configure a <abbr title="Dynamic Host Configuration Protocol">DHCP</abbr> pool for the guest network.
</p>
<pre class="code bash"><span class="co0"># Configure DHCP</span>
uci <span class="re5">-q</span> delete dhcp.guest
uci <span class="kw1">set</span> dhcp.guest=<span class="st0">&quot;dhcp&quot;</span>
uci <span class="kw1">set</span> dhcp.guest.interface=<span class="st0">&quot;guest&quot;</span>
uci <span class="kw1">set</span> dhcp.guest.start=<span class="st0">&quot;100&quot;</span>
uci <span class="kw1">set</span> dhcp.guest.limit=<span class="st0">&quot;150&quot;</span>
uci <span class="kw1">set</span> dhcp.guest.leasetime=<span class="st0">&quot;1h&quot;</span>
uci commit dhcp
service dnsmasq restart</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;3. DHCP&quot;,&quot;hid&quot;:&quot;dhcp&quot;,&quot;codeblockOffset&quot;:2,&quot;secid&quot;:11,&quot;range&quot;:&quot;1777-2102&quot;} -->
<h3 class="sectionedit12" id="firewall">4. Firewall</h3>
<div class="level3">

<p>
Configure firewall for the guest network.
Allow to forward traffic from the guest network to <abbr title="Wide Area Network">WAN</abbr>.
Allow <abbr title="Dynamic Host Configuration Protocol">DHCP</abbr> requests and <abbr title="Domain Name System">DNS</abbr> queries.
</p>
<pre class="code bash"><span class="co0"># Configure firewall</span>
uci <span class="re5">-q</span> delete firewall.guest
uci <span class="kw1">set</span> firewall.guest=<span class="st0">&quot;zone&quot;</span>
uci <span class="kw1">set</span> firewall.guest.name=<span class="st0">&quot;guest&quot;</span>
uci <span class="kw1">set</span> firewall.guest.network=<span class="st0">&quot;guest&quot;</span>
uci <span class="kw1">set</span> firewall.guest.input=<span class="st0">&quot;REJECT&quot;</span>
uci <span class="kw1">set</span> firewall.guest.output=<span class="st0">&quot;ACCEPT&quot;</span>
uci <span class="kw1">set</span> firewall.guest.forward=<span class="st0">&quot;REJECT&quot;</span>
uci <span class="re5">-q</span> delete firewall.guest_wan
uci <span class="kw1">set</span> firewall.guest_wan=<span class="st0">&quot;forwarding&quot;</span>
uci <span class="kw1">set</span> firewall.guest_wan.src=<span class="st0">&quot;guest&quot;</span>
uci <span class="kw1">set</span> firewall.guest_wan.dest=<span class="st0">&quot;wan&quot;</span>
uci <span class="re5">-q</span> delete firewall.guest_dns
uci <span class="kw1">set</span> firewall.guest_dns=<span class="st0">&quot;rule&quot;</span>
uci <span class="kw1">set</span> firewall.guest_dns.name=<span class="st0">&quot;Allow-DNS-Guest&quot;</span>
uci <span class="kw1">set</span> firewall.guest_dns.src=<span class="st0">&quot;guest&quot;</span>
uci <span class="kw1">set</span> firewall.guest_dns.dest_port=<span class="st0">&quot;53&quot;</span>
uci <span class="kw1">set</span> firewall.guest_dns.proto=<span class="st0">&quot;tcp udp&quot;</span>
uci <span class="kw1">set</span> firewall.guest_dns.target=<span class="st0">&quot;ACCEPT&quot;</span>
uci <span class="re5">-q</span> delete firewall.guest_dhcp
uci <span class="kw1">set</span> firewall.guest_dhcp=<span class="st0">&quot;rule&quot;</span>
uci <span class="kw1">set</span> firewall.guest_dhcp.name=<span class="st0">&quot;Allow-DHCP-Guest&quot;</span>
uci <span class="kw1">set</span> firewall.guest_dhcp.src=<span class="st0">&quot;guest&quot;</span>
uci <span class="kw1">set</span> firewall.guest_dhcp.dest_port=<span class="st0">&quot;67&quot;</span>
uci <span class="kw1">set</span> firewall.guest_dhcp.proto=<span class="st0">&quot;udp&quot;</span>
uci <span class="kw1">set</span> firewall.guest_dhcp.family=<span class="st0">&quot;ipv4&quot;</span>
uci <span class="kw1">set</span> firewall.guest_dhcp.target=<span class="st0">&quot;ACCEPT&quot;</span>
uci commit firewall
service firewall restart</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;4. Firewall&quot;,&quot;hid&quot;:&quot;firewall&quot;,&quot;codeblockOffset&quot;:3,&quot;secid&quot;:12,&quot;range&quot;:&quot;2103-3362&quot;} -->
<h2 class="sectionedit13" id="testing">Testing</h2>
<div class="level2">

<p>
Connect to the guest network.
Check your internet connectivity.
</p>
<ul>
<li class="level1"><div class="li"> <a href="https://ipleak.net/" class="urlextern" title="https://ipleak.net/" rel="ugc nofollow">ipleak.net</a></div>
</li>
</ul>

<p>
Use <a href="http://man.cx/ping%288%29" class="interwiki iw_man" title="http://man.cx/ping%288%29">ping</a>, <a href="http://man.cx/ping6%288%29" class="interwiki iw_man" title="http://man.cx/ping6%288%29">ping6</a> or <a href="http://man.cx/nmap%281%29" class="interwiki iw_man" title="http://man.cx/nmap%281%29">nmap</a> to verify your firewall configuration.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Testing&quot;,&quot;hid&quot;:&quot;testing&quot;,&quot;codeblockOffset&quot;:4,&quot;secid&quot;:13,&quot;range&quot;:&quot;3363-3599&quot;} -->
<h2 class="sectionedit14" id="troubleshooting">Troubleshooting</h2>
<div class="level2">

<p>
Collect and analyze the following information.
</p>
<pre class="code bash"><span class="co0"># Restart services</span>
service log restart; service network restart
service dnsmasq restart; service firewall restart
&nbsp;
<span class="co0"># Log and status</span>
logread; <span class="kw2">netstat</span> <span class="re5">-l</span> <span class="re5">-n</span> <span class="re5">-p</span> <span class="sy0">|</span> <span class="kw2">grep</span> <span class="re5">-e</span> dnsmasq
&nbsp;
<span class="co0"># Runtime configuration</span>
pgrep <span class="re5">-f</span> <span class="re5">-a</span> dnsmasq
<span class="kw2">ip</span> address show; <span class="kw2">ip route</span> show table all
<span class="kw2">ip rule</span> show; <span class="kw2">ip</span> <span class="re5">-6</span> rule show; nft list ruleset
<span class="kw2">head</span> <span class="re5">-v</span> <span class="re5">-n</span> <span class="re5">-0</span> <span class="sy0">/</span>etc<span class="sy0">/</span>resolv.<span class="sy0">*</span> <span class="sy0">/</span>tmp<span class="sy0">/</span>resolv.<span class="sy0">*</span> <span class="sy0">/</span>tmp<span class="sy0">/</span>resolv.<span class="sy0">*/*</span>
&nbsp;
<span class="co0"># Persistent configuration</span>
uci show network; uci show wireless; uci show dhcp; uci show firewall</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Troubleshooting&quot;,&quot;hid&quot;:&quot;troubleshooting&quot;,&quot;codeblockOffset&quot;:4,&quot;secid&quot;:14,&quot;range&quot;:&quot;3600-&quot;} -->