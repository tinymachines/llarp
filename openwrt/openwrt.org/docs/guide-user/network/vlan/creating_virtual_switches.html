
<h1 class="sectionedit1" id="splitting_vlans">Splitting VLANs</h1>
<div class="level1">

</div>
<!-- EDIT{&quot;target&quot;:&quot;plugin_include_start&quot;,&quot;name&quot;:&quot;meta:infobox:howto_links&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:2,&quot;range&quot;:&quot;0-&quot;} --><div class="plugin_include_content plugin_include__meta:infobox:howto_links">
<div class="level1">
<!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_start&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:4,&quot;range&quot;:&quot;0-&quot;} --><div class="wrap_info plugin_wrap">
<p>
This article relies on the following:
</p>
<ul>
<li class="level1"><div class="li"> Accessing <a href="/docs/guide-quick-start/walkthrough_login" class="wikilink1" title="docs:guide-quick-start:walkthrough_login" data-wiki-id="docs:guide-quick-start:walkthrough_login">web interface</a> / <a href="/docs/guide-quick-start/sshadministration" class="wikilink1" title="docs:guide-quick-start:sshadministration" data-wiki-id="docs:guide-quick-start:sshadministration">command-line interface</a></div>
</li>
<li class="level1"><div class="li"> Managing <a href="/docs/guide-user/base-system/uci" class="wikilink1" title="docs:guide-user:base-system:uci" data-wiki-id="docs:guide-user:base-system:uci">configs</a> / <a href="/docs/guide-user/additional-software/managing_packages" class="wikilink1" title="docs:guide-user:additional-software:managing_packages" data-wiki-id="docs:guide-user:additional-software:managing_packages">packages</a> / <a href="/docs/guide-user/base-system/managing_services" class="wikilink1" title="docs:guide-user:base-system:managing_services" data-wiki-id="docs:guide-user:base-system:managing_services">services</a> / <a href="/docs/guide-user/base-system/log.essentials" class="wikilink1" title="docs:guide-user:base-system:log.essentials" data-wiki-id="docs:guide-user:base-system:log.essentials">logs</a></div>
</li>
</ul>
</div><!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_end&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:5,&quot;range&quot;:&quot;0-&quot;} -->
</div>
<!-- EDIT{&quot;target&quot;:&quot;plugin_include_end&quot;,&quot;name&quot;:&quot;meta:infobox:howto_links&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:3,&quot;range&quot;:&quot;0-&quot;} --></div>
<div class="level1">

</div>
<!-- EDIT{&quot;target&quot;:&quot;plugin_include_start&quot;,&quot;name&quot;:&quot;meta:infobox:howto_links&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:6,&quot;range&quot;:&quot;0-&quot;} --><div class="plugin_include_content plugin_include__meta:infobox:howto_links">
<div class="level1">
<!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_start&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:8,&quot;range&quot;:&quot;0-&quot;} --><div class="wrap_important plugin_wrap">
<p>
This article may contain network configuration that depends on migration to DSA in OpenWrt 21.02
</p>
<ul>
<li class="level1"><div class="li"> Check if your device uses DSA or swconfig as not all devices have been migrated</div>
</li>
<li class="level1"><div class="li"> ifname@interface has been moved to device sections</div>
</li>
<li class="level1"><div class="li"> <a href="/docs/guide-user/network/dsa/start" class="wikilink1" title="docs:guide-user:network:dsa:start" data-wiki-id="docs:guide-user:network:dsa:start">DSA Networking</a></div>
</li>
<li class="level1"><div class="li"> <a href="https://forum.openwrt.org/t/mini-tutorial-for-dsa-network-config/96998" class="urlextern" title="https://forum.openwrt.org/t/mini-tutorial-for-dsa-network-config/96998" rel="ugc nofollow">Mini tutorial for DSA network config</a> on the forum</div>
</li>
<li class="level1"><div class="li"> <a href="https://openwrt.org/releases/21.02/notes-21.02.0#new_network_configuration_syntax_and_boardjson_change" class="urlextern" title="https://openwrt.org/releases/21.02/notes-21.02.0#new_network_configuration_syntax_and_boardjson_change" rel="ugc nofollow">DSA in the 21.02 release notes</a></div>
</li>
</ul>
</div><!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_end&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:9,&quot;range&quot;:&quot;0-&quot;} -->
</div>
<!-- EDIT{&quot;target&quot;:&quot;plugin_include_end&quot;,&quot;name&quot;:&quot;meta:infobox:howto_links&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:7,&quot;range&quot;:&quot;0-&quot;} --></div>
<div class="level1">

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Splitting VLANs&quot;,&quot;hid&quot;:&quot;splitting_vlans&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:1,&quot;range&quot;:&quot;1-202&quot;} -->
<h2 class="sectionedit10" id="introduction">Introduction</h2>
<div class="level2">

<p>
This how-to virtually splits off one of your devices Ethernet ports to be used for non-<abbr title="Local Area Network">LAN</abbr> purposes.
E.g. you could provide this Ethernet port for your guests or for a secured extra zone used for an office work computer separated from your <abbr title="Local Area Network">LAN</abbr> zone.
</p>

<p>
This how-to just demonstrates how to create the additional <abbr title="Virtual Local Area Network">VLAN</abbr> switch.
The <abbr title="Virtual Local Area Network">VLAN</abbr> switch created by this how-to needs to be linked to a dedicated interface and a dedicated firewall zone in subsequent steps.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Introduction&quot;,&quot;hid&quot;:&quot;introduction&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:10,&quot;range&quot;:&quot;203-685&quot;} -->
<h2 class="sectionedit11" id="web_interface_instructions">Web interface instructions</h2>
<div class="level2">

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Web interface instructions&quot;,&quot;hid&quot;:&quot;web_interface_instructions&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:11,&quot;range&quot;:&quot;686-724&quot;} -->
<h3 class="sectionedit12" id="default_configuration">Default configuration</h3>
<div class="level3">

<p>
A typical default LEDE configuration on a home router with 5 <abbr title="Local Area Network">LAN</abbr> ports looks like this, when going to the “switch” menu of LuCI:
</p>
<div class="table sectionedit13"><table class="inline">
	<tr class="row0">
		<td class="col0 centeralign" rowspan="2">  <br/>
<abbr title="Virtual Local Area Network">VLAN</abbr><br/>
ID  </td><td class="col1 centeralign">  Upstream side:<br/>
HW switch ↔ eth0 driver  </td><td class="col2 centeralign" colspan="5">  Downstream side:<br/>
HW switch ↔ physical ports  </td>
	</tr>
	<tr class="row1">
		<td class="col0 centeralign">  CPU (eth0)  </td><td class="col1 centeralign">  <abbr title="Local Area Network">LAN</abbr> 1  </td><td class="col2 centeralign">  <abbr title="Local Area Network">LAN</abbr> 2  </td><td class="col3 centeralign">  <abbr title="Local Area Network">LAN</abbr> 3  </td><td class="col4 centeralign">  <abbr title="Local Area Network">LAN</abbr> 4  </td><td class="col5 centeralign">  <abbr title="Wide Area Network">WAN</abbr>  </td>
	</tr>
	<tr class="row2">
		<td class="col0"> 1 </td><td class="col1 centeralign">  tagged  </td><td class="col2 centeralign">  untagged  </td><td class="col3 centeralign">  untagged  </td><td class="col4 centeralign">  untagged  </td><td class="col5 centeralign">  untagged  </td><td class="col6 centeralign">  off  </td>
	</tr>
	<tr class="row3">
		<td class="col0"> 2 </td><td class="col1 centeralign">  tagged  </td><td class="col2 centeralign">  off  </td><td class="col3 centeralign">  off  </td><td class="col4 centeralign">  off  </td><td class="col5 centeralign">  off  </td><td class="col6 centeralign">  untagged  </td>
	</tr>
</table></div>
<!-- EDIT{&quot;target&quot;:&quot;table&quot;,&quot;name&quot;:&quot;&quot;,&quot;hid&quot;:&quot;table&quot;,&quot;secid&quot;:13,&quot;range&quot;:&quot;886-1217&quot;} -->
<p>
This default configuration provides 2 <abbr title="Virtual Local Area Network">VLAN</abbr> switches by default:
</p>
<ol>
<li class="level1"><div class="li"> <abbr title="Virtual Local Area Network">VLAN</abbr> ID 1: the <abbr title="Virtual Local Area Network">VLAN</abbr> switch for the 4 ports (that are mapped to the <abbr title="Local Area Network">LAN</abbr> interface)</div>
</li>
<li class="level1"><div class="li"> <abbr title="Virtual Local Area Network">VLAN</abbr> ID 2: the <abbr title="Virtual Local Area Network">VLAN</abbr> switch mapped to the 1 <abbr title="Wide Area Network">WAN</abbr> port</div>
</li>
</ol>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Default configuration&quot;,&quot;hid&quot;:&quot;default_configuration&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:12,&quot;range&quot;:&quot;725-1425&quot;} -->
<h3 class="sectionedit14" id="modified_configuration">Modified configuration</h3>
<div class="level3">

<p>
As we can&#039;t magically add new physical ports to the existing device, we will simply reassign <abbr title="Local Area Network">LAN</abbr> 1 to make up a new virtual switch:
</p>
<div class="table sectionedit15"><table class="inline">
	<tr class="row0">
		<td class="col0 centeralign" rowspan="2">  <br/>
<abbr title="Virtual Local Area Network">VLAN</abbr><br/>
ID  </td><td class="col1 centeralign">  Upstream side:<br/>
HW switch ↔ eth0 driver  </td><td class="col2 centeralign" colspan="5">  Downstream side:<br/>
HW switch ↔ physical ports  </td>
	</tr>
	<tr class="row1">
		<td class="col0 centeralign">  CPU (eth0)  </td><td class="col1 centeralign">  <abbr title="Local Area Network">LAN</abbr> 1  </td><td class="col2 centeralign">  <abbr title="Local Area Network">LAN</abbr> 2  </td><td class="col3 centeralign">  <abbr title="Local Area Network">LAN</abbr> 3  </td><td class="col4 centeralign">  <abbr title="Local Area Network">LAN</abbr> 4  </td><td class="col5 centeralign">  <abbr title="Wide Area Network">WAN</abbr>  </td>
	</tr>
	<tr class="row2">
		<td class="col0"> 1 </td><td class="col1 centeralign">  tagged  </td><td class="col2 centeralign">  off  </td><td class="col3 centeralign">  untagged  </td><td class="col4 centeralign">  untagged  </td><td class="col5 centeralign">  untagged  </td><td class="col6 centeralign">  off  </td>
	</tr>
	<tr class="row3">
		<td class="col0"> 2 </td><td class="col1 centeralign">  tagged  </td><td class="col2 centeralign">  off  </td><td class="col3 centeralign">  off  </td><td class="col4 centeralign">  off  </td><td class="col5 centeralign">  off  </td><td class="col6 centeralign">  untagged  </td>
	</tr>
	<tr class="row4">
		<td class="col0"> 3 </td><td class="col1 centeralign">  tagged  </td><td class="col2 rightalign">  untagged </td><td class="col3 centeralign">  off  </td><td class="col4 centeralign">  off  </td><td class="col5 centeralign">  off  </td><td class="col6 centeralign">  off  </td>
	</tr>
</table></div>
<!-- EDIT{&quot;target&quot;:&quot;table&quot;,&quot;name&quot;:&quot;&quot;,&quot;hid&quot;:&quot;table1&quot;,&quot;secid&quot;:15,&quot;range&quot;:&quot;1591-1978&quot;} -->
<p>
Note the new third line and the change in the intersection of <abbr title="Virtual Local Area Network">VLAN</abbr> 1 and <abbr title="Local Area Network">LAN</abbr> 1. This updated configuration means that you will now have 3 <abbr title="Virtual Local Area Network">VLAN</abbr> switches:
</p>
<ol>
<li class="level1"><div class="li"> <abbr title="Virtual Local Area Network">VLAN</abbr> ID 1: the <abbr title="Virtual Local Area Network">VLAN</abbr> switch for the remaining 3 ports (that are still mapped to the <abbr title="Local Area Network">LAN</abbr> interface)</div>
</li>
<li class="level1"><div class="li"> <abbr title="Virtual Local Area Network">VLAN</abbr> ID 2: the <abbr title="Virtual Local Area Network">VLAN</abbr> switch mapped to the 1 <abbr title="Wide Area Network">WAN</abbr> port</div>
</li>
<li class="level1"><div class="li"> <abbr title="Virtual Local Area Network">VLAN</abbr> ID 3: the newly created <abbr title="Virtual Local Area Network">VLAN</abbr> switch for the 1 port <abbr title="Local Area Network">LAN</abbr> 1. This port is currently without function. You first have to assign it to an interface (in the “physical settings” tab of an existing or newly created interface)</div>
</li>
</ol>

<p>
Notes:
</p>
<ul>
<li class="level1"><div class="li"> <abbr title="Local Area Network">LAN</abbr> 1 in this example can no longer be used for <abbr title="Secure Shell">SSH</abbr> or LuCI administration, unless you link the existing <abbr title="Local Area Network">LAN</abbr> interface to this newly created <abbr title="Virtual Local Area Network">VLAN</abbr> switch eth0.3 (But usually you will want to assign this new <abbr title="Virtual Local Area Network">VLAN</abbr> to a newly created interface, which then has to be put into a new firewall zone).</div>
</li>
<li class="level1"><div class="li"> As long as one last <abbr title="Local Area Network">LAN</abbr> port remains in <abbr title="Virtual Local Area Network">VLAN</abbr> switch 1, you will still have access to LuCI and <abbr title="Secure Shell">SSH</abbr> over that port. In case you have accidentally or purposely set all ports to “off” in switch <abbr title="Virtual Local Area Network">VLAN</abbr> 1, in most cases you can still use your WiFi for LEDE admin access.</div>
</li>
<li class="level1"><div class="li"> The <abbr title="Local Area Network">LAN</abbr> IDs as used in the switch section of LuCI or in config files of UCI may not reflect the same numbering scheme used on the printed labels on the outside of your router. Due to decisions of the manufacturer, it could be inverted on some devices (4=1, 3=2, 2=3, 1=4).</div>
</li>
</ul>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Modified configuration&quot;,&quot;hid&quot;:&quot;modified_configuration&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:14,&quot;range&quot;:&quot;1426-&quot;} -->