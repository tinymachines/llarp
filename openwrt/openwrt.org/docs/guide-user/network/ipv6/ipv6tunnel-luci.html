
<h1 class="sectionedit1" id="ipv6_with_hurricane_electric_using_luci">IPv6 with Hurricane Electric using LuCI</h1>
<div class="level1">

<p>
To provide LuCI support for <abbr title="Internet Protocol version 6">IPv6</abbr>-in-<abbr title="Internet Protocol version 4">IPv4</abbr>, navigate to <strong>LuCI → System → Software</strong> and install the packages <a href="/packages/pkgdata/6in4" class="wikilink1" title="packages:pkgdata:6in4" data-wiki-id="packages:pkgdata:6in4">6in4</a> and <a href="/packages/pkgdata/luci-proto-ipv6" class="wikilink1" title="packages:pkgdata:luci-proto-ipv6" data-wiki-id="packages:pkgdata:luci-proto-ipv6">luci-proto-ipv6</a>.
Then navigate to <strong>LuCI → System → Startup → Initscripts</strong> and click to <strong>network → Restart</strong> to be able to utilize the new protocol.
</p>

<p>
OpenWrt is fully capable of handling and routing <abbr title="Internet Protocol version 6">IPv6</abbr> traffic.
Many ISPs offer native <abbr title="Internet Protocol version 6">IPv6</abbr>, but if yours doesn&#039;t, here&#039;s a quick setup guide for experimenting with <abbr title="Internet Protocol version 6">IPv6</abbr> (and getting used to the peculiar address format).
</p>

<p>
The procedure below creates a <em>6in4 tunnel</em> on the WAN6 interface of your router.
This automatically wraps <em>(encapsulates)</em> all <abbr title="Internet Protocol version 6">IPv6</abbr> packets inside <abbr title="Internet Protocol version 4">IPv4</abbr> packets, and sends them to a designated <em>tunnel broker server</em> that unwraps them, and forwards them to the destination <abbr title="Internet Protocol version 6">IPv6</abbr> host.
Packets from those <abbr title="Internet Protocol version 6">IPv6</abbr> hosts go to the tunnel broker server, where they&#039;re wrapped in an <abbr title="Internet Protocol version 4">IPv4</abbr> packet and sent back to your router, which then unwraps them for for use on your local network.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;IPv6 with Hurricane Electric using LuCI&quot;,&quot;hid&quot;:&quot;ipv6_with_hurricane_electric_using_luci&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:1,&quot;range&quot;:&quot;1-1073&quot;} -->
<h2 class="sectionedit2" id="create_a_tunnel_account">Create a tunnel account</h2>
<div class="level2">

<p>
Before you can configure your router, you must set up a free account at the <a href="https://tunnelbroker.net/" class="urlextern" title="https://tunnelbroker.net/" rel="ugc nofollow">Hurricane Electric Free IPv6 Tunnel Broker</a> site, then create up a <strong>Regular Tunnel</strong>.
Be sure to click <strong>Assign /48</strong> for the “Routed /48” field.
The Hurricane Electric <strong>Tunnel Details</strong> page <strong><abbr title="Internet Protocol version 6">IPv6</abbr> Tunnel</strong> panel (image below) shows the primary details of your tunnel.  The <strong>Advanced</strong> panel (image below) shows the <abbr title="Maximum Transmission Unit">MTU</abbr> of your tunnel.
</p>

<p>
<a href="/_detail/media/tunnelbroker-details.png?id=docs%3Aguide-user%3Anetwork%3Aipv6%3Aipv6tunnel-luci" class="media" title="media:tunnelbroker-details.png"><img src="/_media/media/tunnelbroker-details.png" class="media" loading="lazy" title="Tunnel broker details" alt="Tunnel broker details" /></a>
<a href="/_detail/media/tunnelbroker-advanced.png?id=docs%3Aguide-user%3Anetwork%3Aipv6%3Aipv6tunnel-luci" class="media" title="media:tunnelbroker-advanced.png"><img src="/_media/media/tunnelbroker-advanced.png" class="media" loading="lazy" title="Tunnel broker advanced panel" alt="Tunnel broker advanced panel" /></a>
</p>

<p>
Notes:
</p>
<ul>
<li class="level1"><div class="li"> You can follow the <a href="https://www.bufferbloat.net/projects/cerowrt/wiki/IPv6_Tunnel/" class="urlextern" title="https://www.bufferbloat.net/projects/cerowrt/wiki/IPv6_Tunnel/" rel="ugc nofollow">detailed instructions</a> for creating the 6in4 tunnel.</div>
</li>
<li class="level1"><div class="li"> The 6in4 protocol <a href="https://forums.he.net/index.php?topic=488.0" class="urlextern" title="https://forums.he.net/index.php?topic=488.0" rel="ugc nofollow">requires</a> you to have a public <abbr title="Internet Protocol version 4">IPv4</abbr> address.</div>
</li>
</ul>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Create a tunnel account&quot;,&quot;hid&quot;:&quot;create_a_tunnel_account&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:2,&quot;range&quot;:&quot;1074-1944&quot;} -->
<h2 class="sectionedit3" id="configure_your_router">Configure your router</h2>
<div class="level2">

<p>
To complete the OpenWrt configuration, open the router&#039;s <strong>Network → Interfaces</strong> page in a separate tab or window, find the WAN6 interface, and click <strong>Edit:</strong>
</p>
<ul>
<li class="level1"><div class="li"> Change <strong>Protocol</strong> to <em><abbr title="Internet Protocol version 6">IPv6</abbr>-in-<abbr title="Internet Protocol version 4">IPv4</abbr> (RFC4213)</em></div>
</li>
<li class="level1"><div class="li"> Click <strong>Change Protocol</strong> and confirm.</div>
</li>
</ul>

<p>
You&#039;ll see the <strong>WAN6 Common Configuration</strong> page (image below).
Copy the values from the <strong>Tunnel Details</strong> page to the corresponding field of the <strong>WAN6 Common Configuration</strong> page:
</p>
<ul>
<li class="level1"><div class="li"> Leave “Local <abbr title="Internet Protocol version 4">IPv4</abbr> address” empty</div>
</li>
<li class="level1"><div class="li"> Set “Remote <abbr title="Internet Protocol version 4">IPv4</abbr> address” to “Server <abbr title="Internet Protocol version 4">IPv4</abbr> Address” from the Tunnel Details page</div>
</li>
<li class="level1"><div class="li"> Set “Local <abbr title="Internet Protocol version 6">IPv6</abbr> address” to “Client <abbr title="Internet Protocol version 6">IPv6</abbr> Address”</div>
</li>
<li class="level1"><div class="li"> Set “<abbr title="Internet Protocol version 6">IPv6</abbr> routed prefix” to “Routed /48” value“ (click <strong>Assign /48</strong> on the Tunnel Details if it&#039;s not present)</div>
</li>
<li class="level1"><div class="li"> Check the Dynamic tunnel box. This reveals more fields:</div>
</li>
<li class="level1"><div class="li"> Set “Tunnel ID” to the “Tunnel ID” field</div>
</li>
<li class="level1"><div class="li"> Set “HE.net username” to the user name you used to create the account</div>
</li>
<li class="level1"><div class="li"> Set “HE.net password” to the Update Key found on the Advanced tab of Tunnel Details page</div>
</li>
<li class="level1"><div class="li"> On the Advanced tab, set “Use <abbr title="Maximum Transmission Unit">MTU</abbr> on tunnel interface” to the <abbr title="Maximum Transmission Unit">MTU</abbr> found on the Advanced tab of Tunnel Details page</div>
</li>
<li class="level1"><div class="li"> On newer versions of OpenWRT, go to the Firewall tab, and select the same zone as your <abbr title="Wide Area Network">WAN</abbr> (this is needed at least in 23.05.2). On older versions, you can keep the default settings of the Firewall tabs as-is</div>
</li>
<li class="level1"><div class="li"> Click <strong>Save and Apply</strong></div>
</li>
</ul>

<p>
At this point, your computer should have direct <abbr title="Internet Protocol version 6">IPv6</abbr> connectivity with the rest of the Internet.
(You may need to restart the router, or disable and re-enable the network interface of your computer before the 6in4 addressing works.) To test, type <code>ping ipv6.google.com</code>
</p>

<p>
Legacy notes:
</p>
<ul>
<li class="level1"><div class="li"> OpenWrt has handled <abbr title="Internet Protocol version 6">IPv6</abbr> since at least Backfire (10.03.1). This procedure should work with 17.01 and newer, and was tested with 18.06.1</div>
</li>
<li class="level1"><div class="li"> There is a <a href="https://github.com/richb-hanover/OpenWrtScripts/blob/master/tunnelbroker.sh" class="urlextern" title="https://github.com/richb-hanover/OpenWrtScripts/blob/master/tunnelbroker.sh" rel="ugc nofollow">tunnelbroker.sh</a> script over at <a href="https://github.com/richb-hanover/OpenWrtScripts" class="urlextern" title="https://github.com/richb-hanover/OpenWrtScripts" rel="ugc nofollow">OpenWrt scripts</a>. That script is convenient if you need to reconfigure the router frequently. Otherwise, it&#039;s just as simple to use the LuCI web interface.</div>
</li>
</ul>

<p>
<a href="/_detail/media/configurewan6-general.png?id=docs%3Aguide-user%3Anetwork%3Aipv6%3Aipv6tunnel-luci" class="media" title="media:configurewan6-general.png"><img src="/_media/media/configurewan6-general.png" class="media" loading="lazy" title="WAN6 general configuration panel" alt="WAN6 general configuration panel" /></a>
</p>

<p>
<a href="/_detail/media/configurewan6-advanced.png?id=docs%3Aguide-user%3Anetwork%3Aipv6%3Aipv6tunnel-luci" class="media" title="media:configurewan6-advanced.png"><img src="/_media/media/configurewan6-advanced.png" class="media" loading="lazy" title="WAN6 advanced configuration panel" alt="WAN6 advanced configuration panel" /></a>
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Configure your router&quot;,&quot;hid&quot;:&quot;configure_your_router&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:3,&quot;range&quot;:&quot;1945-&quot;} -->