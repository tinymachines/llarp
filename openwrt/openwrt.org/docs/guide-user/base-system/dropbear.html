
<h1 class="sectionedit1" id="dropbear_configuration">Dropbear configuration</h1>
<div class="level1">
<ul>
<li class="level1"><div class="li"> Follow <a href="/docs/guide-user/services/nas/sftp.server" class="wikilink1" title="docs:guide-user:services:nas:sftp.server" data-wiki-id="docs:guide-user:services:nas:sftp.server">SFTP server</a> to provide <abbr title="SSH File Transfer Protocol">SFTP</abbr> support.</div>
</li>
<li class="level1"><div class="li"> Follow <a href="/docs/guide-user/security/dropbear.public-key.auth" class="wikilink1" title="docs:guide-user:security:dropbear.public-key.auth" data-wiki-id="docs:guide-user:security:dropbear.public-key.auth">Dropbear key-based authentication</a> to set up key-based authentication.</div>
</li>
<li class="level1"><div class="li"> Follow <a href="/docs/guide-user/security/secure.access" class="wikilink1" title="docs:guide-user:security:secure.access" data-wiki-id="docs:guide-user:security:secure.access">Secure your router&#039;s access</a> for additional security hardening.</div>
</li>
</ul>

<p>
The <abbr title="Secure Shell">SSH</abbr> configuration is handled by the <a href="https://en.wikipedia.org/wiki/Dropbear (software)" class="interwiki iw_wp" title="https://en.wikipedia.org/wiki/Dropbear (software)">Dropbear</a> subsystem of uci and the configuration file is located in <code>/etc/config/dropbear</code>.
</p>

<p>
Each dropbear <abbr title="Secure Shell">SSH</abbr> server instance uses a single section of the configuration file, and you can have multiple instances.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Dropbear configuration&quot;,&quot;hid&quot;:&quot;dropbear_configuration&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:1,&quot;range&quot;:&quot;1-665&quot;} -->
<h2 class="sectionedit2" id="sections">Sections</h2>
<div class="level2">

<p>
The <code>dropbear</code> configuration contains settings for the dropbear <abbr title="Secure Shell">SSH</abbr> server in a single section.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Sections&quot;,&quot;hid&quot;:&quot;sections&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:2,&quot;range&quot;:&quot;666-785&quot;} -->
<h3 class="sectionedit3" id="dropbear">Dropbear</h3>
<div class="level3">

<p>
The <code>dropbear</code> section contains these settings. Names are case-sensitive.
</p>
<div class="table sectionedit4"><table class="inline">
	<thead>
	<tr class="row0">
		<th class="col0 leftalign"> Name                  </th><th class="col1 leftalign"> Type     </th><th class="col2 leftalign"> Required  </th><th class="col3 leftalign"> Default     </th><th class="col4 leftalign"> Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </th>
	</tr>
	</thead>
	<tr class="row1">
		<td class="col0 leftalign"> <code>enable</code>            </td><td class="col1 leftalign"> boolean  </td><td class="col2 leftalign"> no        </td><td class="col3 leftalign"> 1           </td><td class="col4 leftalign"> Set to <code>0</code> to disable starting dropbear at system boot.                                                                                                                                                                                                                                                                                                                                                                                                                                                                  </td>
	</tr>
	<tr class="row2">
		<td class="col0 leftalign"> <code>verbose</code>           </td><td class="col1 leftalign"> boolean  </td><td class="col2 leftalign"> no        </td><td class="col3 leftalign"> 0           </td><td class="col4 leftalign"> Set to <code>1</code> to enable verbose output by the start script.                                                                                                                                                                                                                                                                                                                                                                                                                                                                 </td>
	</tr>
	<tr class="row3">
		<td class="col0 leftalign"> <code>BannerFile</code>        </td><td class="col1 leftalign"> string   </td><td class="col2 leftalign"> no        </td><td class="col3 leftalign"> <em>(none)</em>  </td><td class="col4 leftalign"> Name of a file to be printed before the user has authenticated successfully.                                                                                                                                                                                                                                                                                                                                                                                                                                               </td>
	</tr>
	<tr class="row4">
		<td class="col0 leftalign"> <code>PasswordAuth</code>      </td><td class="col1 leftalign"> boolean  </td><td class="col2 leftalign"> no        </td><td class="col3 leftalign"> 1           </td><td class="col4 leftalign"> Set to <code>0</code> to disable authenticating with passwords.                                                                                                                                                                                                                                                                                                                                                                                                                                                                     </td>
	</tr>
	<tr class="row5">
		<td class="col0 leftalign"> <code>Port</code>              </td><td class="col1 leftalign"> integer  </td><td class="col2 leftalign"> no        </td><td class="col3 leftalign"> 22          </td><td class="col4 leftalign"> Port number to listen on.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  </td>
	</tr>
	<tr class="row6">
		<td class="col0 leftalign"> <code>RootPasswordAuth</code>  </td><td class="col1 leftalign"> boolean  </td><td class="col2 leftalign"> no        </td><td class="col3 leftalign"> 1           </td><td class="col4 leftalign"> Set to <code>0</code> to disable authenticating as root with passwords.                                                                                                                                                                                                                                                                                                                                                                                                                                                             </td>
	</tr>
	<tr class="row7">
		<td class="col0 leftalign"> <code>RootLogin</code>         </td><td class="col1 leftalign"> boolean  </td><td class="col2 leftalign"> no        </td><td class="col3 leftalign"> 1           </td><td class="col4 leftalign"> Set to <code>0</code> to disable <abbr title="Secure Shell">SSH</abbr> logins as root.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </td>
	</tr>
	<tr class="row8">
		<td class="col0 leftalign"> <code>GatewayPorts</code>      </td><td class="col1 leftalign"> boolean  </td><td class="col2 leftalign"> no        </td><td class="col3 leftalign"> 0           </td><td class="col4 leftalign"> Set to <code>1</code> to allow remote hosts to connect to forwarded ports.                                                                                                                                                                                                                                                                                                                                                                                                                                                          </td>
	</tr>
	<tr class="row9">
		<td class="col0 leftalign"> <code>Interface</code>         </td><td class="col1 leftalign"> string   </td><td class="col2 leftalign"> no        </td><td class="col3 leftalign"> <em>(none)</em>  </td><td class="col4 leftalign"> Write an interface name, for example <code>lan</code>. With this setting you can limit connections to clients that can reach the <abbr title="Internet Protocol">IP</abbr> of this interface. So for example the <abbr title="Local Area Network">LAN</abbr> <abbr title="Internet Protocol">IP</abbr> of the interface can only be seen from clients in the <abbr title="Local Area Network">LAN</abbr> network, but not from the <abbr title="Wide Area Network">WAN</abbr> in the default firewall configuration. It&#039;s used in dropbear&#039;s -p option that does the following: “Listen on specified address and <abbr title="Transmission Control Protocol">TCP</abbr> port. If just a port is given listen on all addresses. up to 10 can be specified (default 22 if none specified). ”  </td>
	</tr>
	<tr class="row10">
		<td class="col0 leftalign"> <code>keyfile</code>           </td><td class="col1 leftalign"> list of files     </td><td class="col2 leftalign"> no        </td><td class="col3 leftalign"> <em>(none)</em>  </td><td class="col4 leftalign"> Path to host key file.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     </td>
	</tr>
	<tr class="row11">
		<td class="col0 leftalign"> <code>rsakeyfile</code>        </td><td class="col1 leftalign"> file     </td><td class="col2 leftalign"> no        </td><td class="col3 leftalign"> <em>(none)</em>  </td><td class="col4 leftalign"> Path to RSA host key file. <em>Deprecated.</em> See <code>keyfile</code>.                                                                                                                                                                                                                                                                                                                                                                                                                                                                </td>
	</tr>
	<tr class="row12">
		<td class="col0 leftalign"> <code>SSHKeepAlive</code>      </td><td class="col1 leftalign"> integer  </td><td class="col2 leftalign"> no        </td><td class="col3 leftalign"> 300         </td><td class="col4"> Ensure that traffic is transmitted at a certain interval in seconds. This is useful for working around firewalls or routers that drop connections after a certain period of inactivity. The trade-off is that a session may be closed if there is a temporary lapse of network connectivity. A setting of 0 disables keepalives. If no response is received for 3 consecutive keepalives the connection will be closed. Equivalent of OpenSSH <code>ClientAliveInterval</code> </td>
	</tr>
	<tr class="row13">
		<td class="col0 leftalign"> <code>IdleTimeout</code>       </td><td class="col1 leftalign"> integer  </td><td class="col2 leftalign"> no        </td><td class="col3 leftalign"> 0           </td><td class="col4"> Disconnect the session if no traffic is transmitted or received for <code>IdleTimeout</code> seconds even after the <code>SSHKeepAlive</code> keep alive pings. Equivalent of OpenSSH <code>ClientAliveInterval</code> multiplied on <code>ClientAliveCountMax</code> </td>
	</tr>
	<tr class="row14">
		<td class="col0 leftalign"> <code>mdns</code>              </td><td class="col1 leftalign"> integer  </td><td class="col2 leftalign"> no        </td><td class="col3 leftalign"> 1           </td><td class="col4 leftalign"> Whether to announce the service via <a href="/docs/guide-developer/mdns" class="wikilink1" title="docs:guide-developer:mdns" data-wiki-id="docs:guide-developer:mdns">mDNS</a>                                                                                                                                                                                                                                                                                                                                                                                                                                                     </td>
	</tr>
	<tr class="row15">
		<td class="col0 leftalign"> <code>MaxAuthTries</code>      </td><td class="col1 leftalign"> integer  </td><td class="col2 leftalign"> no        </td><td class="col3 leftalign"> 3           </td><td class="col4 leftalign"> Amount of times you can retry writing the password when logging in before the <abbr title="Secure Shell">SSH</abbr> server closes the connection.                                                                                                                                                                                                                                                                       </td>
	</tr>
	<tr class="row16">
		<td class="col0 leftalign"> <code>RecvWindowSize</code>    </td><td class="col1 leftalign"> integer  </td><td class="col2 leftalign"> no        </td><td class="col3 leftalign"> 24576       </td><td class="col4 leftalign"> Specify the per-channel receive window buffer size. Increasing this may improve network performance at the expense of memory use.                                                                                                                                                                                                                                                                                                                                                                                          </td>
	</tr>
</table></div>
<!-- EDIT{&quot;target&quot;:&quot;table&quot;,&quot;name&quot;:&quot;&quot;,&quot;hid&quot;:&quot;table&quot;,&quot;secid&quot;:4,&quot;range&quot;:&quot;882-10147&quot;} -->
</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Dropbear&quot;,&quot;hid&quot;:&quot;dropbear&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:3,&quot;range&quot;:&quot;786-10148&quot;} -->
<h3 class="sectionedit5" id="default_configuration">Default configuration</h3>
<div class="level3">

<p>
This is the default configuration:
</p>
<pre class="code bash"><span class="co0"># uci show dropbear</span>
dropbear.<span class="sy0">@</span>dropbear<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span>=dropbear
dropbear.<span class="sy0">@</span>dropbear<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span>.RootPasswordAuth=<span class="st_h">'1'</span>
dropbear.<span class="sy0">@</span>dropbear<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span>.PasswordAuth=<span class="st_h">'1'</span>
dropbear.<span class="sy0">@</span>dropbear<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span>.Port=<span class="st_h">'22'</span></pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Default configuration&quot;,&quot;hid&quot;:&quot;default_configuration&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:5,&quot;range&quot;:&quot;10149-10402&quot;} -->
<h2 class="sectionedit6" id="extras">Extras</h2>
<div class="level2">

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Extras&quot;,&quot;hid&quot;:&quot;extras&quot;,&quot;codeblockOffset&quot;:1,&quot;secid&quot;:6,&quot;range&quot;:&quot;10403-10421&quot;} -->
<h3 class="sectionedit7" id="multiple_instances">Multiple instances</h3>
<div class="level3">

<p>
Add a second instance of dropbear listening on port 2022.
</p>
<pre class="code bash">uci add dropbear dropbear
uci <span class="kw1">set</span> dropbear.<span class="sy0">@</span>dropbear<span class="br0">&#91;</span>-<span class="nu0">1</span><span class="br0">&#93;</span>.RootPasswordAuth=<span class="st_h">'1'</span>
uci <span class="kw1">set</span> dropbear.<span class="sy0">@</span>dropbear<span class="br0">&#91;</span>-<span class="nu0">1</span><span class="br0">&#93;</span>.PasswordAuth=<span class="st_h">'0'</span>
uci <span class="kw1">set</span> dropbear.<span class="sy0">@</span>dropbear<span class="br0">&#91;</span>-<span class="nu0">1</span><span class="br0">&#93;</span>.Port=<span class="st0">&quot;2022&quot;</span>
uci commit dropbear
service dropbear restart</pre>

<p>
If you want to connect from internet you need to allow the 2022 port on <abbr title="Wide Area Network">WAN</abbr> interface.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Multiple instances&quot;,&quot;hid&quot;:&quot;multiple_instances&quot;,&quot;codeblockOffset&quot;:1,&quot;secid&quot;:7,&quot;range&quot;:&quot;10422-10833&quot;} -->
<h3 class="sectionedit8" id="openssh_compatibility">OpenSSH compatibility</h3>
<div class="level3">

<p>
Dropbear does not support <abbr title="SSH File Transfer Protocol">SFTP</abbr> by itself.
Meanwhile OpenSSH client uses <abbr title="SSH File Transfer Protocol">SFTP</abbr> <a href="https://www.openssh.com/releasenotes.html#9.0" class="urlextern" title="https://www.openssh.com/releasenotes.html#9.0" rel="ugc nofollow">by default</a>.
Use <code>scp -O</code> for the <a href="https://man.openbsd.org/scp#O" class="urlextern" title="https://man.openbsd.org/scp#O" rel="ugc nofollow">legacy SCP protocol</a> if necessary.
</p>

<p>
If you do have enough space you can install the <abbr title="SSH File Transfer Protocol">SFTP</abbr> server:
</p>
<pre class="code">opkg update
opkg install openssh-sftp-server</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;OpenSSH compatibility&quot;,&quot;hid&quot;:&quot;openssh_compatibility&quot;,&quot;codeblockOffset&quot;:2,&quot;secid&quot;:8,&quot;range&quot;:&quot;10834-11218&quot;} -->
<h3 class="sectionedit9" id="security_considerations">Security considerations</h3>
<div class="level3">
<ul>
<li class="level1"><div class="li"> Set up <a href="/docs/guide-user/security/dropbear.public-key.auth" class="wikilink1" title="docs:guide-user:security:dropbear.public-key.auth" data-wiki-id="docs:guide-user:security:dropbear.public-key.auth">public key authentication</a> and disable password authentication if possible.</div>
</li>
<li class="level1"><div class="li"> Set up a <a href="/docs/guide-user/services/vpn/start" class="wikilink1" title="docs:guide-user:services:vpn:start" data-wiki-id="docs:guide-user:services:vpn:start">VPN</a> to avoid exposing <abbr title="Secure Shell">SSH</abbr> to the internet as a single critical vulnerability may be enough for a remote attacker to gain root access.</div>
</li>
</ul>

<p>
Problems facing with a public <abbr title="Secure Shell">SSH</abbr>:
</p>
<ul>
<li class="level1"><div class="li"> No normal group for users and no normal user.</div>
</li>
<li class="level1"><div class="li"> No facility to ban IPs with many failed login attempts.</div>
</li>
<li class="level1"><div class="li"> File system permissions are very lax on default OpenWrt.</div>
</li>
<li class="level1"><div class="li"> Preventing normal users from exploiting BusyBox to gain access to root only commands due to missing permissions for symlinks.</div>
</li>
</ul>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Security considerations&quot;,&quot;hid&quot;:&quot;security_considerations&quot;,&quot;codeblockOffset&quot;:3,&quot;secid&quot;:9,&quot;range&quot;:&quot;11219-11916&quot;} -->
<h3 class="sectionedit10" id="references">References</h3>
<div class="level3">
<ul>
<li class="level1"><div class="li"> <a href="https://matt.ucc.asn.au/dropbear/dropbear.html" class="urlextern" title="https://matt.ucc.asn.au/dropbear/dropbear.html" rel="ugc nofollow">Dropbear homepage</a></div>
</li>
<li class="level1"><div class="li"> <a href="https://www.mankier.com/8/dropbear" class="urlextern" title="https://www.mankier.com/8/dropbear" rel="ugc nofollow">Dropbear man page</a></div>
</li>
</ul>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;References&quot;,&quot;hid&quot;:&quot;references&quot;,&quot;codeblockOffset&quot;:3,&quot;secid&quot;:10,&quot;range&quot;:&quot;11917-12073&quot;} -->
<h3 class="sectionedit11" id="see_also">See also</h3>
<div class="level3">
<ul>
<li class="level1"><div class="li"> <a href="/docs/guide-user/services/ssh/openssh_instead_dropbear" class="wikilink1" title="docs:guide-user:services:ssh:openssh_instead_dropbear" data-wiki-id="docs:guide-user:services:ssh:openssh_instead_dropbear">Replace Dropbear to OpenSSH</a></div>
</li>
<li class="level1"><div class="li"> <a href="/docs/guide-user/services/ssh/start" class="wikilink1" title="docs:guide-user:services:ssh:start" data-wiki-id="docs:guide-user:services:ssh:start">SSH articles</a> - tunneling, SSHFS mounting etc.</div>
</li>
<li class="level1"><div class="li"> <a href="/docs/guide-user/security/dropbear.public-key.auth" class="wikilink1" title="docs:guide-user:security:dropbear.public-key.auth" data-wiki-id="docs:guide-user:security:dropbear.public-key.auth">Dropbear key-based authentication</a></div>
</li>
<li class="level1"><div class="li"> <a href="/docs/guide-user/services/remote_control/portknock.server" class="wikilink1" title="docs:guide-user:services:remote_control:portknock.server" data-wiki-id="docs:guide-user:services:remote_control:portknock.server">Port knocking</a></div>
</li>
</ul>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;See also&quot;,&quot;hid&quot;:&quot;see_also&quot;,&quot;codeblockOffset&quot;:3,&quot;secid&quot;:11,&quot;range&quot;:&quot;12074-&quot;} -->