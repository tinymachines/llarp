
<h1 class="sectionedit1" id="hotplug_extras">Hotplug extras</h1>
<div class="level1">

</div>
<!-- EDIT{&quot;target&quot;:&quot;plugin_include_start&quot;,&quot;name&quot;:&quot;meta:infobox:howto_links&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:2,&quot;range&quot;:&quot;0-&quot;} --><div class="plugin_include_content plugin_include__meta:infobox:howto_links">
<div class="level1">
<!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_start&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:4,&quot;range&quot;:&quot;0-&quot;} --><div class="wrap_info plugin_wrap">
<p>
This article relies on the following:
</p>
<ul>
<li class="level1"><div class="li"> Accessing <a href="/docs/guide-quick-start/walkthrough_login" class="wikilink1" title="docs:guide-quick-start:walkthrough_login" data-wiki-id="docs:guide-quick-start:walkthrough_login">web interface</a> / <a href="/docs/guide-quick-start/sshadministration" class="wikilink1" title="docs:guide-quick-start:sshadministration" data-wiki-id="docs:guide-quick-start:sshadministration">command-line interface</a></div>
</li>
<li class="level1"><div class="li"> Managing <a href="/docs/guide-user/base-system/uci" class="wikilink1" title="docs:guide-user:base-system:uci" data-wiki-id="docs:guide-user:base-system:uci">configs</a> / <a href="/docs/guide-user/additional-software/managing_packages" class="wikilink1" title="docs:guide-user:additional-software:managing_packages" data-wiki-id="docs:guide-user:additional-software:managing_packages">packages</a> / <a href="/docs/guide-user/base-system/managing_services" class="wikilink1" title="docs:guide-user:base-system:managing_services" data-wiki-id="docs:guide-user:base-system:managing_services">services</a> / <a href="/docs/guide-user/base-system/log.essentials" class="wikilink1" title="docs:guide-user:base-system:log.essentials" data-wiki-id="docs:guide-user:base-system:log.essentials">logs</a></div>
</li>
</ul>
</div><!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_end&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:5,&quot;range&quot;:&quot;0-&quot;} -->
</div>
<!-- EDIT{&quot;target&quot;:&quot;plugin_include_end&quot;,&quot;name&quot;:&quot;meta:infobox:howto_links&quot;,&quot;hid&quot;:&quot;&quot;,&quot;secid&quot;:3,&quot;range&quot;:&quot;0-&quot;} --></div>
<div class="level1">

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Hotplug extras&quot;,&quot;hid&quot;:&quot;hotplug_extras&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:1,&quot;range&quot;:&quot;1-111&quot;} -->
<h2 class="sectionedit6" id="introduction">Introduction</h2>
<div class="level2">
<ul>
<li class="level1"><div class="li"> This instruction extends the functionality of <a href="/docs/guide-user/base-system/hotplug" class="wikilink1" title="docs:guide-user:base-system:hotplug" data-wiki-id="docs:guide-user:base-system:hotplug">Hotplug</a>.</div>
</li>
<li class="level1"><div class="li"> Follow the <a href="/docs/guide-user/advanced/hotplug_extras#automated" class="wikilink1" title="docs:guide-user:advanced:hotplug_extras" data-wiki-id="docs:guide-user:advanced:hotplug_extras">automated</a> section for quick setup.</div>
</li>
</ul>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Introduction&quot;,&quot;hid&quot;:&quot;introduction&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:6,&quot;range&quot;:&quot;112-340&quot;} -->
<h2 class="sectionedit7" id="features">Features</h2>
<div class="level2">
<ul>
<li class="level1"><div class="li"> Run scripts at startup when the network is online.</div>
</li>
</ul>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Features&quot;,&quot;hid&quot;:&quot;features&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:7,&quot;range&quot;:&quot;341-417&quot;} -->
<h2 class="sectionedit8" id="implementation">Implementation</h2>
<div class="level2">
<ul>
<li class="level1"><div class="li"> Use <a href="/docs/guide-user/base-system/hotplug" class="wikilink1" title="docs:guide-user:base-system:hotplug" data-wiki-id="docs:guide-user:base-system:hotplug">Hotplug</a> to detect connectivity change and trigger network dependent scripts.</div>
</li>
<li class="level1"><div class="li"> Process subsystem-specific scripts with <a href="https://github.com/openwrt/openwrt/blob/master/package/base-files/files/sbin/hotplug-call" class="urlextern" title="https://github.com/openwrt/openwrt/blob/master/package/base-files/files/sbin/hotplug-call" rel="ugc nofollow">hotplug-call</a>.</div>
</li>
<li class="level1"><div class="li"> Delay script invocation with <a href="http://man.cx/sleep%281%29" class="interwiki iw_man" title="http://man.cx/sleep%281%29">sleep</a> to work around tunneled connections.</div>
</li>
<li class="level1"><div class="li"> Write and read non-interactive logs with <a href="/docs/guide-user/base-system/log.essentials" class="wikilink1" title="docs:guide-user:base-system:log.essentials" data-wiki-id="docs:guide-user:base-system:log.essentials">Syslog</a> for troubleshooting.</div>
</li>
</ul>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Implementation&quot;,&quot;hid&quot;:&quot;implementation&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:8,&quot;range&quot;:&quot;418-935&quot;} -->
<h2 class="sectionedit9" id="instructions">Instructions</h2>
<div class="level2">
<pre class="code bash"><span class="co0"># Configure hotplug</span>
<span class="kw2">mkdir</span> <span class="re5">-p</span> <span class="sy0">/</span>etc<span class="sy0">/</span>hotplug.d<span class="sy0">/</span>iface
<span class="kw2">cat</span> <span class="sy0">&lt;&lt;</span> <span class="st0">&quot;EOF&quot;</span> <span class="sy0">&gt;</span> <span class="sy0">/</span>etc<span class="sy0">/</span>hotplug.d<span class="sy0">/</span>iface<span class="sy0">/</span><span class="nu0">90</span>-online
<span class="kw1">if</span> <span class="br0">&#91;</span> <span class="st0">&quot;<span class="es3">${INTERFACE}</span>&quot;</span> = <span class="st0">&quot;loopback&quot;</span> <span class="br0">&#93;</span>
<span class="kw1">then</span> <span class="kw3">exit</span> <span class="nu0">0</span>
<span class="kw1">fi</span>
<span class="kw1">if</span> <span class="br0">&#91;</span> <span class="st0">&quot;<span class="es3">${ACTION}</span>&quot;</span> <span class="sy0">!</span>= <span class="st0">&quot;ifup&quot;</span> <span class="br0">&#93;</span> \
<span class="sy0">&amp;&amp;</span> <span class="br0">&#91;</span> <span class="st0">&quot;<span class="es3">${ACTION}</span>&quot;</span> <span class="sy0">!</span>= <span class="st0">&quot;ifupdate&quot;</span> <span class="br0">&#93;</span>
<span class="kw1">then</span> <span class="kw3">exit</span> <span class="nu0">0</span>
<span class="kw1">fi</span>
<span class="kw1">if</span> <span class="br0">&#91;</span> <span class="st0">&quot;<span class="es3">${ACTION}</span>&quot;</span> = <span class="st0">&quot;ifupdate&quot;</span> <span class="br0">&#93;</span> \
<span class="sy0">&amp;&amp;</span> <span class="br0">&#91;</span> <span class="re5">-z</span> <span class="st0">&quot;<span class="es3">${IFUPDATE_ADDRESSES}</span>&quot;</span> <span class="br0">&#93;</span> \
<span class="sy0">&amp;&amp;</span> <span class="br0">&#91;</span> <span class="re5">-z</span> <span class="st0">&quot;<span class="es3">${IFUPDATE_DATA}</span>&quot;</span> <span class="br0">&#93;</span>
<span class="kw1">then</span> <span class="kw3">exit</span> <span class="nu0">0</span>
<span class="kw1">fi</span>
hotplug-call online
EOF
<span class="kw2">cat</span> <span class="sy0">&lt;&lt;</span> <span class="st0">&quot;EOF&quot;</span> <span class="sy0">&gt;&gt;</span> <span class="sy0">/</span>etc<span class="sy0">/</span>sysupgrade.conf
<span class="sy0">/</span>etc<span class="sy0">/</span>hotplug.d<span class="sy0">/</span>iface<span class="sy0">/</span><span class="nu0">90</span>-online
EOF</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Instructions&quot;,&quot;hid&quot;:&quot;instructions&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:9,&quot;range&quot;:&quot;936-1416&quot;} -->
<h2 class="sectionedit10" id="examples">Examples</h2>
<div class="level2">
<pre class="code bash"><span class="co0"># Example Hotplug script</span>
<span class="kw2">cat</span> <span class="sy0">&lt;&lt;</span> <span class="st0">&quot;EOF&quot;</span> <span class="sy0">&gt;</span> <span class="sy0">/</span>etc<span class="sy0">/</span>hotplug.d<span class="sy0">/</span>online<span class="sy0">/</span>00-logger
logger <span class="re5">-t</span> hotplug $<span class="br0">&#40;</span><span class="kw2">env</span><span class="br0">&#41;</span>
EOF
&nbsp;
<span class="co0"># Trigger Hotplug</span>
service network restart
&nbsp;
<span class="co0"># Check Hotplug log</span>
logread <span class="re5">-e</span> hotplug</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Examples&quot;,&quot;hid&quot;:&quot;examples&quot;,&quot;codeblockOffset&quot;:1,&quot;secid&quot;:10,&quot;range&quot;:&quot;1417-1642&quot;} -->
<h2 class="sectionedit11" id="automated">Automated</h2>
<div class="level2">
<pre class="code bash"><span class="kw2">wget</span> <span class="re5">-U</span> <span class="st0">&quot;&quot;</span> <span class="re5">-O</span> hotplug-extras.sh <span class="st0">&quot;https://openwrt.org/_export/code/docs/guide-user/advanced/hotplug_extras?codeblock=0&quot;</span>
. .<span class="sy0">/</span>hotplug-extras.sh</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Automated&quot;,&quot;hid&quot;:&quot;automated&quot;,&quot;codeblockOffset&quot;:2,&quot;secid&quot;:11,&quot;range&quot;:&quot;1643-&quot;} -->