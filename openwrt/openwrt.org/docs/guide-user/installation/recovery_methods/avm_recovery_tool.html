
<h1 class="sectionedit1" id="avm_recovery_tool">AVM recovery tool</h1>
<div class="level1">

<p>
Many AVM devices can be unbricked by a AVM recovery tool which is specific to your device.
</p>

<p>
<strong>Example:</strong> For Fritz!Box 7530 <a href="https://download.avm.de/fritzbox/fritzbox-7530/other/recover/" class="urlextern" title="https://download.avm.de/fritzbox/fritzbox-7530/other/recover/" rel="ugc nofollow">https://download.avm.de/fritzbox/fritzbox-7530/other/recover/</a>
</p>

<p>
Search the corresponding recovery tool for your specific device on the AVM <abbr title="File Transfer Protocol">FTP</abbr> server.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;AVM recovery tool&quot;,&quot;hid&quot;:&quot;avm_recovery_tool&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:1,&quot;range&quot;:&quot;1-312&quot;} -->
<h2 class="sectionedit2" id="debricking_a_branded_device">Debricking a branded device</h2>
<div class="level2">

<p>
If you have a branded (e.g. 1&amp;1) AVM device and you get the following message
</p>
<pre class="code">The device contains basic settings adapted for your Internet Service Provider</pre>

<p>
when trying to go back to OEM firmware via the AVM recovery tool, you have to unbrand your device first. See the procedure below how to do this.
</p>
<ol>
<li class="level1"><div class="li"> Set your PCs <abbr title="Internet Protocol">IP</abbr> to 192.168.178.x/24 (where x is not 1) and the default gateway to 192.168.178.1.</div>
</li>
<li class="level1"><div class="li"> Turn off your router, ensure your PC is connected to LAN1 via Ethernet, and turn the router back on.</div>
</li>
<li class="level1"><div class="li"> Wait for the interface to become active (usually indicated by LEDs on your PC&#039;s Ethernet port) and connect to the bootloader&#039;s <abbr title="File Transfer Protocol">FTP</abbr> server, e.g. <code>ftp -n 192.168.178.1</code></div>
</li>
<li class="level1 node"><div class="li"> If connecting to the bootloader&#039;s <abbr title="File Transfer Protocol">FTP</abbr> server fails with &#039;connection refused&#039;: It has been reported that some models require a magic <abbr title="User Datagram Protocol">UDP</abbr> packet exchange before the <abbr title="File Transfer Protocol">FTP</abbr> connection is accepted by the router. This can also be required for some Fritz!Box 7530 routers. There are two possibilities to enable the connection:</div>
<ol>
<li class="level3"><div class="li"> Refer to the scripts in this thread: <a href="https://forum.openwrt.org/t/fritzbox-4040-flash-ftp-connection-refused/42543/4" class="urlextern" title="https://forum.openwrt.org/t/fritzbox-4040-flash-ftp-connection-refused/42543/4" rel="ugc nofollow">https://forum.openwrt.org/t/fritzbox-4040-flash-ftp-connection-refused/42543/4</a>.</div>
</li>
<li class="level3"><div class="li"> Run tha AVM recovery tool until the prompt appears that warns &#039;The device contains basic settings adapted for your Internet Service Provider&#039;. At this point, leave the prompt open and the tool running, and the <abbr title="File Transfer Protocol">FTP</abbr> connection should be possible. </div>
</li>
</ol>
</li>
<li class="level1"><div class="li"> Once connected to the <abbr title="File Transfer Protocol">FTP</abbr> server, issue the following set of commands:<br/>
<pre class="code">    quote USER adam2
    quote PASS adam2
    quote SETENV firmware_version avm
    quote UNSETENV provider
    quit</pre>

<p>
 Not sure if it&#039;s necessary to change the firmware_version variable.
</p>
</div>
</li>
<li class="level1"><div class="li"> Run the recovery tool (or re-start it, if it was already running to enable connecting to the <abbr title="File Transfer Protocol">FTP</abbr> server), but make sure you <strong>do not reset the device</strong>, otherwise the environment variables will go back to their default values. Even if the recovery tool asks you to power cycle the device, <strong>do not do it</strong>.</div>
</li>
</ol>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Debricking a branded device&quot;,&quot;hid&quot;:&quot;debricking_a_branded_device&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:2,&quot;range&quot;:&quot;313-2344&quot;} -->
<h2 class="sectionedit3" id="experiences">Experiences</h2>
<div class="level2">

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Experiences&quot;,&quot;hid&quot;:&quot;experiences&quot;,&quot;codeblockOffset&quot;:2,&quot;secid&quot;:3,&quot;range&quot;:&quot;2345-2368&quot;} -->
<h3 class="sectionedit4" id="router_by_zen_uk">Router by Zen (UK)</h3>
<div class="level3">

<p>
The following steps worked for FRITZ!Box 7530 from Zen. A Windows machine is needed.
</p>
<ol>
<li class="level1"><div class="li"> Set PC <abbr title="Internet Protocol">IP</abbr> address to 192.168.178.x/24 gateway 192.168.178.1</div>
</li>
<li class="level1"><div class="li"> In “Device Manager &gt; Network Adapters &gt; Ethernet Adapter &gt; Advanced &gt; Speed &amp; Duplex” select “10 Mbit/s, half-duplex” <sup><a href="#fn__1" id="fnt__1" class="fn_top">1)</a></sup></div>
</li>
<li class="level1"><div class="li"> Start AVM recovery tool and follow instructions to get to “settings adapted for your <abbr title="Internet Service Provider">ISP</abbr>” dialog. Keep the dialog on. <sup><a href="#fn__2" id="fnt__2" class="fn_top">2)</a></sup></div>
</li>
<li class="level1"><div class="li"> Login via <abbr title="File Transfer Protocol">FTP</abbr> like shown above and do ```UNSETENV provider``` but skip ```SETENV firmware_version avm``` <sup><a href="#fn__3" id="fnt__3" class="fn_top">3)</a></sup></div>
</li>
<li class="level1"><div class="li"> In the AVM recovery tool, now close the dialog and exit the tool cleanly.</div>
</li>
<li class="level1"><div class="li"> Run the AVM recovery tool again, but do not power cycle the Fritz!Box in between.</div>
</li>
<li class="level1"><div class="li"> See the tool deleting the flash area, restoring the flash, then say “... recovered successfully!”</div>
</li>
</ol>

<p>
Afterwards, remember to clear the settings on your ethernet port, i.e., undo step 1 and 2.
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Router by Zen (UK)&quot;,&quot;hid&quot;:&quot;router_by_zen_uk&quot;,&quot;codeblockOffset&quot;:2,&quot;secid&quot;:4,&quot;range&quot;:&quot;2369-&quot;} --><div class="footnotes">
<div class="fn"><sup><a href="#fnt__1" id="fn__1" class="fn_bot">1)</a></sup> 
<div class="content">Instructions by <a href="https://en.avm.de/service/knowledge-base/dok/FRITZ-Box-7590/160_Restoring-the-FRITZ-OS-of-your-FRITZ-Box/" class="urlextern" title="https://en.avm.de/service/knowledge-base/dok/FRITZ-Box-7590/160_Restoring-the-FRITZ-OS-of-your-FRITZ-Box/" rel="ugc nofollow">AVM themselves</a> say that one error can be prevented by using only 10 Mbit/s half-duplex mode on the ethernet port. This supposedly avoids the “Could not determine the version!” error.</div></div>
<div class="fn"><sup><a href="#fnt__2" id="fn__2" class="fn_bot">2)</a></sup> 
<div class="content">The bootloader&#039;s <abbr title="File Transfer Protocol">FTP</abbr> is not immediately available. As per above instructions, I ran the AVM tool first until it reached the &#039;The device contains basic settings adapted ...&#039; state and left it like that. Then <abbr title="File Transfer Protocol">FTP</abbr> was available.</div></div>
<div class="fn"><sup><a href="#fnt__3" id="fn__3" class="fn_bot">3)</a></sup> 
<div class="content">I skipped the ```quote SETENV firmware_version avm``` command. One of these alternations to the procedure helped me get past the “Could not determine the version!” error.</div></div>
</div>
