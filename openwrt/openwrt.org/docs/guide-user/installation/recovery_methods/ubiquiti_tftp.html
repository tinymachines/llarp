
<h1 class="sectionedit1" id="ubiquiti_tftp_recovery">Ubiquiti TFTP recovery</h1>
<div class="level1">

<p>
<em class="u">NOTES &amp; REQUIREMENTS:</em>
</p>
<ul>
<li class="level1"><div class="li"> A narrow tool to press down reset button (like a paper clip)</div>
</li>
<li class="level1"><div class="li"> An Ethernet cable</div>
</li>
<li class="level1"><div class="li"> <abbr title="Trivial File Transfer Protocol">TFTP</abbr> client running on PC</div>
</li>
</ul>

<p>
Take note of what airOS firmware the device was running. You will have to use that same firmware for <abbr title="Trivial File Transfer Protocol">TFTP</abbr> and once recovered, perform a regular upgrade via the WebUI to the latest airOS firmware. The firmware used is dependent on:
</p>
<ol>
<li class="level1"><div class="li"> The firmware compatible with the product, be it a M or AC model.</div>
</li>
<li class="level1"><div class="li"> The version (as stated, you will need to first upgrade to the same firmware the device had). </div>
</li>
</ol>

<p>
<strong>Introduction</strong>
</p>

<p>
By reloading fresh firmware to restore the device, this process can also be useful to recover devices that have appeared to fail when no other solution is working.
</p>

<p>
WARNING: Do not switch off, reboot or disconnect the device from the power supply during the firmware upgrade process, as these actions will damage the device.
</p>

<p>
<em class="u"><strong>Steps</strong>: Recovery Procedure for Windows</em>
</p>
<ol>
<li class="level1"><div class="li"> Power off the device.</div>
</li>
<li class="level1"><div class="li"> Configure your computer: Windows PC&#039;s Ethernet must be configured manually with the following settings (under Network Connections):<br/>
<abbr title="Internet Protocol">IP</abbr> Address: <code>192.168.1.254</code>, Subnet Mask : <code>255.255.255.0</code></div>
</li>
<li class="level1"><div class="li"> Connect your device to the PC.</div>
</li>
<li class="level1"><div class="li"> Press the reset button on the device. While holding the reset button down, power the unit on. Wait 8 seconds then release the button (if you want to reset the unit to factory defaults, wait about 15 seconds or until the signal LEDs light up to indicate that the device is ready for recovery).</div>
</li>
<li class="level1"><div class="li"> For airCubes (<abbr title="Internet Service Provider">ISP</abbr> and AC) and AirGateway: Push reset button and hold while powering unit. LED panel should blink fast several times, continue holding the reset button and the LED should turn off. Now you can release the reset button and the LED will flash slowly three times.</div>
</li>
<li class="level1"><div class="li"> Make sure that the device responds to pings (perform a ping 192.168.1.20 from a DOS window), if it does not, go back to the first step and repeat.</div>
</li>
<li class="level1 node"><div class="li"> Upload firmware image file (.bin) to 192.168.1.20, using a <abbr title="Trivial File Transfer Protocol">TFTP</abbr> client software (binary mode). Windows integrated command line <abbr title="Trivial File Transfer Protocol">TFTP</abbr> client or download a third party utility to upload the airOS firmware. Below are two alternatives:</div>
<ul>
<li class="level2 node"><div class="li"> Method 1: </div>
<ol>
<li class="level3"><div class="li"> From the Windows PC, you can use <abbr title="Trivial File Transfer Protocol">TFTP</abbr> command line from a DOS window (START&gt;&gt;&gt;CMD)</div>
</li>
<li class="level3"><div class="li"> Go into the same directory structure as the firmware (e.g., assuming that you have stored the image files in c:\firmware directory, type the command :cd c:\firmware) and enter the following (for help type <abbr title="Trivial File Transfer Protocol">TFTP</abbr> -h) , e.g.:<pre class="code">tftp -i 192.168.1.20 put WA.v8.5.0.36727.180118.1314.bin</pre>
</div>
</li>
</ol>
</li>
<li class="level2"><div class="li"> Method 2: Download and execute tftp2 and configure it as below:<br/>
Server: <code>192.168.1.20</code><br/>
File: Browse the firmware to upload</div>
</li>
</ul>
</li>
<li class="level1"><div class="li"> Signal LEDs will keep blinking one by one in 4 different colors during firmware upgrade. Wait for about 7-10 minutes (devices and firmware depending). Remember to not power off the device during the procedure.</div>
</li>
<li class="level1"><div class="li"> Once the device is back online, remember to upgrade to the latest airOS firmware via the WebUI and the <abbr title="Internet Protocol">IP</abbr> 192.168.1.20</div>
</li>
</ol>

<p>
<em class="u"><strong>Steps</strong>: Recovery Procedure for Linux</em>
</p>
<ol>
<li class="level1"><div class="li"> Power off the device</div>
</li>
<li class="level1"><div class="li"> Connect in fast ethernet mode (100Mbit) to the <abbr title="Local Area Network">LAN</abbr> side at the power adapter. This can be done using a 4 wires ethernet cable, or with a fast ethernet switch in between. This isn&#039;t strictly neccesary, but on some devices the Gigabit mode could fail.</div>
</li>
<li class="level1"><div class="li"> Press the reset button on the device. While holding the reset button down, power the unit on. Wait 8 seconds then release the button (if you want to reset the unit to factory defaults, wait about 15 seconds or until the signal LEDs light up to indicate that the device is ready for recovery).</div>
</li>
<li class="level1"><div class="li"> Check if the device entered the recovery mode, with the signal strength leds flashing in an alternating pattern. </div>
</li>
<li class="level1"><div class="li"> Ping to <code>192.168.1.20</code>, just to be sure you have connectivity</div>
</li>
<li class="level1 node"><div class="li"> Using <abbr title="Trivial File Transfer Protocol">TFTP</abbr> client you can then upload signed firmware. Send the Ubiquiti <strong>exact</strong> version number you used previously to flash OpenWrt.</div>
<ul>
<li class="level2"><div class="li"> In a Linux <abbr title="Operating System">OS</abbr> execute these commands:<pre class="code">tftp 192.168.1.20
tftp&gt; binary
tftp&gt; trace
tftp&gt; put WA.v8.5.0.36727.180118.1314.bin</pre>
</div>
</li>
</ul>
</li>
<li class="level1"><div class="li"> Signal LEDs will keep blinking one by one with a particular patern depending on the device. Wait some minutes until it finish. Remember to not power off the device during the procedure.</div>
</li>
</ol>

<p>
Original Guide:
</p>

<p>
<a href="https://help.ubnt.com/hc/en-us/articles/204911324-airMAX-How-to-Reset-Your-Device-with-TFTP-Firmware-Recovery" class="urlextern" title="https://help.ubnt.com/hc/en-us/articles/204911324-airMAX-How-to-Reset-Your-Device-with-TFTP-Firmware-Recovery" rel="ugc nofollow">https://help.ubnt.com/hc/en-us/articles/204911324-airMAX-How-to-Reset-Your-Device-with-TFTP-Firmware-Recovery</a>
</p>

</div>
